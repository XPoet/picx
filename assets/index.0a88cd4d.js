var e=Object.defineProperty,a=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,i=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l,n=(e,n)=>{for(var s in n||(n={}))t.call(n,s)&&i(e,s,n[s]);if(a)for(var s of a(n))l.call(n,s)&&i(e,s,n[s]);return e};import{a as s,E as o,b as r,c,C as d,e as u,d as m,f as g,g as p,h,u as f,i as v,j as _,k as b,o as y,l as w,n as k,m as I,p as x,q as S,r as L,s as T,t as $,w as C,v as D,x as E,y as O,z as R,A,B as N,D as M,F as U,G as z,H as P,I as j,J as B,K as V,L as G,M as F,N as H,O as X,P as W,Q as q,R as K,S as J,T as Y,U as Q,V as Z,W as ee,X as ae,Y as te,Z as le,_ as ie,$ as ne,a0 as se,a1 as oe,a2 as re,a3 as ce,a4 as de,a5 as ue,a6 as me,a7 as ge,a8 as pe,a9 as he,aa as fe,ab as ve,ac as _e,ad as be,ae as ye,af as we,ag as ke,ah as Ie,ai as xe,aj as Se,ak as Le,al as Te,am as $e,an as Ce,ao as De,ap as Ee,aq as Oe,ar as Re,as as Ae,at as Ne,au as Me,av as Ue,aw as ze,ax as Pe}from"./vendor.baf6a251.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver((e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&a(e)})).observe(document,{childList:!0,subtree:!0})}function a(e){if(e.ep)return;e.ep=!0;const a=function(e){const a={};return e.integrity&&(a.integrity=e.integrity),e.referrerpolicy&&(a.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?a.credentials="include":"anonymous"===e.crossorigin?a.credentials="omit":a.credentials="same-origin",a}(e);fetch(e.href,a)}}();const je=e=>{const a=window.localStorage.getItem(e);return a?JSON.parse(a):null},Be="https://api.github.com",Ve=s.create({baseURL:Be,timeout:3e5});function Ge(e){const a={};e.method=e.method.toUpperCase();for(const t in e)"params"===t?"GET"===e.method?a.params=e.params:a.data=e.params:a[t]=e[t];return new Promise((e=>{Ve.request(a).then((a=>{const{status:t,data:l}=a;e(!a||200!==t&&201!==t&&204!==t?null:l||"SUCCESS")})).catch((t=>{var l;if((null==a?void 0:a.success422)&&422===(null==t?void 0:t.status))e((null==t?void 0:t.data)||"SUCCESS");else{const i=null==t?void 0:t.status,n=null==(l=null==t?void 0:t.data)?void 0:l.message;(null==a?void 0:a.noShowErrorMsg)||(console.error("PicX Error // ",t),void 0!==i&&void 0!==n&&o.error({duration:6e3,message:`Code: ${i}, Message: ${n}`})),e(null)}}))}))}Ve.defaults.headers["Content-Type"]="application/json",Ve.interceptors.request.use((e=>{var a;const t=je("PICX_CONFIG");if(t){const{token:l}=t;(null==(a=e.baseURL)?void 0:a.includes(Be))&&l&&(e.headers.Authorization=`token ${l}`)}return e}),(e=>Promise.reject(e))),Ve.interceptors.response.use((e=>e),(e=>((null==e?void 0:e.response)||o.error({duration:6e3,message:`${e}`}),Promise.reject(e.response))));const Fe=e=>Ge({url:"/user",method:"GET",headers:{Authorization:`token ${e}`}}),He=(e,a=1)=>new Promise((async t=>{const l=await Ge({url:`users/${e}/repos`,method:"GET",params:{type:"owner",sort:"created",direction:"desc",per_page:100,page:a}});l&&l.length?t(l.filter((e=>!e.fork&&!e.private)).map((e=>({value:e.name,label:e.name})))):t(null)})),Xe=async e=>{const a=[];for(let t=1;t<=3;t++){const l=await He(e,t);l&&a.push(...l)}return Promise.resolve(a.length?a:null)},We=async(e,a=!0)=>{const{owner:t,selectedRepo:l,selectedBranch:i}=e;let n=null;a&&(n=r.service({text:"正在初始化仓库..."}));await Ge({url:`/repos/${t}/${l}/contents/README.md`,method:"PUT",data:{message:"Init repo via PicX(https://github.com/XPoet/picx)",branch:i,content:window.btoa("\n# Welcome to use PicX\n\n[PicX](https://github.com/XPoet/picx) is a simple and powerful image hosting tool. It supports image hosting services via GitHub repository.\n\nPicX is completely open source, and you can use it for free.\n\nIf you like it, please give it a star on [GitHub](https://github.com/XPoet/picx).\n        ")},noShowErrorMsg:!0})?null==n||n.close():a&&o.error("仓库初始化失败")},qe=(e,a)=>({type:"dir",dir:e,dirPath:a,childrenDirs:[],imageList:[]});function Ke(e,a,t){var l;return e?a.length===t?e:Ke(null==(l=e.childrenDirs)?void 0:l.find((e=>e.dir===a[t])),a,++t):null}const Je=(e,a)=>{if("/"===e)return a;return Ke(a,e.split("/"),0)},Ye=(e,a,t)=>{var l;return"dir"===t?null==(l=a.childrenDirs)?void 0:l.filter((e=>"dir"===e.type)):"image"===t?a.imageList.filter((e=>"image"===e.type)):[]},Qe={state:{name:"dirImageListModule",dirObject:(()=>{const e=localStorage.getItem("PICX_MANAGEMENT");return e?JSON.parse(e):qe("/","/")})()},mutations:{},actions:{DIR_IMAGE_LIST_ADD_DIR({state:e,dispatch:a},t){if("/"===t)return;const l=(e,a,t)=>{if(e){e.childrenDirs.some((e=>e.dir===a))||e.childrenDirs.push(qe(a,t));return e.childrenDirs.find((e=>e.dir===a))||qe(a,t)}return qe(a,t)},i=t.split("/");let n="",s=e.dirObject;for(let o=0,r=i.length;o<r;o++){const e=i[o];n+=`${o>0?"/":""}${e}`,s=l(s,e,n),0===o&&a("USER_CONFIG_INFO_ADD_DIR",e)}a("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_REMOVE_DIR({state:e,dispatch:a},t){if("/"===t)return;const l=t.split("/");let i=e.dirObject;l.forEach(((a,t)=>{i=((a,t,l)=>{if("/"===t)return e.dirObject;const i=a.childrenDirs.find((e=>e.dir===t));if(!i)return a;if(l){const e=a.childrenDirs.findIndex((e=>e.dir===t));-1!==e&&a.childrenDirs.splice(e,1)}return i})(i,a,t===l.length-1)})),a("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_ADD_IMAGE({state:e,dispatch:a},t){let l=e.dirObject;if("/"===t.dir)l.imageList.some((e=>e.name===t.name))||l.imageList.push(t);else{const a=t.dir.split("/");let i="";a.forEach(((n,s)=>{i+=`${s>0?"/":""}${n}`,l=((a,t,l,i,n=!1)=>{var s;if(!a)return e.dirObject;let o=null==(s=a.childrenDirs)?void 0:s.find((e=>e.dir===t));return o||(o={type:"dir",dir:t,dirPath:l,childrenDirs:[],imageList:[]},a.childrenDirs.push(o)),n&&!o.imageList.some((e=>e.name===i.name))&&o.imageList.push(i),o})(l,n,i,t,s===a.length-1)}))}a("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_REMOVE({state:e,dispatch:a},t){const l=(e,a)=>{if(e.length){const t=e.findIndex((e=>e.uuid===a));-1!==t&&e.splice(t,1)}},{dir:i,uuid:n}=t;if("/"===i)return l(e.dirObject.imageList,n),void a("DIR_IMAGE_LIST_PERSIST");const s=i.split("/");let o=e.dirObject;s.forEach(((i,n)=>{if(o=((a,t,i,n)=>{if(!a)return e.dirObject;const s=a.childrenDirs.find((e=>e.dir===t));return s?(s.dir===t&&n&&l(s.imageList,i.uuid),s):e.dirObject})(o,i,t,n===s.length-1),!o.imageList.length&&!o.childrenDirs.length){const t=(e=>{if("/"===e)return[];const a=e.split("/"),t=[];let l="";return a.forEach(((e,a)=>{l+=`${a>0?"/":""}${e}`,t.unshift(l)})),t})(o.dirPath);t.forEach((t=>{const l=Je(t,e.dirObject);if(l&&!l.imageList.length&&!l.childrenDirs.length){const{dirPath:e}=(e=>{if("/"===e)return{currentDir:"/",dirPath:"/"};const a=e.split("/");return 1===a.length?{currentDir:"/",dirPath:"/"}:a.length>1?(a.length-=1,{currentDir:a[a.length-1],dirPath:a.join("/")}):{currentDir:"/",dirPath:"/"}})(t),l=e,i=e;let n=i.split("/");"/"===e&&(n=[],a("USER_CONFIG_INFO_REMOVE_DIR",t)),a("SET_USER_CONFIG_INFO",{viewDir:l,selectedDir:i,selectedDirList:n}),a("DIR_IMAGE_LIST_REMOVE_DIR",t)}}))}}))},DIR_IMAGE_LIST_INIT_DIR({state:e,dispatch:a},t){let l=e.dirObject;if("/"===t)return l.imageList=[],l.childrenDirs=[],void a("DIR_IMAGE_LIST_PERSIST");const i=t.split("/");i.forEach(((a,t)=>{l=((a,t,l)=>{var i;if(!a)return e.dirObject;const n=null==(i=a.childrenDirs)?void 0:i.find((e=>e.dir===t));return n?(l&&(n.imageList=[],n.childrenDirs=[]),n):e.dirObject})(l,a,t===i.length-1)})),a("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_PERSIST({state:e}){localStorage.setItem("PICX_MANAGEMENT",JSON.stringify(e.dirObject))},DIR_IMAGE_LOGOUT({state:e,dispatch:a}){e.dirObject=qe("/","/"),a("DIR_IMAGE_LIST_PERSIST")}},getters:{getDirObject:e=>e.dirObject}};var Ze,ea,aa,ta,la,ia,na,sa,oa,ra,ca,da,ua,ma,ga,pa,ha,fa,va,_a;(ea=Ze||(Ze={})).uploaded="uploaded",ea.allUploaded="allUploaded",ea.uploadFail="uploadFail",(ta=aa||(aa={})).deleted="deleted",ta.allDeleted="allDeleted",ta.deleteFail="deleteFail",(ia=la||(la={})).mozJPEG="mozJPEG",ia.avif="avif",ia.webP="webP",(sa=na||(na={})).newBranch="newBranch",sa.repoBranch="repoBranch",(ra=oa||(oa={})).autoDir="autoDir",ra.newDir="newDir",ra.rootDir="rootDir",ra.repoDir="repoDir",(da=ca||(ca={})).large="large",da.default="default",da.small="small",(ma=ua||(ua={})).leftTop="leftTop",ma.leftBottom="leftBottom",ma.rightTop="rightTop",ma.rightBottom="rightBottom",(pa=ga||(ga={})).system="system",pa.light="light",pa.dark="dark",(fa=ha||(ha={})).zhCN="zh-CN",fa.zhTW="zh-TW",fa.en="en",(_a=va||(va={}))[_a.parentDir=0]="parentDir",_a[_a.childDir=1]="childDir",_a[_a.img=2]="img";const ba=c({locale:"zh-CN",messages:{"zh-CN":{repo:"仓库",branch:"分支",dir:"目录",tips:"提示",delete:"删除",reset:"重置",confirm:"确定",cancel:"取消",author:"作者",document:"文档",shortcut_key:"快捷键",copy_link:"复制图片链接",copy_success_1:"图片链接已自动复制到系统剪贴板",copy_success_2:"图片链接复制成功",copy_fail_1:"复制失败",header:{notLogin:"未登录",login:"登录",logout:"退出登录",language:"语言",theme:"主题",usage_count:"使用次数"},nav:{config:"图床配置",upload:"上传图片",management:"图床管理",settings:"我的设置",toolbox:"工具箱",feedback:"帮助反馈",actions:"快捷操作"},actions:{watermark:"添加水印",compress:"压缩图片",transform:"转换 "},settings:{img_name:{title:"图片名称设置",hash_switch_name:"自动哈希化",hash_switch_desc:"上传前自动给图片名增加哈希码，确保图片名唯一，强烈建议开启",prefix_switch_name:"添加前缀命名",prefix_switch_desc:"上传前自动给图片名增加前缀，例如：abc-image.jpg，abc- 为前缀",prefix_input_placeholder:"请输入命名前缀 ...",timestamp_switch_name:"自动时间戳命名"},img_watermark:{title:"图片水印设置",switch_name:"是否添加水印",switch_desc:"开启后可以自定义水印文字、字体大小、位置、颜色和透明度",text:"水印文字",text_input_placeholder:"请输入水印文字，限制 20 字",size:"水印大小",color:"水印颜色",opacity:"水印透明度",position:"水印位置",position_1:"左上角",position_2:"左下角",position_3:"右上角",position_4:"右下角"},img_compress:{title:"图片压缩设置",switch_name:"是否压缩图片",switch_desc:"开启后上传前会自动压缩图片，有效缩短图片上传和加载时间，强烈建议开启",radio_group_title:"选择图片压缩算法",radio_1:"webP",radio_1_desc:"压缩后图片格式为 webp，压缩率较高，大多数浏览器支持",radio_2:"mozJPEG",radio_2_desc:"压缩后图片格式为 jpg，兼容性最好，所有浏览器支持",radio_3:"avif",radio_3_desc:"压缩后图片格式为 avif，压缩率极高，部分现代浏览器支持"},link_rule:{title:"图片链接规则配置",select_title:"选择图片链接规则",card_title:"配置自定义图片链接规则",card_table_col_title_1:"类型",card_table_col_title_2:"CDN 规则",card_table_col_title_3:"操作",input_name_1:"图片链接类型",input_name_1_rule:"图片链接类型名称不能为空",input_name_2:"图片链接规则",input_name_2_rule:"图片链接规则不能为空",btn_name_1:"添加图片链接规则"},link_format:{title:"图片链接格式设置",switch_name:"自动转换图片链接格式",switch_desc:"上传成功后复制的图片链接自动转换成 {type} 格式",select_title:"选择图片链接格式",delete_tips:"此操作将永久删除图片链接规则"},theme:{title:"主题设置",system:"跟随系统",dark:"暗夜",light:"白昼"}},config:{inputToken:"请输入 GitHub Token ...",manualConfiguration1:"手动配置",manualConfiguration2:"重新手动配置",manualConfiguration3:"使用已有的 GitHub 仓库，逐步完成配置",autoConfiguration1:"一键自动配置",autoConfiguration2:"重新一键自动配置",autoConfiguration3:"自动创建 GitHub 仓库（适合新用户）",username:"用户名",email:"邮箱",selectRepo:"选择仓库",selectBranch:"选择分支",loading1:"正在加载用户信息 ...",loading2:"正在加载分支信息 ...",loading3:"正在加载用户信息 ...",loading4:"正在加载{type}数据 ...",loading5:"正在加载目录信息 ...",loading6:"正在自动配置 ...",placeholder1:"请选择图床仓库 ...",placeholder2:"请选择分支 ...",placeholder3:"请输入新建的分支 ...",placeholder4:"请输入新建的目录 ...",placeholder5:"请选择一个目录 ...",message1:"GitHub Token 不能为空",message2:"用户信息获取失败，请确认 Token 是否正确",message3:"自动创建 GitHub 仓库失败，请稍后再试",message4:"自动配置成功",message5:"一键自动配置失败，请重试",message6:"目录不能为空",message7:"请输入一个新目录",message8:"请选择 {repo} 仓库里的一个目录",message9:"仓库信息获取失败，请稍后重试",message10:"分支信息获取失败，请稍后再试",message11:"用户信息获取失败，请确认 GitHub Token 是否有效",message12:"请输入分支名称",message13:"{branch} 分支已存在，请在分支列表中选择",message14:"{branch} 分支创建成功",createBranch:"新建分支",branchMode:"分支方式",selectBranch2:"选择 {repo}} 仓库里的分支",reload:"重新载入所有{type}数据",dirMode:"目录模式",inputNewDir:"手动输入一个新目录",createNewDir:"新建目录",rootDir:"根目录",rootDir2:"图片存储在 {branch} 分支的根目录下",autoDir:"自动目录",autoDir2:"根据日期自动创建格式 yyyyMMdd 的目录",repoDir:"选择 {repo} 仓库目录",repoDir2:"选择 {branch} 分支里的一个目录",selectDir:"选择目录"},upload:{uploadAreaTips:"拖拽 / 粘贴 / 点击此处选择图片",uploaded:"已上传",upload:"上传",message1:"请先完成图床配置",message2:"请选择一个仓库",message3:"目录不能为空",message4:"请选择要上传的图片",message5:"图片上传成功",message6:"图片批量上传成功",message7:"上传失败，请稍后重试",message8:"图片上传成功",fold:"折叠",expand:"展开",hash:"哈希化",rename:"重命名","timestamp-naming":"时间戳命名",prefixNaming:"前缀命名",delete:"删除",copyLink:"复制图片链接",loading1:"正在上传 ..."},management:{reload:"重新加载 {dir} 目录所有数据",loadingTxt1:"加载中 ...",loadingTxt2:"正在重命名 ...",loadingTxt3:"删除中 ...",back:"双击后退",toNextDir:"双击进入下一级目录",property:"属性",delTips:"此操作将会永久删除图片",delTips2:"已选中 {total} 张图片，是否批量删除？",renameTips:"该图片重命名为 {name} ？",message1:"图片名不能为空",message2:"图片名无改变",message3:"重命名失败",message4:"更新成功",message5:"删除成功",message6:"批量删除成功",message7:"删除失败，请稍后重试",imageName:"图片名称",imageSize:"图片大小",selectAll:"全选",deselectAll:"取消全选",unselect:"取消选择",batchCopy:"批量复制图片链接",batchDelete:"批量删除图片",selectTotal:"已选择 {total} 张图片",contextmenu_1:"从当前位置上传新图片",contextmenu_2:"上传图片到 < {dir} >",contextmenu_3:"根目录"},toolbox:{tool_1:"图片压缩",tool_1_desc:"不限制图片大小和数量，不上传至服务器的离线极致压缩",tool_2:"图片转 Base64",tool_2_desc:"不限制图片大小和数量，在线转换成 Base64 编码",tool_3:"图片水印 ",tool_3_desc:"自定义水印文字、字体大小、位置、颜色和透明度",copy_base64:"点击复制 Base64 编码",copy_base64_success:"Base64 编码复制成功",click_download:"点击下载",compress:"压缩",batch_download:"批量下载",add_watermark:"添加水印"},feedback:{text_1:"PicX 是一款基于 GitHub API 开发的图床工具，提供图片上传托管、生成图片链接和常用图片工具箱服务。",text_2:"建议将本站添加到浏览器收藏夹，方便下次使用。",text_3:"如果 PicX 对你有帮助，欢迎赞赏作者，支持开源。",text_4:"郑重声明：请勿使用 PicX 上传违反你当地法律的图片，所造成的一切后果与作者无关。"},region:{CN:"中国大陆",HK:"中国香港",MO:"中国澳门",TW:"中国台湾",SG:"新加坡",JP:"日本",US:"美国"},language:{"zh-CN":"中文简体","zh-TW":"中文繁体",en:"英文"},"toggle-language-msg":"检测到你的 IP 所属地为{region}，是否切换{language}？"},"zh-TW":{repo:"倉庫",branch:"分支",dir:"目錄",tips:"提示",delete:"刪除",reset:"重置",confirm:"確定",cancel:"取消",author:"作者",document:"文檔",shortcut_key:"快捷鍵",copy_link:"復製圖片鏈接",copy_success_1:"圖片鏈接已自動復製到系統剪貼板",copy_success_2:"圖片鏈接復製成功",copy_fail_1:"復製失敗",header:{notLogin:"未登錄",login:"登錄",logout:"退出登錄",language:"語言",theme:"主題",usage_count:"使用次數"},nav:{config:"圖床配置",upload:"上傳圖片",management:"圖床管理",settings:"我的設置",toolbox:"工具箱",feedback:"幫助反饋",actions:"快捷操作"},actions:{watermark:"添加水印",compress:"壓縮圖片",transform:"轉換 "},settings:{img_name:{title:"圖片名稱設置",hash_switch_name:"自動哈希化",hash_switch_desc:"上傳前自動給圖片名增加哈希碼，確保圖片名唯一，強烈建議開啟",prefix_switch_name:"添加前綴命名",prefix_switch_desc:"上傳前自動給圖片名增加前綴，例如：abc-image.jpg，abc- 為前綴",prefix_input_placeholder:"請輸入命名前綴 ...",timestamp_switch_name:"自動時間戳命名"},img_watermark:{title:"圖片水印設置",switch_name:"是否添加水印",switch_desc:"開啟後可以自定義水印文字、字體大小、位置、顏色和透明度",text:"水印文字",text_input_placeholder:"請輸入水印文字，限製 20 字",size:"水印大小",color:"水印顏色",opacity:"水印透明度",position:"水印位置",position_1:"左上角",position_2:"左下角",position_3:"右上角",position_4:"右下角"},img_compress:{title:"圖片壓縮設置",switch_name:"是否壓縮圖片",switch_desc:"開啟後上傳前會自動壓縮圖片，有效縮短圖片上傳和加載時間，強烈建議開啟",radio_group_title:"選擇圖片壓縮算法",radio_1:"webP",radio_1_desc:"壓縮後圖片格式為 webp，壓縮率較高，大多數瀏覽器支持",radio_2:"mozJPEG",radio_2_desc:"壓縮後圖片格式為 jpg，兼容性最好，所有瀏覽器支持",radio_3:"avif",radio_3_desc:"壓縮後圖片格式為 avif，壓縮率極高，部分現代瀏覽器支持"},link_rule:{title:"圖片鏈接規則配置",select_title:"選擇圖片鏈接規則",card_title:"配置自定義圖片鏈接規則",card_table_col_title_1:"類型",card_table_col_title_2:"CDN 規則",card_table_col_title_3:"操作",input_name_1:"圖片鏈接類型",input_name_1_rule:"圖片鏈接類型名稱不能為空",input_name_2:"圖片鏈接規則",input_name_2_rule:"圖片鏈接規則不能為空",btn_name_1:"添加圖片鏈接規則"},link_format:{title:"圖片鏈接格式設置",switch_name:"自動轉換圖片鏈接格式",switch_desc:"上傳成功後復製的圖片鏈接自動轉換成 {type} 格式",select_title:"選擇圖片鏈接格式",delete_tips:"此操作將永久刪除圖片鏈接規則"},theme:{title:"主題設置",system:"跟隨系統",dark:"暗夜",light:"白晝"}},config:{inputToken:"請輸入 GitHub Token ...",manualConfiguration1:"手動配置",manualConfiguration2:"重新手動配置",manualConfiguration3:"使用已有的 GitHub 倉庫，逐步完成配置",autoConfiguration1:"一鍵自動配置",autoConfiguration2:"重新一鍵自動配置",autoConfiguration3:"自動創建 GitHub 倉庫（適合新用戶）",username:"用戶名",email:"郵箱",selectRepo:"選擇倉庫",selectBranch:"選擇分支",loading1:"正在加載用戶信息 ...",loading2:"正在加載分支信息 ...",loading3:"正在加載用戶信息 ...",loading4:"正在加載{type}數據 ...",loading5:"正在加載目錄信息 ...",loading6:"正在自動配置 ...",placeholder1:"請選擇圖床倉庫 ...",placeholder2:"請選擇分支 ...",placeholder3:"請輸入新建的分支 ...",placeholder4:"請輸入新建的目錄 ...",placeholder5:"請選擇一個目錄 ...",message1:"GitHub Token 不能為空",message2:"用戶信息獲取失敗，請確認 Token 是否正確",message3:"自動創建 GitHub 倉庫失敗，請稍後再試",message4:"自動配置成功",message5:"一鍵自動配置失敗，請重試",message6:"目錄不能為空",message7:"請輸入一個新目錄",message8:"請選擇 {repo} 倉庫裏的一個目錄",message9:"倉庫信息獲取失敗，請稍後重試",message10:"分支信息獲取失敗，請稍後再試",message11:"用戶信息獲取失敗，請確認 GitHub Token 是否有效",message12:"請輸入分支名稱",message13:"{branch} 分支已存在，請在分支列表中選擇",message14:"{branch} 分支創建成功",createBranch:"新建分支",branchMode:"分支方式",selectBranch2:"選擇 {repo}} 倉庫裏的分支",reload:"重新載入所有{type}數據",dirMode:"目錄模式",inputNewDir:"手動輸入一個新目錄",createNewDir:"新建目錄",rootDir:"根目錄",rootDir2:"圖片存儲在 {branch} 分支的根目錄下",autoDir:"自動目錄",autoDir2:"根據日期自動創建格式 yyyyMMdd 的目錄",repoDir:"選擇 {repo} 倉庫目錄",repoDir2:"選擇 {branch} 分支裏的一個目錄",selectDir:"選擇目錄"},upload:{uploadAreaTips:"拖拽 / 粘貼 / 點擊此處選擇圖片",uploaded:"已上傳",upload:"上傳",message1:"請先完成圖床配置",message2:"請選擇一個倉庫",message3:"目錄不能為空",message4:"請選擇要上傳的圖片",message5:"圖片上傳成功",message6:"圖片批量上傳成功",message7:"上傳失敗，請稍後重試",message8:"圖片上傳成功",fold:"折疊",expand:"展開",hash:"哈希化",rename:"重命名","timestamp-naming":"時間戳命名",prefixNaming:"前綴命名",delete:"刪除",copyLink:"復製圖片鏈接",loading1:"正在上傳 ..."},management:{reload:"重新加載 {dir} 目錄所有數據",loadingTxt1:"加載中 ...",loadingTxt2:"正在重命名 ...",loadingTxt3:"刪除中 ...",back:"雙擊後退",toNextDir:"雙擊進入下一級目錄",property:"屬性",delTips:"此操作將會永久刪除圖片",delTips2:"已選中 {total} 張圖片，是否批量刪除？",renameTips:"該圖片重命名為 {name} ？",message1:"圖片名不能為空",message2:"圖片名無改變",message3:"重命名失敗",message4:"更新成功",message5:"刪除成功",message6:"批量刪除成功",message7:"刪除失敗，請稍後重試",imageName:"圖片名稱",imageSize:"圖片大小",selectAll:"全選",deselectAll:"取消全選",unselect:"取消選擇",batchCopy:"批量復製圖片鏈接",batchDelete:"批量刪除圖片",selectTotal:"已選擇 {total} 張圖片",contextmenu_1:"從當前位置上傳新圖片",contextmenu_2:"上傳圖片到 < {dir} >",contextmenu_3:"根目錄"},toolbox:{tool_1:"圖片壓縮",tool_1_desc:"不限製圖片大小和數量，不上傳至服務器的離線極致壓縮",tool_2:"圖片轉 Base64",tool_2_desc:"不限製圖片大小和數量，在線轉換成 Base64 編碼",tool_3:"圖片水印 ",tool_3_desc:"自定義水印文字、字體大小、位置、顏色和透明度",copy_base64:"點擊復製 Base64 編碼",copy_base64_success:"Base64 編碼復製成功",click_download:"點擊下載",compress:"壓縮",batch_download:"批量下載",add_watermark:"添加水印"},feedback:{text_1:"PicX 是一款基於 GitHub API 開發的圖床工具，提供圖片上傳托管、生成圖片鏈接和常用圖片工具箱服務。",text_2:"建議將本站添加到瀏覽器收藏夾，方便下次使用。",text_3:"如果 PicX 對你有幫助，歡迎贊賞作者，支持開源。",text_4:"鄭重聲明：請勿使用 PicX 上傳違反你當地法律的圖片，所造成的一切後果與作者無關。"},region:{CN:"中國大陸",HK:"中國香港",MO:"中国澳门",TW:"中國臺灣",SG:"新加坡",JP:"日本",US:"美國"},language:{"zh-CN":"中文簡體","zh-TW":"中文繁體",en:"英文"},"toggle-language-msg":"檢測到你的 IP 所屬地為{region}，是否切換{language}？"},en:{repo:"Repository",branch:"Branch",dir:"Directory",tips:"Tips",delete:"Delete",reset:"Reset",confirm:"Confirm",cancel:"Cancel",author:"Author",document:"Document",shortcut_key:"Shortcut key",copy_link:"Copy image link",copy_success_1:"The image link has been automatically copied to the system clipboard",copy_success_2:"Image link copied successfully",copy_fail_1:"Copy failed",header:{notLogin:"Not log in",login:"Log in",logout:"Log out",language:"Language",theme:"Theme",usage_count:"Usage count"},nav:{config:"Image Hosting Config",upload:"Upload Image",management:"Image Hosting Management",settings:"My Settings",toolbox:"Toolbox",feedback:"Feedback",actions:"Quick actions"},actions:{compress:"Compress Image",watermark:"Add Watermark",transform:"Transform "},settings:{img_name:{title:"Image Name Settings",hash_switch_name:"Hashing",hash_switch_desc:"Automatically add a hash code to the image name before uploading to ensure uniqueness. It is strongly recommended to turn on this feature.",prefix_switch_name:"Add Prefix",prefix_switch_desc:"Automatically add a prefix to the image name before uploading. For example: abc-image.jpg, where abc- is the prefix.",prefix_input_placeholder:"Please enter the name prefix...",timestamp_switch_name:"Automatically timestamp naming"},img_watermark:{title:"Image Watermark Settings",switch_name:"Add Watermark",switch_desc:"After turning on this feature, you can customize the watermark text, font size, position, color, and transparency.",text:"Text",text_input_placeholder:"Please enter the watermark text, limited to 20 characters.",size:"Size",color:"Color",opacity:"Opacity",position:"Position",position_1:"Top Left",position_2:"Bottom Left",position_3:"Top Right",position_4:"Bottom Right"},img_compress:{title:"Image Compression Settings",switch_name:"Compress Images",switch_desc:"After enable, the image will be auto compressed before uploading, which can effectively shorten the image upload and loading time. It is strongly recommended enable.",radio_group_title:"Select image compression algorithm",radio_1:"WebP",radio_1_desc:"The compressed image format is webp, which has a higher compression ratio and is supported by most browsers.",radio_2:"MozJPEG",radio_2_desc:"The compressed image format is jpg, which has the best compatibility and is supported by all browsers.",radio_3:"AVIF",radio_3_desc:"The compressed image format is avif, which has an extremely high compression ratio and is supported by some modern browsers."},link_rule:{title:"Image Link Rules Configuration",select_title:"Select Image Link Rule",card_title:"Configure Custom Image Link Rules",card_table_col_title_1:"Type",card_table_col_title_2:"CDN Rule",card_table_col_title_3:"Action",input_name_1:"Link Type",input_name_1_rule:"The Image Link Type Name cannot be empty.",input_name_2:"Link Rule",input_name_2_rule:"The Image Link Rule cannot be empty.",btn_name_1:"Add Image Link Rule"},link_format:{title:"Image Link Format Settings",switch_name:"Automatically Convert Image Link Format",switch_desc:"After a successful upload, the copied image link will be automatically converted to the {type} format.",select_title:"Select Image Link Format",delete_tips:"This operation will permanently delete the image link rule"},theme:{title:"Theme Settings",system:"System",dark:"Dark",light:"Light"}},config:{inputToken:"Please input GitHub Token ...",manualConfiguration1:"Manual Configuration",manualConfiguration2:"Reconfigure Manually",manualConfiguration3:"Configure using an existing GitHub repository step by step",autoConfiguration1:"One-click Automatic Configuration",autoConfiguration2:"Reconfigure Automatically",autoConfiguration3:"Automatically create a GitHub repository (suitable for new users)",username:"Username",email:"Email",selectRepo:"Select Repo",selectBranch:"Select Branch",loading1:"Loading user information ...",loading2:"Loading branch information ...",loading3:"Loading user information ...",loading4:"Loading {type} data ...",loading5:"Loading directory information ...",loading6:"Automatically configuring ...",placeholder1:"Please select image hosting repository ...",placeholder2:"Please select branch ...",placeholder3:"Please enter the name of new branch ...",placeholder4:"Please enter the newly created directory ...",placeholder5:"Please select a directory ...",message1:"GitHub token cannot be empty",message2:"Failed to retrieve user information, please verify that the token is correct",message3:"Failed to automatically create GitHub repository, please try again later",message4:"Automated configuration successful",message5:"One-click automated configuration failed, please try again.",message6:"Directory cannot be empty",message7:"Please enter a new directory",message8:"Please select a directory in the {repo} repository",message9:"Failed to retrieve repository information, please try again later",message10:"Failed to retrieve branch information, please try again later",message11:"Failed to retrieve user information, please verify that the GitHub Token is valid",message12:"Please enter a branch name",message13:"The {branch} branch already exists, please select from the list of branches",message14:"The {branch} branch was created successfully.",createBranch:"Create new branch",reload:"Reload all {type} data",dirMode:"Dir Mode",inputNewDir:"Manually input a new directory",createNewDir:"New Dir",rootDir:"Root Dir",rootDir2:"Images are stored in the root directory of {branch} branch",autoDir:"Auto Dir",autoDir2:"Automatically create a directory with format yyyyMMdd",repoDir:"Select directory in {repo} repository",repoDir2:"Choose a directory in the {branch} branch",selectDir:"Select Dir"},upload:{uploadAreaTips:"Drag / Paste / Click here to select images",uploaded:"Uploaded",upload:"Upload",message1:"Please complete the image hosting configuration first",message2:"Please select a repository",message3:"Directory cannot be empty",message4:"Please select an image to upload",message5:"Image uploaded successfully",message6:"Images uploaded successfully in batch",message7:"Upload failed, please try again later",message8:"Image uploaded successfully",fold:"Fold",expand:"Expand",hash:"Hashing",rename:"Rename","timestamp-naming":"Timestamp Naming",prefixNaming:"Prefix Naming",delete:"Delete",copyLink:"Copy image link",loading1:"Uploading ..."},management:{reload:"Reload all data in the {dir} directory",loadingTxt1:"Loading ...",loadingTxt2:"Renaming ...",loadingTxt3:"Deleting ...",back:"Double-click back",toNextDir:"Double-click to enter the next level directory",property:"Property",delTips:"This operation will permanently delete the image",delTips2:"Are you sure you want to delete the selected {total} images in bulk?",renameTips:"Rename this picture to {name}?",message1:"Image name cannot be empty",message2:"Image name unchanged",message3:"Rename failed",message4:"Update successfully",message5:"Delete successfully",message6:"Batch delete successfully",message7:"Deletion failed, please try again later",imageName:"Image name",imageSize:"Image size",selectAll:"Select all",deselectAll:"Deselect all",unselect:"Unselect",batchCopy:"Batch copy image link",batchDelete:"Batch delete image",selectTotal:"Selected {total} images",contextmenu_1:"Upload new image from current location",contextmenu_2:"Upload image to < {dir} >",contextmenu_3:"Root directory"},toolbox:{tool_1:"Image Compressor",tool_1_desc:"Offline ultimate compression without size or quantity limit, and without uploading to server",tool_2:"Image to Base64",tool_2_desc:"Online conversion of images to Base64 encoding without size or quantity limit",tool_3:"Image Watermark",tool_3_desc:"Customize watermark text, font size, position, color and opacity",copy_base64:"Click to copy Base64 encoding",copy_base64_success:"Base64 encoding copied successfully",click_download:"Click to download",compress:"Compress",batch_download:"Batch Download",add_watermark:"Add Watermark"},feedback:{text_1:"PicX is a GitHub API based image hosting tool, providing image upload and hosting, generating image links, and a set of commonly used image tools.",text_2:"We suggest adding our website to your browser bookmarks for easy future access.",text_3:"If PicX is helpful to you, please consider donating to the author to support open source development.",text_4:"Disclaimer: Do not upload images that violate the laws in your local jurisdiction. The author is not responsible for any consequences arising from such actions."},region:{CN:"Mainland China",HK:"Hong Kong, China",MO:"Macao, China",TW:"Taiwan, China",SG:"Singapore",JP:"Japan",US:"United States"},language:{"zh-CN":"Simplified Chinese","zh-TW":"Traditional Chinese",en:"English"},"toggle-language-msg":"We detected that your IP is located in {region}. Do you want to switch to {language}?"}}}),ya=e=>{const a=Object.prototype.toString.call(e).split(" ")[1];return a.substring(0,a.length-1).toLowerCase()},wa=()=>Number(Math.random().toString().substr(2,5)+Date.now()).toString(36),ka=(e,a)=>{navigator.clipboard.writeText(e).then((()=>{a&&a()}))},Ia=e=>{for(const a in e)switch(ya(e[a])){case"object":Ia(e[a]);break;case"string":e[a]="";break;case"array":e[a]=[];break;case"number":e[a]=0;break;case"boolean":e[a]=!1}},xa=(e,a)=>{for(const t in a)"object"!==ya(a[t])?e&&(e[t]=a[t]):e[t]&&xa(e[t],a[t])},Sa=(e="yyyy-MM-dd hh:mm:ss",a=Date.now())=>{function t(e){return`00${e}`.substr(e.length)}const l=new Date(a);/(y+)/.test(e)&&(e=e.replace(RegExp.$1,`${l.getFullYear()}`.substr(4-RegExp.$1.length)));const i={"M+":l.getMonth()+1,"d+":l.getDate(),"h+":l.getHours(),"m+":l.getMinutes(),"s+":l.getSeconds()};for(const n in i)if(new RegExp(`(${n})`).test(e)){const a=`${i[n]}`;e=e.replace(RegExp.$1,1===RegExp.$1.length?a:t(a))}return e},La=e=>{e&&(window.document.title=`${ba.global.t(e)} | PicX`)};async function Ta(e,a){const{text:t,fontSize:l,position:i,textColor:n,opacity:s}=a,[o,r,c]=(d=n,d?(d=d.replace("#",""),`${parseInt(d.substring(0,2),16)}, ${parseInt(d.substring(2,4),16)}, ${parseInt(d.substring(4,6),16)}`):"255,255,255").split(",");var d;const u=await function(e){return new Promise(((a,t)=>{const l=new FileReader;l.onload=()=>{const e=new Image;e.setAttribute("crossOrigin","Anonymous"),e.onload=()=>a(e),e.onerror=t,e.src=l.result},l.onerror=t,l.readAsDataURL(e)}))}(e),m=document.createElement("canvas"),g=m.getContext("2d");m.width=u.width,m.height=u.height,g.drawImage(u,0,0),g.font=`bold ${l}px Arial`,g.strokeStyle=`rgba(0, 0, 0, ${s})`,g.lineWidth=3,g.fillStyle=`rgba(${o}, ${r}, ${c}, ${s})`;let p=0,h=0;switch(i){case ua.leftTop:p=10,h=l+5;break;case ua.rightTop:p=m.width-g.measureText(t).width-10,h=l+5;break;case ua.leftBottom:p=10,h=m.height-15;break;case ua.rightBottom:p=m.width-g.measureText(t).width-10,h=m.height-15}return g.strokeText(t,p,h),g.fillText(t,p,h),new Promise((a=>{m.toBlob((t=>{if(t){const l=new File([t],e.name,{type:e.type});a(l)}else a(null)}),e.type)}))}const $a=(e,a=!1)=>{e.forEach((e=>{e.deleting=a}))};async function Ca(e,a){if(1===e.length)return await async function(e,a){e.deleting=!0;const{owner:t,selectedRepo:l}=a,{path:i,sha:n}=e;return new Promise((async a=>{const s=await lt(t,l,i,n);e.deleting=!1,s?(a(!0),await Ja.dispatch("UPLOAD_IMG_LIST_REMOVE",e.uuid),await Ja.dispatch("DIR_IMAGE_LIST_REMOVE",e)):a(!1)}))}(e[0],a)?aa.deleted:aa.deleteFail;try{return await async function(e,a){$a(e,!0);const{owner:t,selectedRepo:l,selectedBranch:i}=a,n=await at(t,l,i);if(!n)throw $a(e,!1),new Error("获取分支信息失败");const s=await nt(t,l,e.map((e=>({path:e.path,sha:null}))),n);if(!s)throw $a(e,!1),new Error("创建 tree 失败");const o=await st(t,l,s,n);if(!o)throw $a(e,!1),new Error("创建 commit 失败");if(!(await ot(t,l,i,o.sha)))throw $a(e,!1),new Error("更新 ref 失败");e.forEach((e=>{e.deleting=!1,Ja.dispatch("UPLOAD_IMG_LIST_REMOVE",e.uuid),Ja.dispatch("DIR_IMAGE_LIST_REMOVE",e)}))}(e,a),aa.allDeleted}catch(t){return console.error(t),aa.deleteFail}}function Da(e){return new Promise((a=>{const t=new FileReader;t.readAsDataURL(e),t.onload=()=>{const e=t.result;a(e)},t.onerror=()=>a(null)}))}function Ea(e){const a=URL.createObjectURL(e),t=document.createElement("a");t.href=a,t.download=e.name,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(a)}const Oa=e=>{const a=e.indexOf(".");return e.substr(0,a).trim().replace(/\s+/g,"-")},Ra=e=>{const a=e.lastIndexOf(".");return e.slice(a+1)},Aa=e=>/(png|jpg|jpeg|gif|webp|awebp|avif|svg\+xml|svg|x-icon|vnd.microsoft.icon)$/.test(e),Na=e=>e?Number((e/1024).toFixed(0)):e,Ma=e=>new Promise((async a=>{e||a(null),Aa(e.type)||(o.error(`${e.name} 不是图片格式`),a(null));const t=await Da(e)||"";Na(t.length)>=30720&&(o.error(`${e.name} 超过 30 MB，跳过选择`),a(null)),a({uuid:wa(),base64:t,file:e})})),Ua=async(e,a)=>{if(t=e.type,/(png|jpg|jpeg|webp|avif)$/.test(t)){return new d(e,{encoderState:{type:a,options:u[a].meta.defaultOptions},processorState:m,preprocessorState:g}).process()}var t;return e},za=(e,a,t)=>{var l;const i=t.imageLinkType.selected,n=null==(l=t.imageLinkType.presetList.find((e=>e.name===i)))?void 0:l.rule;if(n){const{owner:t,selectedRepo:l,selectedBranch:i}=a;return n.replaceAll("{{owner}}",t).replaceAll("{{repo}}",l).replaceAll("{{branch}}",i).replaceAll("{{path}}",e.path)}return null},Pa=(e,a,t)=>{var l;if(t.imageLinkFormat.enable){const i=t.imageLinkFormat.selected,n=null==(l=t.imageLinkFormat.presetList.find((e=>e.name===i)))?void 0:l.format;if(n)return n.replaceAll("imageLink",e||"").replaceAll("imageName",a.split(".")[0])}return e},ja=(e=!1)=>{const a=e?ba.global.t("copy_success_1"):ba.global.t("copy_success_2");o({type:e?"info":"success",message:a,duration:e?6e3:4e3})},Ba=(e,a,t,l=!1)=>{const i=Pa(za(e,a,t),e.name,t);i?ka(i,(()=>{ja(l)})):o.error({message:ba.global.t("copy_fail_1")})},Va=(e,a,t,l=!1)=>{if((null==e?void 0:e.length)>0){let i="";e.forEach(((l,n)=>{const s=Pa(za(l,a,t),l.name,t);i+=`${s}${n<e.length-1?"\n":""}`})),ka(i,(()=>{ja(l)}))}},Ga=()=>{const{platform:e}=navigator;return e.includes("Mac")?"mac":e.includes("Win")?"win":e.includes("Linux")?"linux":null},Fa=()=>{const e={token:"",owner:"",email:"",name:"",avatarUrl:"",selectedRepo:"",repoList:[],branchMode:na.repoBranch,branchList:[],selectedBranch:"",selectedDir:"",dirMode:oa.repoDir,dirList:[],logined:!1,selectedDirList:[],viewDir:""},a=localStorage.getItem("PICX_CONFIG");return a?(xa(e,JSON.parse(a)),e.selectedBranch&&!e.branchList.length&&(e.branchList=[{value:e.selectedBranch,label:e.selectedBranch}]),e.dirMode===oa.autoDir&&(e.selectedDir=Sa("yyyyMMdd")),e):e},Ha={state:{userConfigInfo:Fa()},actions:{USER_CONFIG_INFO_RESET({state:e}){e.userConfigInfo=Fa()},SET_USER_CONFIG_INFO({state:e,dispatch:a},t){for(const l in t)e.userConfigInfo.hasOwnProperty(l)&&(e.userConfigInfo[l]=t[l]);a("USER_CONFIG_INFO_PERSIST")},USER_CONFIG_INFO_ADD_DIR({state:e,dispatch:a},t){e.userConfigInfo.dirList.some((e=>e.value===t))||(e.userConfigInfo.dirList.push({label:t,value:t}),a("USER_CONFIG_INFO_PERSIST"))},USER_CONFIG_INFO_REMOVE_DIR({state:e,dispatch:a},t){const{dirList:l}=e.userConfigInfo;if(l.some((e=>e.value===t))){const e=l.findIndex((e=>e.value===t));l.splice(e,1),a("USER_CONFIG_INFO_PERSIST")}},USER_CONFIG_INFO_PERSIST({state:e}){(e=>{const{selectedDir:a,selectedBranch:t,dirMode:l}=e.userConfigInfo;if("newDir"===l){const t=a.split("");let l=0,i="";const n=[" ",".","、",",","，","!","？","?"];for(let e=0;e<t.length&&(n.some((a=>a===t[e]))&&(t[e]="-"),"/"===t[e]&&(l+=1),!(l>=5));e++)i+=t[e];e.userConfigInfo.selectedDir=i}e.userConfigInfo.selectedBranch=t.replace(/\s+/g,"-")})(e),localStorage.setItem("PICX_CONFIG",JSON.stringify(e.userConfigInfo))},USER_CONFIG_INFO_LOGOUT({state:e}){Ia(e.userConfigInfo)}},getters:{getUserLoginStatus:e=>e.userConfigInfo.logined,getUserConfigInfo:e=>e.userConfigInfo,getUserViewDir:e=>e.userConfigInfo.viewDir}},Xa={state:{imgCardArr:[]},mutations:{IMAGE_CARD(e,{imageObj:a}){const{uuid:t,checked:l}=a;l&&e.imgCardArr.forEach((e=>{e.uuid===t&&(e.checked=!0)}))},REPLACE_IMAGE_CARD(e,{checkedImgArr:a}){a.length>0?e.imgCardArr=a:e.imgCardArr=[]}},actions:{},getters:{getImageCardArr:e=>e.imgCardArr,getImageCardCheckedArr:e=>e.imgCardArr.filter((e=>e.checked))}},Wa={state:{uploadAreaActive:!1},mutations:{CHANGE_UPLOAD_AREA_ACTIVE(e,a){e.uploadAreaActive=a},UPLOAD_AREA_ACTIVE_LOGOUT(e){e.uploadAreaActive=!1}},getters:{getUploadAreaActive:e=>e.uploadAreaActive}},qa={imageName:{autoAddHash:!0,autoTimestampNaming:!1,prefixNaming:{enable:!1,prefix:""}},compress:{enable:!0,encoder:la.webP},theme:{mode:ga.system},elementPlusSize:ca.default,imageLinkType:{selected:"Staticaly",presetList:[{id:wa(),name:"Staticaly",rule:"https://cdn.staticaly.com/gh/{{owner}}/{{repo}}@{{branch}}/{{path}}"},{id:wa(),name:"ChinaJsDelivr",rule:"https://jsd.cdn.zzko.cn/gh/{{owner}}/{{repo}}@{{branch}}/{{path}}"},{id:wa(),name:"jsDelivr",rule:"https://cdn.jsdelivr.net/gh/{{owner}}/{{repo}}@{{branch}}/{{path}}"},{id:wa(),name:"GitHub",rule:"https://github.com/{{owner}}/{{repo}}/raw/{{branch}}/{{path}}"}]},imageLinkFormat:{enable:!1,selected:"Markdown",presetList:[{name:"Markdown",format:"![imageName](imageLink)"},{name:"HTML",format:'<img src="imageLink" alt="imageName" />'},{name:"BBCode",format:"[img]imageLink[/img]"}]},starred:!1,watermark:{enable:!1,text:"PicX",fontSize:50,position:ua.rightBottom,textColor:"#FFFFFF",opacity:.5},language:ha.zhCN},Ka=(e,a,t)=>{const l="add"===a?"添加":"编辑",i=[];if(e.rule.includes("{{owner}}")||i.push("{{owner}}"),e.rule.includes("{{repo}}")||i.push("{{repo}}"),e.rule.includes("{{branch}}")||i.push("{{branch}}"),i.length)if(e.rule.includes("{{path}}")){let e=`图片链接规则缺少 ${i.join("、")}，是否确认${l}？`;"edit"===a&&(e=`注意：当前编辑的图片链接规则缺少 ${i.join("、")}`),p.confirm(e,`${l}提示`,{type:"warning",showClose:"add"===a,showCancelButton:"add"===a}).then((()=>{t(!0)})).catch((()=>{t(!1)}))}else o.error(`${l}失败，图片链接规则必须包含 {{path}}`);else t(!0)},Ja=h({modules:{dirImageListModule:Qe,userConfigInfoModule:Ha,imageCardModule:Xa,uploadAreaActiveModule:Wa,userSettingsModule:{state:{userSettings:(()=>{const e=je("PICX_SETTINGS");return e&&xa(qa,e),qa})()},actions:{SET_USER_SETTINGS({state:e,dispatch:a},t){for(const l in t)e.userSettings.hasOwnProperty(l)&&(e.userSettings[l]=t[l]);a("USER_SETTINGS_PERSIST")},ADD_IMAGE_LINK_TYPE_RULE({state:e,dispatch:a},t){e.userSettings.imageLinkType.presetList.some((e=>e.name===t.name))?o.error("添加失败，该图片链接规则规则已存在"):Ka(t,"add",(l=>{l&&(e.userSettings.imageLinkType.presetList.push(t),a("USER_SETTINGS_PERSIST"))}))},UPDATE_IMAGE_LINK_TYPE_RULE({state:e,dispatch:a},t){Ka(t,"edit",(l=>{if(l){const l=e.userSettings.imageLinkType.presetList.find((e=>e.id===t.id));l&&(l.rule=t.rule,a("USER_SETTINGS_PERSIST"))}}))},DEL_IMAGE_LINK_TYPE_RULE({state:e,dispatch:a},t){const l=e.userSettings.imageLinkType.presetList;l.splice(l.findIndex((e=>e.id===t)),1),a("USER_SETTINGS_PERSIST")},USER_SETTINGS_PERSIST({state:e}){localStorage.setItem("PICX_SETTINGS",JSON.stringify(e.userSettings))},USER_SETTINGS_LOGOUT({state:e}){e.userSettings=qa}},getters:{getUserSettings:e=>e.userSettings}},toolboxImageListModule:{state:{toolboxImageList:[]},mutations:{},actions:{TOOLBOX_IMG_LIST_ADD({state:e},a){e.toolboxImageList.unshift(a)},TOOLBOX_IMG_LIST_REMOVE({state:e},a){if(e.toolboxImageList.length>0){const t=e.toolboxImageList.findIndex((e=>e.uuid===a));-1!==t&&e.toolboxImageList.splice(t,1)}},TOOLBOX_IMG_LIST_RESET({state:e}){e.toolboxImageList=[]}},getters:{getToolboxImageList:e=>e.toolboxImageList}},uploadImageListModule:{state:{uploadImageList:[]},mutations:{},actions:{UPLOAD_IMG_LIST_ADD({state:e},a){e.uploadImageList.unshift(a)},UPLOAD_IMG_LIST_REMOVE({state:e},a){if(e.uploadImageList.length>0){const t=e.uploadImageList.findIndex((e=>e.uuid===a));-1!==t&&0===e.uploadImageList[t].uploadStatus.progress&&e.uploadImageList.splice(t,1)}},UPLOAD_IMG_LIST_RESET({state:e}){e.uploadImageList=[]}},getters:{getUploadImageList:e=>e.uploadImageList}}},state:{rootName:"root"},mutations:{},actions:{LOGOUT({dispatch:e,commit:a}){a("UPLOAD_AREA_ACTIVE_LOGOUT"),e("DIR_IMAGE_LOGOUT"),e("USER_CONFIG_INFO_LOGOUT"),e("USER_SETTINGS_LOGOUT"),e("TOOLBOX_IMG_LIST_RESET"),e("UPLOAD_IMG_LIST_RESET"),localStorage.clear(),sessionStorage.clear()}},getters:{}}),Ya=Symbol("vuex-store");function Qa(){return f(Ya)}const Za=(e,a="")=>{const{owner:t,selectedRepo:l,selectedBranch:i}=e;return new Promise((async e=>{const n=await Ge({url:`/repos/${t}/${l}/contents/${a}`,method:"GET",params:{ref:i}});n&&n.length?e(n.filter((e=>"dir"===e.type)).map((e=>({value:e.name,label:e.name})))):e(null)}))},et=(e,a="")=>{const{owner:t,selectedRepo:l,selectedBranch:i}=e;return new Promise((async e=>{const n=await Ge({url:`/repos/${t}/${l}/contents/${a}`,method:"GET",params:{"no-cache":wa(),ref:i}});n&&n.length?(n.filter((e=>"dir"===e.type)).forEach((e=>Ja.dispatch("DIR_IMAGE_LIST_ADD_DIR",e.path))),setTimeout((()=>{n.filter((e=>"file"===e.type&&Aa(Ra(e.name)))).forEach((e=>{var t,l;Ja.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",(t=e,l=a,{type:"image",uuid:wa(),dir:l,name:t.name,sha:t.sha,path:t.path,deleting:!1,size:t.size,checked:!1}))}))}),120),e(!0)):e(null)}))},at=(e,a,t)=>Ge({url:`/repos/${e}/${a}/branches/${t}`,method:"GET"}),tt=(e,a)=>new Promise((async t=>{const l=await Ge({url:`/repos/${e}/${a}/branches`,method:"GET"});l&&l.length?t(l.filter((e=>!e.protected)).map((e=>({value:e.name,label:e.name}))).reverse()):t(null)})),lt=(e,a,t,l)=>Ge({url:`/repos/${e}/${a}/contents/${t}`,method:"DELETE",data:{owner:e,repo:a,path:t,message:"Delete image via PicX(https://github.com/XPoet/picx)",sha:l}}),it=(e,a,t)=>Ge({url:`/repos/${a}/${t}/git/blobs`,method:"POST",params:{owner:a,repo:t,content:(e.base64.compressBase64||e.base64.watermarkBase64||e.base64.originalBase64).split(",")[1],encoding:"base64"}}),nt=(e,a,t,l)=>{var i,n,s;return Ge({url:`/repos/${e}/${a}/git/trees`,method:"POST",params:{tree:t.map((e=>({path:e.path,mode:"100644",type:"blob",sha:e.sha}))),base_tree:(null==(s=null==(n=null==(i=null==l?void 0:l.commit)?void 0:i.commit)?void 0:n.tree)?void 0:s.sha)||null}})},st=(e,a,t,l)=>Ge({url:`/repos/${e}/${a}/git/commits`,method:"POST",params:{tree:t.sha,parents:[l.commit.sha],message:"Upload images via PicX(https://github.com/XPoet/picx)"}}),ot=(e,a,t,l)=>Ge({url:`/repos/${e}/${a}/git/refs/heads/${t}`,method:"PATCH",params:{sha:l}}),rt=v({__name:"repo-dir-cascader",props:{elKey:{type:String,default:""},elSize:{type:String,default:ca.default},elWidth:{type:String,default:"100%"},elClearable:{type:Boolean,default:!1}},setup(e){const a=Qa(),t=_((()=>a.getters.getUserConfigInfo)).value,l={lazy:!0,checkStrictly:!0,async lazyLoad(e,a){const{level:l,pathLabels:i}=e;let n;n=0===l?t.dirList:await Za(t,i.join("/")),a(n?n.map((e=>({value:e.value,label:e.label,leaf:l>=4}))):[])}},i=e=>{t.selectedDirList=e,t.selectedDir=e.join("/"),a.dispatch("USER_CONFIG_INFO_PERSIST")};return(a,n)=>{const s=b;return y(),w(s,{style:k({width:e.elWidth}),size:e.elSize,debounce:500,props:l,key:e.elKey,modelValue:I(t).selectedDirList,"onUpdate:modelValue":n[0]||(n[0]=e=>I(t).selectedDirList=e),filterable:"",placeholder:a.$t("config.placeholder5"),clearable:e.elClearable,onChange:i},null,8,["style","size","modelValue","placeholder","clearable"])}}}),ct={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},dt=[S("path",{fill:"currentColor",d:"M771.776 794.88A384 384 0 0 1 128 512h64a320 320 0 0 0 555.712 216.448H654.72a32 32 0 1 1 0-64h149.056a32 32 0 0 1 32 32v148.928a32 32 0 1 1-64 0v-50.56zM276.288 295.616h92.992a32 32 0 0 1 0 64H220.16a32 32 0 0 1-32-32V178.56a32 32 0 0 1 64 0v50.56A384 384 0 0 1 896.128 512h-64a320 320 0 0 0-555.776-216.384z"},null,-1)];var ut={name:"ep-refresh",render:function(e,a){return y(),x("svg",ct,dt)}},mt=(e,a)=>{const t=e.__vccOpts||e;for(const[l,i]of a)t[l]=i;return t};var gt=mt(v({__name:"refresh-config",props:{boxWidth:{type:Number,default:20},dataType:{type:String,default:"repo"}},setup(e){const a=e,t=D(),l=Qa(),i=_((()=>l.getters.getUserConfigInfo)).value,n=async()=>{const e=r.service({lock:!0,text:t.proxy.$t("config.loading4",{type:t.proxy.$t(a.dataType)})}),{owner:n,selectedRepo:s}=i;if("repo"===a.dataType){const e=await Xe(n);e&&(i.repoList=e)}else if("branch"===a.dataType){const e=await tt(n,s);e&&(i.branchList=e)}e.close(),await l.dispatch("USER_CONFIG_INFO_PERSIST")};return(a,t)=>{const l=ut,i=L,s=T;return y(),x("div",{class:"refresh-config-box",style:k({width:e.boxWidth+"rem"})},[$(s,{placement:"top",content:a.$t("config.reload",{type:a.$t(e.dataType)})},{default:C((()=>[$(i,{class:"icon",onClick:n},{default:C((()=>[$(l)])),_:1})])),_:1},8,["content"])],4)}}}),[["__scopeId","data-v-45c6dcd0"]]);const pt=_((()=>Ja.getters.getUserConfigInfo)).value,ht=()=>{Ja.dispatch("LOGOUT")},ft=()=>{Ja.dispatch("USER_CONFIG_INFO_PERSIST")};function vt(e){pt.logined=!0,pt.owner=e.login,pt.name=e.name,pt.email=e.email,pt.avatarUrl=e.avatar_url,ft()}const _t=async e=>{const{selectedDir:a,dirMode:t}=pt;let l=e("config.message6");if(""===a){switch(t){case oa.newDir:l=e("config.message7");break;case oa.repoDir:l=e("config.message8",{repo:pt.selectedRepo})}o.warning({message:l})}else await ms.push("/upload")},bt=async e=>{const{token:a}=pt;if(!a)return void o.error({message:e("config.message1")});const t=r.service({lock:!0,text:e("config.loading6")});try{const a=await Fe(pt.token);if(!a)return t.close(),void o.error({message:e("config.message2")});vt(a);const l=await(e=>Ge({url:"/user/repos",method:"POST",params:{name:"picx-images-hosting",description:"PicX images hosting repository",private:!1},headers:{Authorization:`token ${e}`},success422:!0}))(pt.token);if(!l)return t.close(),void o.error({message:e("config.message3")});pt.repoList=[{value:"picx-images-hosting",label:"picx-images-hosting"}],pt.selectedRepo="picx-images-hosting",pt.branchList=[{value:"master",label:"master"}],pt.selectedBranch="master",pt.branchMode=na.repoBranch,pt.selectedDir=Sa("yyyyMMdd"),pt.dirMode=oa.autoDir,pt.dirList=[],ft(),await We(pt,!1),t.close(),o.success({message:e("config.message4")}),await ms.push("/upload")}catch(l){o.error({message:e("config.message5")}),console.error("oneClickAutoConfig >> ",l)}},yt=e=>e.language===ha.en?"100rem":"70rem",wt=e=>e.elementPlusSize===ca.large?"right":"top";const kt={class:"page-container config-page-container"};var It=mt(v({__name:"my-config",setup(e){const a=Qa(),t=D(),l=E(!1),i=E(!1),n=E(!1),s=E(32),c=_((()=>a.getters.getUserConfigInfo)).value,d=_((()=>a.getters.getUserLoginStatus)).value,u=_((()=>a.getters.getUserSettings)).value,m=_((()=>!c.token||!c.owner)),g=_((()=>l.value||i.value||n.value)),p=E(null),h=E(null),f=E(""),v=E("repoDirCascaderKey"),b=E(null),S=e=>{var a;switch(e){case oa.rootDir:c.selectedDir="/";break;case oa.autoDir:c.selectedDir=Sa("yyyyMMdd");break;case oa.newDir:c.selectedDir="xxx",null==(a=p.value)||a.focus();break;case oa.repoDir:c.dirList.length||(c.selectedDir="",c.selectedDirList=[]);break;default:c.selectedDir="/"}ft()};async function L(){i.value=!0;const e=await Za(c);i.value=!1,e&&(c.dirList=e),ft()}async function J(){var e,a;if(!c.token)return void o.error({message:null==(e=null==t?void 0:t.proxy)?void 0:e.$t("config.message1")});m.value||(pt.selectedRepo="",pt.repoList=[],pt.selectedBranch="",pt.branchMode=na.repoBranch,pt.branchList=[],pt.selectedDir="",pt.dirMode=oa.repoDir,pt.dirList=[]),l.value=!0;const i=await Fe(c.token);i?(vt(i),await async function(e){var a;const i=await Xe(e);l.value=!1,i?(c.repoList=i,ft()):o.error({message:null==(a=null==t?void 0:t.proxy)?void 0:a.$t("config.message9")})}(i.login)):o.error({message:null==(a=null==t?void 0:t.proxy)?void 0:a.$t("config.message11")})}function Y(e){c.branchList=[],c.dirList=[],a.dispatch("DIR_IMAGE_LOGOUT"),async function(e){var a;n.value=!0;const{owner:l,dirMode:i}=c,s=await tt(l,e);n.value=!1,s?(s.length>0?(c.branchList=s,c.selectedBranch=c.branchList[0].value,c.branchMode=na.repoBranch,await L()):(c.selectedBranch="master",c.branchMode=na.newBranch,await We(c)),S(i),ft()):o.error({message:null==(a=null==t?void 0:t.proxy)?void 0:a.$t("config.message10")})}(e),ft()}async function Q(e){c.selectedBranch=e,await L(),v.value=c.selectedBranch,c.selectedDir=c.dirList[0].value,c.selectedDirList=[c.selectedDir],ft()}const Z=()=>{var e,a;const l=f.value,i=c.branchList;l?i.find((e=>e.value===l))?o.error({message:null==(e=null==t?void 0:t.proxy)?void 0:e.$t("config.message13",{branch:l})}):(async(e,a,t)=>{const{owner:l,selectedRepo:i,branchList:n}=e,s=r.service({text:`正在新建 ${a} 分支...`});try{let e="";const r=await Ge({url:`/repos/${l}/${i}/git/refs/heads/${n[0].value}`,method:"GET"});if(r&&(e=r.object.sha),!e)return s.close(),void o.error("新建分支失败");let c="";const d=await Ge({url:`/repos/${l}/${i}/git/refs`,method:"POST",params:{ref:`refs/heads/${a}`,sha:e}});if(d&&(c=d.object.sha),!c)return s.close(),void o.error("新建分支失败");await Ge({url:`/repos/${l}/${i}/git/refs/heads/${a}`,method:"PATCH",params:{force:!0,sha:c}})&&t()}catch(c){console.error(c)}})(c,l,(()=>{var e;o.error({message:null==(e=null==t?void 0:t.proxy)?void 0:e.$t("config.message14",{branch:l})}),c.branchList.push({value:l,label:l})})):o.error({message:null==(a=null==t?void 0:t.proxy)?void 0:a.$t("config.message12")})};return O((()=>d),(e=>{e||(l.value=!1,i.value=!1,n.value=!1)})),R((()=>{c.token||setTimeout((()=>{b.value.focus()}),100)})),(e,a)=>{const t=A,o=N,r=M,d=T,_=U,L=z,D=P,E=gt,O=j,R=B,ee=rt,ae=V;return y(),x("div",kt,[$(_,{"label-width":I(yt)(I(u)),"label-position":I(wt)(I(u))},{default:C((()=>[$(o,{label:"Token"},{default:C((()=>[$(t,{ref_key:"tokenInputRef",ref:b,modelValue:I(c).token,"onUpdate:modelValue":a[0]||(a[0]=e=>I(c).token=e),clearable:"",autofocus:!I(c).token,type:"password","show-password":"",placeholder:e.$t("config.inputToken")},null,8,["modelValue","autofocus","placeholder"])])),_:1}),$(o,{class:"operation"},{default:C((()=>[$(d,{placement:"top",content:e.$t("config.manualConfiguration3")},{default:C((()=>[$(r,{disabled:g.value,plain:"",type:"primary","native-type":"submit",onClick:a[1]||(a[1]=H((e=>J()),["prevent"]))},{default:C((()=>[X(W(m.value?e.$t("config.manualConfiguration1"):e.$t("config.manualConfiguration2")),1)])),_:1},8,["disabled"])])),_:1},8,["content"]),$(d,{placement:"top",content:e.$t("config.autoConfiguration3")},{default:C((()=>[$(r,{plain:"",disabled:g.value,type:"primary",onClick:a[2]||(a[2]=H((a=>I(bt)(e.$t)),["prevent"]))},{default:C((()=>[X(W(m.value?e.$t("config.autoConfiguration1"):e.$t("config.autoConfiguration2")),1)])),_:1},8,["disabled"])])),_:1},8,["content"])])),_:1})])),_:1},8,["label-width","label-position"]),I(c).token&&I(c).owner?G((y(),w(_,{key:0,"label-width":I(yt)(I(u)),"label-position":I(wt)(I(u)),"element-loading-text":e.$t("config.loading1")},{default:C((()=>[I(c).owner?(y(),w(o,{key:0,label:e.$t("config.username")},{default:C((()=>[$(t,{modelValue:I(c).owner,"onUpdate:modelValue":a[3]||(a[3]=e=>I(c).owner=e),readonly:""},null,8,["modelValue"])])),_:1},8,["label"])):F("",!0),I(c).email?(y(),w(o,{key:1,label:e.$t("config.email")},{default:C((()=>[$(t,{modelValue:I(c).email,"onUpdate:modelValue":a[4]||(a[4]=e=>I(c).email=e),readonly:""},null,8,["modelValue"])])),_:1},8,["label"])):F("",!0),I(c).repoList.length?(y(),w(o,{key:2,label:e.$t("config.selectRepo")},{default:C((()=>[$(D,{modelValue:I(c).selectedRepo,"onUpdate:modelValue":a[5]||(a[5]=e=>I(c).selectedRepo=e),filterable:!0,style:k({width:"calc(100% - "+s.value+"rem)"}),placeholder:e.$t("config.placeholder1"),onChange:Y},{default:C((()=>[(y(!0),x(q,null,K(I(c).repoList,((e,a)=>(y(),w(L,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","style","placeholder"]),$(E,{"box-width":s.value,"data-type":"repo"},null,8,["box-width"])])),_:1},8,["label"])):F("",!0)])),_:1},8,["label-width","label-position","element-loading-text"])),[[ae,l.value]]):F("",!0),I(c).token&&I(c).selectedRepo&&I(c).branchList.length?G((y(),w(_,{key:1,"label-width":I(yt)(I(u)),"label-position":I(wt)(I(u)),"element-loading-text":e.$t("config.loading2")},{default:C((()=>[(I(c).selectedRepo,F("",!0)),I(c).branchList.length&&I(c).branchMode===I(na).repoBranch?(y(),w(o,{key:1,label:e.$t("config.selectBranch")},{default:C((()=>[$(D,{modelValue:I(c).selectedBranch,"onUpdate:modelValue":a[7]||(a[7]=e=>I(c).selectedBranch=e),filterable:!0,style:k({width:"calc(100% - "+s.value+"rem)"}),placeholder:e.$t("config.placeholder2"),onChange:Q},{default:C((()=>[(y(!0),x(q,null,K(I(c).branchList,((e,a)=>(y(),w(L,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","style","placeholder"]),$(E,{"box-width":s.value,"data-type":"branch"},null,8,["box-width"])])),_:1},8,["label"])):F("",!0),I(c).branchMode===I(na).newBranch?(y(),w(o,{key:2,label:e.$t("config.createBranch")},{default:C((()=>[$(t,{modelValue:f.value,"onUpdate:modelValue":a[8]||(a[8]=e=>f.value=e),onBlur:Z,clearable:"",placeholder:e.$t("config.placeholder3"),ref_key:"newBranchInputRef",ref:h},null,8,["modelValue","placeholder"])])),_:1},8,["label"])):F("",!0)])),_:1},8,["label-width","label-position","element-loading-text"])),[[ae,n.value]]):F("",!0),I(c).token&&I(c).selectedBranch?G((y(),w(_,{key:2,"label-width":I(yt)(I(u)),"label-position":I(wt)(I(u)),"element-loading-text":e.$t("config.loading5")},{default:C((()=>[I(c).selectedBranch?(y(),w(o,{key:0,label:e.$t("config.dirMode")},{default:C((()=>[$(R,{modelValue:I(c).dirMode,"onUpdate:modelValue":a[9]||(a[9]=e=>I(c).dirMode=e),onChange:S},{default:C((()=>[$(d,{content:e.$t("config.inputNewDir"),placement:"top",offset:-1},{default:C((()=>[$(O,{label:"newDir"},{default:C((()=>[X(W(e.$t("config.createNewDir")),1)])),_:1})])),_:1},8,["content"]),$(d,{content:e.$t("config.rootDir2",{branch:I(c).selectedBranch}),placement:"top",offset:-1},{default:C((()=>[$(O,{label:"rootDir"},{default:C((()=>[X(W(e.$t("config.rootDir")),1)])),_:1})])),_:1},8,["content"]),$(d,{content:e.$t("config.autoDir2"),placement:"top",offset:-1},{default:C((()=>[$(O,{label:"autoDir"},{default:C((()=>[X(W(e.$t("config.autoDir")),1)])),_:1})])),_:1},8,["content"]),I(c).dirList.length&&"newBranch"!==I(c).branchMode?(y(),w(d,{key:0,content:e.$t("config.repoDir2",{branch:I(c).selectedBranch}),placement:"top",offset:-1},{default:C((()=>[$(O,{label:"repoDir"},{default:C((()=>[X(W(e.$t("config.repoDir",{repo:I(c).selectedRepo})),1)])),_:1})])),_:1},8,["content"])):F("",!0)])),_:1},8,["modelValue"])])),_:1},8,["label"])):F("",!0),"autoDir"===I(c).dirMode?(y(),w(o,{key:1,label:e.$t("config.autoDir")},{default:C((()=>[$(t,{modelValue:I(c).selectedDir,"onUpdate:modelValue":a[10]||(a[10]=e=>I(c).selectedDir=e),readonly:""},null,8,["modelValue"])])),_:1},8,["label"])):F("",!0),"rootDir"===I(c).dirMode?(y(),w(o,{key:2,label:e.$t("config.rootDir")},{default:C((()=>[$(t,{modelValue:I(c).selectedDir,"onUpdate:modelValue":a[11]||(a[11]=e=>I(c).selectedDir=e),readonly:""},null,8,["modelValue"])])),_:1},8,["label"])):F("",!0),"newDir"===I(c).dirMode?(y(),w(o,{key:3,label:e.$t("config.createNewDir")},{default:C((()=>[$(t,{ref_key:"newDirInputRef",ref:p,modelValue:I(c).selectedDir,"onUpdate:modelValue":a[12]||(a[12]=e=>I(c).selectedDir=e),onInput:a[13]||(a[13]=e=>I(ft)()),clearable:"",placeholder:e.$t("config.placeholder4")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])):F("",!0),I(c).dirList.length&&"repoDir"===I(c).dirMode&&"newBranch"!==I(c).branchMode?(y(),w(o,{key:4,label:e.$t("config.selectDir")},{default:C((()=>[$(ee,{"el-key":v.value,"el-size":I(u).elementPlusSize},null,8,["el-key","el-size"])])),_:1},8,["label"])):F("",!0)])),_:1},8,["label-width","label-position","element-loading-text"])),[[ae,i.value]]):F("",!0),I(c).token?(y(),w(_,{key:3,"label-width":I(yt)(I(u)),"label-position":I(wt)(I(u))},{default:C((()=>[$(o,{class:"operation"},{default:C((()=>[I(c).owner?(y(),w(r,{key:0,plain:"",disabled:g.value,type:"warning",onClick:a[14]||(a[14]=e=>I(ht)())},{default:C((()=>[X(W(e.$t("reset")),1)])),_:1},8,["disabled"])):F("",!0),I(c).selectedRepo?(y(),w(r,{key:1,plain:"",disabled:g.value,type:"success",onClick:a[15]||(a[15]=a=>I(_t)(e.$t))},{default:C((()=>[X(W(e.$t("confirm")),1)])),_:1},8,["disabled"])):F("",!0)])),_:1})])),_:1},8,["label-width","label-position"])):F("",!0)])}}}),[["__scopeId","data-v-6ff20fd0"]]);const xt={key:0,class:"selected-info-bar-box"},St={class:"info-item repo"},Lt={key:0,class:"info-item branch"},Tt={class:"info-item dir"};var $t=mt(v({__name:"selected-info-bar",props:{barType:{type:String,default:"upload"}},setup(e){const a=Qa(),t=_((()=>a.getters.getUserConfigInfo)),l=_((()=>a.getters.getUserSettings));return(a,i)=>{const n=J,s=rt;return t.value.selectedRepo?(y(),x("div",xt,[S("span",St,[X(W(a.$t("repo"))+"： ",1),$(n,{"disable-transitions":""},{default:C((()=>[X(W(t.value.selectedRepo),1)])),_:1})]),t.value.selectedBranch?(y(),x("span",Lt,[X(W(a.$t("branch"))+"： ",1),$(n,{"disable-transitions":""},{default:C((()=>[X(W(t.value.selectedBranch),1)])),_:1})])):F("",!0),S("span",Tt,[X(W(a.$t("dir"))+"： ",1),t.value.dirMode!==I(oa).repoDir||"management"===e.barType?(y(),w(n,{key:0,"disable-transitions":""},{default:C((()=>[X(W("management"===e.barType?t.value.viewDir:t.value.selectedDir),1)])),_:1})):F("",!0),t.value.dirMode===I(oa).repoDir&&"upload"===e.barType?(y(),w(s,{key:1,"el-size":l.value.elementPlusSize===I(ca).large?I(ca).default:l.value.elementPlusSize,"el-width":"","el-clearable":!1},null,8,["el-size"])):F("",!0)])])):F("",!0)}}}),[["__scopeId","data-v-02ac177a"]]);const Ct={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Dt=[S("path",{fill:"currentColor",d:"M544 864V672h128L512 480L352 672h128v192H320v-1.6c-5.376.32-10.496 1.6-16 1.6A240 240 0 0 1 64 624c0-123.136 93.12-223.488 212.608-237.248A239.808 239.808 0 0 1 512 192a239.872 239.872 0 0 1 235.456 194.752c119.488 13.76 212.48 114.112 212.48 237.248a240 240 0 0 1-240 240c-5.376 0-10.56-1.28-16-1.6v1.6H544z"},null,-1)];var Et={name:"ep-upload-filled",render:function(e,a){return y(),x("svg",Ct,Dt)}};const Ot=["onDrop","onPaste"],Rt=(e=>(Z("data-v-7144607c"),e=e(),ee(),e))((()=>S("label",{for:"input-file-selector"},null,-1))),At={key:0,class:"upload-area-tips"},Nt={class:"text"},Mt=["src"];var Ut=mt(v({__name:"getting-images",props:{disabled:{type:Boolean,default:!1}},emits:["getImgList"],setup(e,{expose:a,emit:t}){const l=Qa(),i=_((()=>l.getters.getUploadAreaActive)),n=E({uuid:"",base64:""}),s=E([]),o=()=>{const e=s.value.length,a=e>0?s.value[e-1]:{uuid:"",base64:""};n.value={uuid:a.uuid,base64:a.base64}},r=async e=>{if(e.length){s.value=[];for(const a of e){const e=await Ma(a);e&&s.value.push(e)}o(),l.commit("CHANGE_UPLOAD_AREA_ACTIVE",!0),t("getImgList",s.value)}},c=async e=>{const a=e.target;await r(a.files),a.value="",a.value=a.defaultValue},d=async e=>{await r(e.dataTransfer.files)},u=async e=>{const a=Array.from(e.clipboardData.items).filter((e=>"file"===e.kind&&Aa(e.type))).map((e=>e.getAsFile()));await r(a)};return R((()=>{window.addEventListener("paste",u)})),Y((()=>{window.removeEventListener("paste",u)})),a({reset:()=>{s.value=[],n.value.uuid="",n.value.base64=""},remove:e=>{const a=s.value.findIndex((a=>a.uuid===e));-1!==a&&s.value.splice(a,1),e===n.value.uuid&&o()}}),(a,t)=>{const l=Et,s=L;return y(),x("div",{class:Q(["getting-images-container",{focus:i.value&&n.value.base64,disabled:e.disabled}]),onDragover:t[0]||(t[0]=H((()=>{}),["prevent"])),onDrop:H(d,["stop","prevent"]),onPaste:H(u,["stop"])},[Rt,S("input",{id:"input-file-selector",type:"file",accept:"image/*",onChange:c,multiple:"multiple"},null,32),n.value.base64?F("",!0):(y(),x("div",At,[$(s,{class:"icon"},{default:C((()=>[$(l)])),_:1}),S("div",Nt,W(a.$t("upload.uploadAreaTips")),1)])),n.value.base64?(y(),x("img",{key:1,class:"preview-img",src:n.value.base64},null,8,Mt)):F("",!0)],42,Ot)}}}),[["__scopeId","data-v-7144607c"]]);const zt=_((()=>Ja.getters.getUserSettings)).value,Pt=async e=>{const{starred:a}=e;if(!a){await((e="XPoet/picx")=>Ge({url:`/user/starred/${e}`,method:"PUT",data:{},noShowErrorMsg:!0}))()&&await Ja.dispatch("SET_USER_SETTINGS",{starred:!0})}},jt=(e,a,t)=>{var l;let i=t.selectedDir;(null==(l=null==a?void 0:a.reUploadInfo)?void 0:l.isReUpload)&&(i=a.reUploadInfo.dir),a.uploadStatus.progress=100,a.uploadStatus.uploading=!1;const n={checked:!1,type:"image",uuid:a.uuid,dir:i,name:e.name,sha:e.sha,path:e.path,deleting:!1,size:e.size};a.uploadedImg=n,Ja.dispatch("DIR_IMAGE_LIST_ADD_DIR",i),Ja.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",n)};function Bt(e,a){const{selectedBranch:t,email:l,owner:i}=e,n={message:"Upload image via PicX(https://github.com/XPoet/picx)",branch:t,content:(a.base64.compressBase64||a.base64.watermarkBase64||a.base64.originalBase64).split(",")[1]};return l&&(n.committer={name:i,email:l}),a.uploadStatus.uploading=!0,new Promise((async t=>{const l=await((e,a)=>Ge({url:e,method:"PUT",data:a}))(((e,a)=>{var t;const{owner:l,selectedRepo:i,selectedDir:n}=e,s=a.filename.final;let o=s;return"/"!==n&&(o=`${n}/${s}`),(null==(t=null==a?void 0:a.reUploadInfo)?void 0:t.isReUpload)&&(o=a.reUploadInfo.path),`/repos/${l}/${i}/contents/${o}`})(e,a),n);if(a.uploadStatus.uploading=!1,l){const{name:i,sha:n,path:s,size:o}=l.content;jt({name:i,sha:n,path:s,size:o},a,e),t(!0)}else t(!1)}))}const Vt={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Gt=[S("path",{fill:"currentColor",d:"M406.656 706.944L195.84 496.256a32 32 0 1 0-45.248 45.248l256 256l512-512a32 32 0 0 0-45.248-45.248L406.592 706.944z"},null,-1)];var Ft={name:"ep-check",render:function(e,a){return y(),x("svg",Vt,Gt)}};const Ht={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Xt=[S("path",{fill:"currentColor",d:"M160 832h704a32 32 0 1 1 0 64H160a32 32 0 1 1 0-64zm384-578.304V704h-64V247.296L237.248 490.048L192 444.8L508.8 128l316.8 316.8l-45.312 45.248L544 253.696z"},null,-1)];var Wt={name:"ep-upload",render:function(e,a){return y(),x("svg",Ht,Xt)}};const qt={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Kt=[S("path",{fill:"currentColor",d:"M352 480h320a32 32 0 1 1 0 64H352a32 32 0 0 1 0-64z"},null,-1),S("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768a384 384 0 0 0 0 768zm0 64a448 448 0 1 1 0-896a448 448 0 0 1 0 896z"},null,-1)];var Jt={name:"ep-remove",render:function(e,a){return y(),x("svg",qt,Kt)}};const Yt={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Qt=[S("path",{fill:"currentColor",d:"M672 192L288 511.936L672 832z"},null,-1)];var Zt={name:"ep-caret-left",render:function(e,a){return y(),x("svg",Yt,Qt)}};const el={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},al=[S("path",{fill:"currentColor",d:"m192 384l320 384l320-384z"},null,-1)];var tl={name:"ep-caret-bottom",render:function(e,a){return y(),x("svg",el,al)}};const ll=(e,a)=>{a.filename.isPrefixNaming=e,a.filename.name=e?`${a.filename.prefixName}${a.filename.initName}`:`${a.filename.initName}`,a.filename.isAddHash?a.filename.final=`${a.filename.name}.${a.filename.hash}.${a.filename.suffix}`:a.filename.final=`${a.filename.name}.${a.filename.suffix}`},il=(e,a)=>{a.filename.isAddHash=e,a.filename.final=e?`${a.filename.name}.${a.filename.hash}.${a.filename.suffix}`:`${a.filename.name}.${a.filename.suffix}`};const nl=["element-loading-text"],sl={class:"before-upload-handle-container"},ol={class:"img-name text-ellipsis"},rl={class:"operate-item"},cl={class:"operate-item"},dl={class:"operate-item"},ul={key:0,class:"operate-item"},ml={key:1,class:"img-info-box"},gl={class:"file-size-box"},pl={key:0,class:"finial-file-size file-size-item"},hl={class:"last-modified"};var fl=mt(v({__name:"upload-image-card",props:{imgObj:{type:Object,require:!0,default:()=>({})}},emits:["remove"],setup(e,{emit:a}){const t=e,l=Qa(),i=D(),n=E(null),s=_((()=>l.getters.getUserSettings)).value,o=_((()=>l.getters.getUserConfigInfo)).value,r=E(""),c=ae({isHash:!1,isPrefixNaming:!1,isTimestampNaming:!1,isRename:!1,newName:""}),d=E(!0),u=()=>{var e,a;t.imgObj.filename.newName=c.newName,setTimeout((()=>{var e;null==(e=n.value)||e.focus()}),100),e=c.isRename,(a=t.imgObj).filename.isRename=e,e?a.filename.name=a.filename.newName.trim().replace(/\s+/g,"-"):ll(a.filename.isPrefixNaming,a),a.filename.isAddHash?a.filename.final=`${a.filename.name}.${a.filename.hash}.${a.filename.suffix}`:a.filename.final=`${a.filename.name}.${a.filename.suffix}`},m=e=>{const{suffix:a,isPrefixNaming:l,isAddHash:i}=t.imgObj.filename;e?(c.isHash=!1,c.isPrefixNaming=!1,t.imgObj.filename.final=`${Date.now()}.${a}`):(ll(l,t.imgObj),il(i,t.imgObj),c.isHash=i,c.isPrefixNaming=l)};return O((()=>t.imgObj.uploadStatus),(e=>{e.uploading&&(r.value=i.proxy.$t("upload.loading1"))}),{deep:!0,immediate:!0}),R((async()=>{await(async(e,a)=>{const{watermark:t,compress:l}=a;let i=e.fileInfo.originalFile;var n;t.enable&&t.text&&!e.fileInfo.watermarkFile&&(e.beforeUploadStatus.watermarking=!0,e.fileInfo.watermarkFile=(n=e.fileInfo.originalFile.type,/(png|jpg|jpeg|webp|avif)$/.test(n)?await Ta(e.fileInfo.originalFile,t):e.fileInfo.originalFile),i=e.fileInfo.watermarkFile,e.base64.watermarkBase64=await Da(i),e.beforeUploadStatus.watermarking=!1),l.enable&&!e.fileInfo.compressFile&&(e.beforeUploadStatus.compressing=!0,e.fileInfo.compressFile=await Ua(i,l.encoder),i=e.fileInfo.compressFile,e.base64.compressBase64=await Da(i),e.filename.suffix=Ra(i.name),e.beforeUploadStatus.compressing=!1)})(t.imgObj,s),(()=>{const{imageName:e}=s;0===t.imgObj.uploadStatus.progress&&(t.imgObj.filename.isTimestampNaming=e.autoTimestampNaming,t.imgObj.filename.isTimestampNaming?(t.imgObj.filename.isAddHash=!1,t.imgObj.filename.isPrefixNaming=!1,m(!0)):(t.imgObj.filename.isAddHash=e.autoAddHash,t.imgObj.filename.isPrefixNaming=e.prefixNaming.enable,t.imgObj.filename.prefixName=e.prefixNaming.prefix,ll(e.prefixNaming.enable,t.imgObj),il(e.autoAddHash,t.imgObj)),c.isTimestampNaming=t.imgObj.filename.isTimestampNaming,c.isHash=t.imgObj.filename.isAddHash,c.isPrefixNaming=t.imgObj.filename.isPrefixNaming,c.isRename=t.imgObj.filename.isRename,c.newName=t.imgObj.filename.newName)})()})),(l,i)=>{var g,p,h,f,v,_,b,k;const D=te,E=tl,O=Zt,R=L,N=T,M=le,U=A,z=Jt,P=Wt,j=Ft,B=V;return y(),x("div",{class:Q(["upload-image-card-container",{"wait-upload":!e.imgObj.uploadStatus.uploading&&0===e.imgObj.uploadStatus.progress,uploading:e.imgObj.uploadStatus.uploading&&100!==e.imgObj.uploadStatus.progress,uploaded:!e.imgObj.uploadStatus.uploading&&100===e.imgObj.uploadStatus.progress}])},[G((y(),x("div",{class:"img-show-container","element-loading-text":r.value},[$(D,{src:e.imgObj.base64.compressBase64||e.imgObj.base64.watermarkBase64||e.imgObj.base64.originalBase64,fit:"cover",loading:"lazy","hide-on-click-modal":!0,"preview-src-list":[e.imgObj.base64.compressBase64||e.imgObj.base64.watermarkBase64||e.imgObj.base64.originalBase64]},null,8,["src","preview-src-list"])],8,nl)),[[B,e.imgObj.uploadStatus.uploading||e.imgObj.beforeUploadStatus.compressing||e.imgObj.beforeUploadStatus.watermarking]]),S("div",sl,[S("div",{class:Q(["img-name-box",{"no-border":100===e.imgObj.uploadStatus.progress}])},[S("span",ol,W(e.imgObj.filename.final||e.imgObj.filename.name),1),0===e.imgObj.uploadStatus.progress?(y(),w(N,{key:0,placement:"top",offset:8,content:d.value?l.$t("upload.expand"):l.$t("upload.fold")},{default:C((()=>[$(R,{class:"fold-btn",onClick:i[0]||(i[0]=e=>d.value=!d.value)},{default:C((()=>[d.value?F("",!0):(y(),w(E,{key:0})),d.value?(y(),w(O,{key:1})):F("",!0)])),_:1})])),_:1},8,["content"])):F("",!0)],2),0===e.imgObj.uploadStatus.progress?(y(),x("div",{key:0,class:Q(["img-name-operate-box",{folded:d.value}])},[S("div",rl,[$(M,{label:l.$t("upload.hash"),modelValue:c.isHash,"onUpdate:modelValue":i[1]||(i[1]=e=>c.isHash=e),onChange:i[2]||(i[2]=e=>{return a=e,c.isTimestampNaming=!1,void il(a,t.imgObj);var a})},null,8,["label","modelValue"])]),S("div",cl,[$(M,{label:l.$t("upload.rename"),modelValue:c.isRename,"onUpdate:modelValue":i[3]||(i[3]=e=>c.isRename=e),onChange:u},null,8,["label","modelValue"]),e.imgObj.filename.isRename?(y(),w(U,{key:0,class:"rename-input",size:"small",modelValue:c.newName,"onUpdate:modelValue":i[4]||(i[4]=e=>c.newName=e),onInput:u,maxlength:I(18),ref_key:"renameInputRef",ref:n,clearable:""},null,8,["modelValue","maxlength"])):F("",!0)]),S("div",dl,[$(M,{label:l.$t("upload.timestamp-naming"),modelValue:c.isTimestampNaming,"onUpdate:modelValue":i[5]||(i[5]=e=>c.isTimestampNaming=e),onChange:m},null,8,["label","modelValue"])]),!e.imgObj.filename.isRename&&I(s).imageName.prefixNaming.enable&&I(s).imageName.prefixNaming.prefix?(y(),x("div",ul,[$(M,{label:l.$t("upload.prefixNaming"),modelValue:c.isPrefixNaming,"onUpdate:modelValue":i[6]||(i[6]=e=>c.isPrefixNaming=e),onChange:i[7]||(i[7]=e=>{return a=e,c.isTimestampNaming=!1,void ll(a,t.imgObj);var a})},null,8,["label","modelValue"])])):F("",!0)],2)):F("",!0),0===e.imgObj.uploadStatus.progress?(y(),x("div",ml,[S("div",gl,[S("span",{class:Q(["original-file-size file-size-item",{"del-line":null==(p=null==(g=e.imgObj.fileInfo)?void 0:g.compressFile)?void 0:p.size}])},W(I(Na)(null==(h=e.imgObj.fileInfo.originalFile)?void 0:h.size))+" KB ",3),(null==(v=null==(f=e.imgObj.fileInfo)?void 0:f.compressFile)?void 0:v.size)?(y(),x("span",pl,W(I(Na)(null==(b=null==(_=e.imgObj.fileInfo)?void 0:_.compressFile)?void 0:b.size))+" KB ",1)):F("",!0)]),S("span",hl,W(I(Sa)("yyyy-MM-dd hh:mm",null==(k=e.imgObj.fileInfo.originalFile)?void 0:k.lastModified)),1)])):F("",!0)]),100===e.imgObj.uploadStatus.progress?(y(),x("div",{key:0,class:"after-upload-handle-container flex-center",onClick:i[8]||(i[8]=a=>I(Ba)(e.imgObj.uploadedImg,I(o),I(s)))},W(l.$t("upload.copyLink")),1)):F("",!0),0===e.imgObj.uploadStatus.progress?(y(),w(N,{key:1,placement:"top",offset:8,content:l.$t("upload.delete")},{default:C((()=>[$(R,{class:"del-img-btn",onClick:i[9]||(i[9]=t=>{return l=e.imgObj.uuid,void a("remove",l);var l})},{default:C((()=>[$(z)])),_:1})])),_:1},8,["content"])):F("",!0),S("div",{class:Q(["upload-status-box",{"wait-upload":!e.imgObj.uploadStatus.uploading&&0===e.imgObj.uploadStatus.progress,uploaded:!e.imgObj.uploadStatus.uploading&&100===e.imgObj.uploadStatus.progress}])},[$(R,null,{default:C((()=>[e.imgObj.uploadStatus.uploading||0!==e.imgObj.uploadStatus.progress?F("",!0):(y(),w(P,{key:0})),e.imgObj.uploadStatus.uploading||100!==e.imgObj.uploadStatus.progress?F("",!0):(y(),w(j,{key:1}))])),_:1})],2)],2)}}}),[["__scopeId","data-v-5045012e"]]);const vl={class:"upload-page-container"},_l={key:0,class:"upload-page-left page-container",style:{width:"300rem"}},bl={class:"row-item"},yl={class:"content-box"},wl={class:"row-item"},kl={class:"content-box upload-area-status"},Il={key:0},xl={key:0,class:"row-item"},Sl={class:"content-box",style:{"text-align":"right"}},Ll={class:"shortcut-key"},Tl={class:"shortcut-key"},$l=v({__name:"upload-image",setup(e){const a=Qa(),t=ie(),l=D(),i=E(null),s=_((()=>a.getters.getUserConfigInfo)).value,r=_((()=>a.getters.getUserSettings)).value,c=_((()=>a.getters.getUserLoginStatus)),d=E([]),u=E(!1),m=_((()=>"mac"===Ga()?"Command":"Ctrl")),g=e=>{e.forEach((e=>{a.dispatch("UPLOAD_IMG_LIST_ADD",(e=>{const a={uuid:"",base64:{originalBase64:"",watermarkBase64:null,compressBase64:null},fileInfo:{originalFile:null,watermarkFile:null,compressFile:null},filename:{hash:"",suffix:"",name:"",prefixName:"",final:"",initName:"",newName:"",isAddHash:!0,isRename:!1,isPrefixNaming:!1,isTimestampNaming:!1},beforeUploadStatus:{watermarking:!1,compressing:!1},uploadStatus:{progress:0,uploading:!1},reUploadInfo:{dir:"",path:"",isReUpload:!1}};a.uuid=e.uuid,a.base64.originalBase64=e.base64,a.fileInfo.originalFile=e.file;const{imageName:t}=zt,l=e.uuid,i=e.file.name.trim().replaceAll(" ","-"),n=i.lastIndexOf("."),s=i.slice(0,n),o=i.slice(n+1);return a.filename.initName=s,a.filename.name=t.prefixNaming.enable?`${t.prefixNaming.prefix}${s}`:s,a.filename.prefixName=t.prefixNaming.prefix,a.filename.hash=l,a.filename.suffix=o,a.filename.final=t.autoAddHash?`${a.filename.name}.${l}.${o}`:`${a.filename.name}.${o}`,a.filename.isAddHash=t.autoAddHash,a.filename.isPrefixNaming=t.prefixNaming.enable,a.filename.isTimestampNaming=t.autoTimestampNaming,a})(e))}))},p=()=>{var e;null==(e=i.value)||e.reset()},h=async e=>1===e.length?await Bt(s,e[0])?Ze.uploaded:Ze.uploadFail:e.length>1?await async function(e,a){const{selectedBranch:t,selectedRepo:l,selectedDir:i,owner:s}=e,r=[];for(const g of a){g.uploadStatus.uploading=!0;const e=await it(g,s,l);e?r.push(n({img:g},e)):(g.uploadStatus.uploading=!1,o.error(`${g.filename.final} 上传失败`))}const c=await at(s,l,t);if(!c)return Promise.resolve(!1);const d="/"===i?"":`${i}/`,u=await nt(s,l,r.map((e=>({sha:e.sha,path:`${d}${e.img.filename.final}`}))),c);if(!u)return Promise.resolve(!1);const m=await st(s,l,u,c);return m&&await ot(s,l,t,m.sha)?(r.forEach((a=>{const t=a.img.filename.final;jt({name:t,sha:a.sha,path:`${d}${t}`,size:0},a.img,e)})),Promise.resolve(!0)):Promise.resolve(!1)}(s,e)?Ze.allUploaded:Ze.uploadFail:void 0,f=async(e,t=!1)=>{p(),t?Va(e,s,r,!0):Ba(e[0],s,r,!0),await a.dispatch("SET_USER_CONFIG_INFO",{viewDir:s.selectedDir}),await Pt(r)},v=async()=>{var e,a,i,n,r,c,m;const{token:g,selectedRepo:p,selectedDir:v}=s;if(!g)return o.error({message:null==(e=null==l?void 0:l.proxy)?void 0:e.$t("upload.message1")}),void(await t.push("/config"));if(!p)return o.error({message:null==(a=null==l?void 0:l.proxy)?void 0:a.$t("upload.message2")}),void(await t.push("/config"));if(!v)return o.error({message:null==(i=null==l?void 0:l.proxy)?void 0:i.$t("upload.message3")}),void(await t.push("/config"));const _=d.value.filter((e=>0===e.uploadStatus.progress));if(0===_.length)return void o.error({message:null==(n=null==l?void 0:l.proxy)?void 0:n.$t("upload.message4")});u.value=!0;const b=await h(_);u.value=!1;const y=_.filter((e=>100===e.uploadStatus.progress)).map((e=>e.uploadedImg));switch(b){case Ze.uploaded:o.success({message:null==(r=null==l?void 0:l.proxy)?void 0:r.$t("upload.message5")}),await f(y);break;case Ze.allUploaded:o.success({message:null==(c=null==l?void 0:l.proxy)?void 0:c.$t("upload.message6")}),await f(y,!0);break;case Ze.uploadFail:o.error({message:null==(m=null==l?void 0:l.proxy)?void 0:m.$t("upload.message7")})}},b=()=>{u.value=!1,a.dispatch("UPLOAD_IMG_LIST_RESET"),p()};O((()=>c),(e=>{!e&&b()})),O((()=>a.state.uploadImageListModule.uploadImageList),(e=>{d.value=e}),{immediate:!0,deep:!0});return R((()=>{document.addEventListener("keydown",(e=>{const a=e.keyCode||e.which||e.charCode,t=e.ctrlKey||e.metaKey;t&&65===a&&d.value.length&&(b(),e.preventDefault()),t&&83===a&&(u.value||(v(),e.preventDefault()))}))})),(e,t)=>{const l=Ut,n=$t,s=M;return y(),x("div",vl,[!d.value.length||I(r).elementPlusSize!==I(ca).large&&I(r).elementPlusSize!==I(ca).default?F("",!0):(y(),x("div",_l,[(y(!0),x(q,null,K(d.value,((e,l)=>(y(),x("div",{class:"uploaded-item",key:l+e.uuid},[$(fl,{"img-obj":e,onRemove:t[0]||(t[0]=e=>{return t=e,a.dispatch("UPLOAD_IMG_LIST_REMOVE",t),void(null==(l=i.value)||l.remove(t));var t,l})},null,8,["img-obj"])])))),128))])),S("div",{class:Q(["upload-page-right page-container",{"has-left":d.value.length}])},[S("div",bl,[S("div",yl,[$(l,{disabled:u.value,ref_key:"gettingImagesRef",ref:i,onGetImgList:g},null,8,["disabled"])])]),S("div",wl,[S("div",kl,[$(n),d.value.length?(y(),x("div",Il,W(e.$t("upload.uploaded"))+"："+W(d.value.filter((e=>100===e.uploadStatus.progress)).length)+" / "+W(d.value.length),1)):F("",!0)])]),d.value.length?(y(),x("div",xl,[S("div",Sl,[$(s,{disabled:u.value,plain:"",type:"warning",onClick:b},{default:C((()=>[X(W(e.$t("reset"))+" ",1),S("span",Ll,"[ "+W(m.value)+" + A ]",1)])),_:1},8,["disabled"]),$(s,{disabled:u.value,plain:"",type:"primary",onClick:v},{default:C((()=>[X(W(e.$t("upload.upload"))+" ",1),S("span",Tl,"[ "+W(m.value)+" + S ]",1)])),_:1},8,["disabled"])])])):F("",!0)],2)])}}}),Cl={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Dl=[S("path",{fill:"currentColor",d:"M176 416a112 112 0 1 1 0 224a112 112 0 0 1 0-224zm336 0a112 112 0 1 1 0 224a112 112 0 0 1 0-224zm336 0a112 112 0 1 1 0 224a112 112 0 0 1 0-224z"},null,-1)];var El={name:"ep-more-filled",render:function(e,a){return y(),x("svg",Cl,Dl)}};const Ol={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Rl=[S("path",{fill:"currentColor",d:"M768 832a128 128 0 0 1-128 128H192A128 128 0 0 1 64 832V384a128 128 0 0 1 128-128v64a64 64 0 0 0-64 64v448a64 64 0 0 0 64 64h448a64 64 0 0 0 64-64h64z"},null,-1),S("path",{fill:"currentColor",d:"M384 128a64 64 0 0 0-64 64v448a64 64 0 0 0 64 64h448a64 64 0 0 0 64-64V192a64 64 0 0 0-64-64H384zm0-64h448a128 128 0 0 1 128 128v448a128 128 0 0 1-128 128H384a128 128 0 0 1-128-128V192A128 128 0 0 1 384 64z"},null,-1)];var Al={name:"ep-copy-document",render:function(e,a){return y(),x("svg",Ol,Rl)}};const Nl={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Ml=[S("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64zm67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344zM590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296c-44.096 0-108.992 44.736-148.48 101.504c0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04c67.84 0 107.904-43.648 147.456-100.416z"},null,-1)];var Ul={name:"ep-info-filled",render:function(e,a){return y(),x("svg",Nl,Ml)}};const zl={class:"copy-image-link-box"},Pl={class:"left"},jl={class:"right"};var Bl=mt(v({__name:"copy-image-link",props:{imgObj:{type:Object,default:()=>{}}},setup(e){const a=e,t=_((()=>Ja.getters.getUserSettings)).value,l=_((()=>Ja.getters.getUserConfigInfo)).value,i=_((()=>t.imageLinkFormat.enable?`${t.imageLinkType.selected} & ${t.imageLinkFormat.selected}`:`${t.imageLinkType.selected}`));let n=E(a.imgObj).value;const s=()=>{Ba(n,l,t)};return ne((()=>{n=a.imgObj})),(e,a)=>{const t=Ul,l=L,n=T,o=Al,r=M;return y(),x("div",zl,[S("div",Pl,[$(n,{content:i.value,placement:"top"},{default:C((()=>[$(l,null,{default:C((()=>[$(t)])),_:1})])),_:1},8,["content"])]),S("div",jl,[$(r,{plain:"",type:"primary",size:"small",onClick:s},{default:C((()=>[$(l,null,{default:C((()=>[$(o)])),_:1}),X(" "+W(e.$t("upload.copyLink")),1)])),_:1})])])}}}),[["__scopeId","data-v-14701c17"]]);const Vl={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Gl=[S("path",{fill:"currentColor",d:"M764.288 214.592L512 466.88L259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512L214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"},null,-1)];var Fl={name:"ep-close",render:function(e,a){return y(),x("svg",Vl,Gl)}};const Hl=["element-loading-text"],Xl={class:"image-box"},Wl={class:"info-box"},ql={class:"image-info"},Kl={key:0,class:"rename-operate"},Jl={key:1,class:"filename"},Yl={class:"copy-link-box"},Ql={class:"operation-box"},Zl={class:"operation-left"},ei={class:"operation-right"},ai={class:"operation-btn"};var ti=mt(v({__name:"image-card",props:{imageObj:{type:Object,default:()=>({})},isUploaded:{type:Boolean,default:!1}},setup(e){const a=e,t=D(),l=Qa(),i=se(),n=_((()=>l.getters.getUserConfigInfo)).value,s=_((()=>l.getters.getUserSettings)).value,c=_((()=>"/management"===i.path)),d=_((()=>za(a.imageObj,n,s))),u=E(),m=E(""),g=E(!1),h=E(!1),f=E(!1),v=(e,a=!1)=>{a||(e.deleting=!0);const{owner:i,selectedRepo:s}=n,{path:r,sha:c}=e;return new Promise((async n=>{var d,u;await lt(i,s,r,c)?(a?(g.value=!1,o.success({message:null==(d=null==t?void 0:t.proxy)?void 0:d.$t("management.message4")})):o.success({message:null==(u=null==t?void 0:t.proxy)?void 0:u.$t("management.message5")}),await l.dispatch("DIR_IMAGE_LIST_REMOVE",e),await l.dispatch("UPLOAD_IMG_LIST_REMOVE",e.uuid),n(!0)):n(!1)}))},b=async()=>{var e,i,c,h,f;const{imageObj:_}=a;if(!m.value)return o.error({message:null==(e=null==t?void 0:t.proxy)?void 0:e.$t("management.message1")}),void(null==(i=u.value)||i.focus());if(m.value===Oa(_.name))return o.error({message:null==(c=null==t?void 0:t.proxy)?void 0:c.$t("management.message2")}),void(g.value=!1);const b=async()=>{var e,a,i;const c=r.service({lock:!0,text:null==(e=null==t?void 0:t.proxy)?void 0:e.$t("management.loadingTxt2")}),u=Ra(_.name),p=wa(),h=`${m.value}${s.imageName.autoAddHash?`.${p}`:""}.${u}`;let f;var b;if(f=u.includes("svg")?await(b=d.value||"",new Promise((e=>{Ge({baseURL:"",url:b,method:"GET",responseType:"blob"}).then((a=>{if(a){const t=new FileReader;t.onload=()=>{const a=t.result;e(a)},t.onerror=()=>{e(null)},t.readAsDataURL(a)}else e(null)})).catch((()=>{e(null)}))}))):await function(e,a){const t=document.createElement("canvas"),l=t.getContext("2d"),i=new Image;return i.crossOrigin="Anonymous",i.src=e,new Promise((e=>{i.onload=()=>{const{width:n}=i,{height:s}=i;t.width=n,t.height=s,null==l||l.drawImage(i,0,0,n,s);const o=t.toDataURL(`image/${a}`);e(o)}}))}(d.value||"",u),f){const e={uuid:"",base64:{originalBase64:"",watermarkBase64:null,compressBase64:null},fileInfo:{originalFile:null,watermarkFile:null,compressFile:null},filename:{hash:"",suffix:"",name:"",prefixName:"",final:"",initName:"",newName:"",isAddHash:!0,isRename:!1,isPrefixNaming:!1,isTimestampNaming:!1},beforeUploadStatus:{watermarking:!1,compressing:!1},uploadStatus:{progress:0,uploading:!1},reUploadInfo:{dir:"",path:"",isReUpload:!1}};e.uuid=p,e.base64.originalBase64=f,e.filename.final=h,e.reUploadInfo.isReUpload=!0,e.reUploadInfo.dir=_.dir;let i=h;"/"!==_.dir&&(i=`${_.dir}/${h}`),e.reUploadInfo.path=i;await Bt(n,e)?(m.value="",await v(_,!0),await l.dispatch("UPLOAD_IMG_LIST_REMOVE",_.uuid)):o.error({message:null==(a=null==t?void 0:t.proxy)?void 0:a.$t("management.message3")})}else o.error({message:null==(i=null==t?void 0:t.proxy)?void 0:i.$t("management.message3")});c.close(),g.value=!1};p.confirm(null==(h=null==t?void 0:t.proxy)?void 0:h.$t("management.renameTips",{name:m.value}),null==(f=null==t?void 0:t.proxy)?void 0:f.$t("tips"),{type:"info"}).then((()=>{b()})).catch((()=>{g.value=!1}))},k=e=>{f.value=e};return(a,i)=>{const n=te,s=A,o=Fl,r=M,_=Ft,T=oe,D=Bl,E=L,O=El,R=re,N=ce,U=de,z=V;return G((y(),x("div",{class:Q(["image-card",{checked:e.imageObj.checked}]),"element-loading-text":a.$t("management.loadingTxt3"),onMouseenter:i[6]||(i[6]=e=>h.value=!0),onMouseleave:i[7]||(i[7]=e=>h.value=!1)},[S("div",Xl,[$(n,{src:d.value,fit:"cover",loading:"lazy",lazy:"","hide-on-click-modal":!0,"preview-src-list":[d.value]},null,8,["src","preview-src-list"])]),S("div",Wl,[S("div",ql,[g.value?(y(),x("div",Kl,[$(s,{size:"small",class:"rename-input",modelValue:m.value,"onUpdate:modelValue":i[0]||(i[0]=e=>m.value=e),clearable:"",ref_key:"renameInputRef",ref:u,maxlength:I(18)},null,8,["modelValue","maxlength"]),$(T,{size:"small"},{default:C((()=>[$(r,{onClick:i[1]||(i[1]=e=>g.value=!1)},{default:C((()=>[$(o)])),_:1}),$(r,{onClick:H(b,["prevent"])},{default:C((()=>[$(_)])),_:1},8,["onClick"])])),_:1})])):(y(),x("div",Jl,W(e.imageObj.name),1))])]),S("div",Yl,[$(D,{"img-obj":e.imageObj},null,8,["img-obj"])]),G(S("div",Ql,[S("div",Zl,[c.value?(y(),x("div",{key:0,class:Q([e.imageObj.checked?"picked-btn":"pick-btn","operation-btn"]),onClick:i[2]||(i[2]=a=>{return(t=e.imageObj).checked=!t.checked,void l.commit("IMAGE_CARD",{imageObj:t});var t})},[e.imageObj.checked?(y(),w(E,{key:0},{default:C((()=>[$(_)])),_:1})):F("",!0)],2)):F("",!0)]),S("div",ei,[$(U,{size:"default",trigger:"click",onVisibleChange:k},{dropdown:C((()=>[$(N,null,{default:C((()=>[$(R,{onClick:i[3]||(i[3]=a=>{return l=e.imageObj,void p.confirm(`\n    <div>${null==(i=null==t?void 0:t.proxy)?void 0:i.$t("management.delTips")}：</div>\n    <strong>${l.name}</strong>\n    `,null==(n=null==t?void 0:t.proxy)?void 0:n.$t("tips"),{dangerouslyUseHTMLString:!0,type:"warning"}).then((()=>{v(l)})).catch((()=>{}));var l,i,n})},{default:C((()=>[X(W(a.$t("upload.delete")),1)])),_:1}),$(R,{onClick:i[4]||(i[4]=H((a=>(async e=>{g.value=!0,m.value=Oa(e.name),setTimeout((()=>{var e;null==(e=u.value)||e.focus()}),100)})(e.imageObj)),["self"]))},{default:C((()=>[X(W(a.$t("upload.rename")),1)])),_:1}),$(R,{onClick:i[5]||(i[5]=a=>{return l=e.imageObj,void p.confirm(`\n    <div>${null==(i=null==t?void 0:t.proxy)?void 0:i.$t("management.imageName")}：<strong>${l.name}</strong></div>\n    <div>${null==(n=null==t?void 0:t.proxy)?void 0:n.$t("management.imageSize")}：<strong>${Na(l.size)} KB</strong></div>\n    `,null==(s=null==t?void 0:t.proxy)?void 0:s.$t("management.property"),{showCancelButton:!1,showConfirmButton:!1,dangerouslyUseHTMLString:!0,type:"info"});var l,i,n,s})},{default:C((()=>[X(W(a.$t("management.property")),1)])),_:1})])),_:1})])),default:C((()=>[S("div",ai,[$(E,null,{default:C((()=>[$(O)])),_:1})])])),_:1})])],512),[[ue,h.value||f.value||e.imageObj.checked]])],42,Hl)),[[z,e.imageObj.deleting]])}}}),[["__scopeId","data-v-ac323a38"]]);const li=e=>(Z("data-v-f3498e7c"),e=e(),ee(),e),ii=li((()=>S("div",{class:"icon"},[S("svg",{t:"1639999626518",class:"icon",viewBox:"0 0 1228 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3575",width:"200",height:"200"},[S("path",{d:"M1196.987733 212.5824v540.0576c0 39.594667-34.474667 71.3728-76.765866 71.3728H323.242667c-51.780267 0-88.746667-46.762667-73.250134-92.808533l126.737067-375.808H70.417067C31.675733 355.362133 0 326.4512 0 291.089067V98.372267C0 63.044267 31.675733 34.0992 70.417067 34.0992h378.811733c26.7264 0 51.029333 13.9264 63.010133 35.703467l39.048534 71.406933H1120.256c42.257067 0 76.8 32.119467 76.8 71.3728",fill:"#5398DF","p-id":"3576"}),S("path",{d:"M1128.721067 997.853867H68.266667a68.266667 68.266667 0 0 1-68.266667-68.266667V280.3712a68.266667 68.266667 0 0 1 68.266667-68.266667h1060.4544a68.266667 68.266667 0 0 1 68.266666 68.266667V929.5872a68.266667 68.266667 0 0 1-68.266666 68.266667",fill:"#85BCFF","p-id":"3577"})])],-1))),ni={key:1,class:"text"},si={key:2,class:"icon"},oi=[li((()=>S("svg",{t:"1640264285200",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"29312",width:"200",height:"200"},[S("path",{d:"M426.666667 384V213.333333l-298.666667 298.666667 298.666667 298.666667v-174.933334c213.333333 0 362.666667 68.266667 469.333333 217.6-42.666667-213.333333-170.666667-426.666667-469.333333-469.333333z","p-id":"29313",fill:"#85BCFF"})],-1)))],ri={key:3,class:"text"};var ci=mt(v({__name:"folder-card",props:{folderObj:{type:Object,default:()=>{}},mode:{type:String,default:"dir"}},setup(e){const a=e,t=Qa(),l=_((()=>t.getters.getUserConfigInfo)).value,i=()=>{const{folderObj:e,mode:i}=a;if("back"===i){const e=l.viewDir;if("/"===e)return;const a=e.split("/");1===a.length?l.viewDir="/":a.length>1&&(a.length-=1,l.viewDir=a.join("/"))}"dir"===i&&(l.viewDir=e.dirPath),t.dispatch("USER_CONFIG_INFO_PERSIST")};return(a,t)=>{const l=T;return y(),x("div",{class:"folder-card",onDblclick:i},["dir"===e.mode?(y(),w(l,{key:0,content:a.$t("management.toNextDir"),placement:"top"},{default:C((()=>[ii])),_:1},8,["content"])):F("",!0),"dir"===e.mode?(y(),x("div",ni,W(e.folderObj.dir),1)):F("",!0),"back"===e.mode?(y(),x("div",si,oi)):F("",!0),"back"===e.mode?(y(),x("div",ri,W(a.$t("management.back")),1)):F("",!0)],32)}}}),[["__scopeId","data-v-f3498e7c"]]);const di={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},ui=[S("path",{fill:"currentColor",d:"M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32V256zm448-64v-64H416v64h192zM224 896h576V256H224v640zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32zm192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32z"},null,-1)];var mi={name:"ep-delete",render:function(e,a){return y(),x("svg",di,ui)}};const gi={key:0,class:"selector-wrapper"},pi={class:"selector-left-box"},hi={class:"item"},fi={class:"selector-right-box"};var vi=mt(v({__name:"image-selector",props:{currentDirImageList:{type:Array,default:()=>[]}},emits:["update:initImageList"],setup(e){const a=e,t=Qa(),l=E(!1),i=D(),n=_((()=>t.getters.getImageCardCheckedArr)),s=_((()=>t.getters.getUserConfigInfo)).value,r=_((()=>t.getters.getUserSettings)).value,c=_((()=>n.value.length||0));O((()=>c.value),(e=>{const t=a.currentDirImageList.length;l.value=e===t}));const d=()=>{Va(n.value,s,r)},u=()=>{a.currentDirImageList.forEach((e=>{e.checked&&(e.checked=!1)}))},m=()=>{var e,a,t,l;(null==(e=n.value)?void 0:e.length)>0&&p.confirm(null==(t=null==i?void 0:i.proxy)?void 0:t.$t("management.delTips2",{total:null==(a=n.value)?void 0:a.length}),null==(l=null==i?void 0:i.proxy)?void 0:l.$t("tips"),{type:"warning"}).then((async()=>{var e,a,t;const l=await Ca(n.value,s);l===aa.deleted&&o.success({message:null==(e=null==i?void 0:i.proxy)?void 0:e.$t("management.message5")}),l===aa.allDeleted&&o.success({message:null==(a=null==i?void 0:i.proxy)?void 0:a.$t("management.message6")}),l===aa.deleteFail&&o.error({message:null==(t=null==i?void 0:i.proxy)?void 0:t.$t("management.message7")})})).catch((()=>{}))},g=()=>{let e=[];a.currentDirImageList.forEach((e=>{e.checked=l.value})),e=a.currentDirImageList,t.commit("REPLACE_IMAGE_CARD",{checkedImgArr:e})};return R((()=>{g()})),(e,a)=>{const t=le,i=Al,n=L,s=T,o=mi;return c.value?(y(),x("div",gi,[S("div",pi,[$(t,{label:l.value?e.$t("management.deselectAll"):e.$t("management.selectAll"),modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=e=>l.value=e),onChange:g},null,8,["label","modelValue"]),S("div",hi,W(e.$t("management.selectTotal",{total:c.value})),1),S("div",{class:"item cancel-select-btn",onClick:u},W(e.$t("management.unselect")),1)]),S("div",fi,[$(s,{placement:"top",content:e.$t("management.batchCopy")},{default:C((()=>[$(n,{class:"btn-icon",onClick:d},{default:C((()=>[$(i)])),_:1})])),_:1},8,["content"]),$(s,{placement:"top",content:e.$t("management.batchDelete")},{default:C((()=>[$(n,{class:"btn-icon",onClick:m},{default:C((()=>[$(o)])),_:1})])),_:1},8,["content"])])])):F("",!0)}}}),[["__scopeId","data-v-0ff830e2"]]);const _i={class:"page-container management-page-container"},bi={class:"content-container"},yi={class:"top"},wi={class:"left"},ki={class:"right flex-start"},Ii=["element-loading-text"],xi={key:0,class:"image-management-item"},Si=(e=>(Z("data-v-400d1d22"),e=e(),ee(),e))((()=>S("div",{style:{width:"100%"}},null,-1)));var Li=mt(v({__name:"imgs-management",setup(e){const a=Qa(),t=ie(),l=_((()=>a.getters.getUserConfigInfo)).value,i=_((()=>a.getters.getUserLoginStatus)).value,n=_((()=>a.getters.getDirObject)).value,s=E((new Date).getTime()),o=E(!1),r=E([]),c=E([]),d=E(!1);async function u(e){o.value=!0;const t=Je(e,n);if(t){const i=Ye(0,t,"dir"),n=Ye(0,t,"image");i.length||n.length?(r.value=i,c.value=n,a.commit("REPLACE_IMAGE_CARD",{checkedImgArr:c.value})):await et(l,e)}else await et(l,e);o.value=!1}async function m(){const{viewDir:e}=l;await a.dispatch("DIR_IMAGE_LIST_INIT_DIR",e),o.value=!0,await et(l,e),o.value=!1}return R((()=>{!async function(){const{selectedDir:e,viewDir:a,dirMode:t}=l;""===a&&(t!==oa.newDir&&t!==oa.autoDir||Je(e,n)||(l.selectedDir="/",l.dirMode="rootDir"),l.selectedDir?l.viewDir=l.selectedDir:l.viewDir="/"),n.imageList.length||n.childrenDirs.length?await u(l.viewDir):await et(l,l.viewDir)}()})),O((()=>i),(e=>{!1===e&&t.push("/config")})),O((()=>l.viewDir),(async e=>{await u(e),s.value+=1}),{deep:!0}),O((()=>n),(e=>{const{viewDir:t}=l,i=Je(t,e);i&&(r.value=Ye(0,i,"dir"),c.value=Ye(0,i,"image"),a.commit("REPLACE_IMAGE_CARD",{checkedImgArr:c.value}))}),{deep:!0}),O((()=>c.value),(e=>{d.value=e.filter((e=>e.checked)).length>0}),{deep:!0}),(e,a)=>{const t=ut,i=L,n=T,u=me("contextmenu"),g=V;return y(),x("div",_i,[S("div",bi,[S("div",yi,[S("div",wi,[$($t,{"bar-type":"management"})]),S("div",ki,[$(n,{placement:"top",content:e.$t("management.reload",{dir:I(l).viewDir})},{default:C((()=>[$(i,{class:"btn-icon",onClick:H(m,["stop"])},{default:C((()=>[$(t)])),_:1},8,["onClick"])])),_:1},8,["content"])])]),G((y(),x("div",{class:"bottom","element-loading-text":e.$t("management.loadingTxt1")},[c.value.length?(y(),w(vi,{currentDirImageList:c.value,"onUpdate:initImageList":c.value,key:s.value},null,8,["currentDirImageList","onUpdate:initImageList"])):F("",!0),G((y(),x("ul",{class:"image-management-list",style:k({height:d.value?"calc(100% - 50rem)":"100%"})},["/"!==I(l).viewDir?(y(),x("li",xi,[$(ci,{mode:"back"})])):F("",!0),(y(!0),x(q,null,K(r.value,((e,a)=>G((y(),x("li",{class:"image-management-item",key:"folder-card-"+e.dir+"-"+a},[$(ci,{"folder-obj":e},null,8,["folder-obj"])])),[[u,{type:I(va).childDir,dir:e.dir}]]))),128)),Si,(y(!0),x(q,null,K(c.value,((e,a)=>G((y(),x("li",{class:"image-management-item image",key:"image-card-"+a},[$(ti,{"image-obj":e},null,8,["image-obj"])])),[[u,{type:I(va).img,img:e}]]))),128))],4)),[[u,{type:I(va).parentDir}]])],8,Ii)),[[g,o.value]])])])}}}),[["__scopeId","data-v-400d1d22"]]);const Ti={class:"card-header"},$i=["contenteditable","onFocusout"],Ci={style:{"margin-top":"20px"}};var Di=mt(v({__name:"image-link-rule-config",setup(e){const a=D(),t=_((()=>Ja.getters.getUserSettings)).value,l=E(),i=ae({id:"",name:"",rule:"",editable:!0});return(e,n)=>{const s=ge,o=mi,r=M,c=pe,d=he,u=A,m=N,g=U,h=fe;return y(),w(h,null,{header:C((()=>[S("div",Ti,[S("span",null,W(e.$t("settings.link_rule.card_title")),1)])])),default:C((()=>[$(c,{data:I(t).imageLinkType.presetList,style:{width:"100%"}},{default:C((()=>[$(s,{prop:"name",label:e.$t("settings.link_rule.card_table_col_title_1"),width:"120"},null,8,["label"]),$(s,{label:e.$t("settings.link_rule.card_table_col_title_2")},{default:C((e=>[S("div",{contenteditable:e.row.editable,onFocusout:a=>{return t=a.target.innerHTML,l=e.row.id,void Ja.dispatch("UPDATE_IMAGE_LINK_TYPE_RULE",{rule:t,id:l});var t,l}},W(e.row.rule),41,$i)])),_:1},8,["label"]),$(s,{label:e.$t("settings.link_rule.card_table_col_title_3"),width:"80",align:"center"},{default:C((e=>[$(r,{link:"",size:"small",disabled:!e.row.editable,onClick:t=>{return l=e.row,void p.confirm(`${null==(i=null==a?void 0:a.proxy)?void 0:i.$t("settings.link_format.delete_tips")}：<strong>${l.name}</strong>`,null==(n=null==a?void 0:a.proxy)?void 0:n.$t("tips"),{dangerouslyUseHTMLString:!0,type:"warning"}).then((()=>{Ja.dispatch("DEL_IMAGE_LINK_TYPE_RULE",l.id)})).catch((()=>{}));var l,i,n}},{default:C((()=>[$(o)])),_:2},1032,["disabled","onClick"])])),_:1},8,["label"])])),_:1},8,["data"]),$(d),S("div",Ci,[$(g,{ref_key:"formRef",ref:l,"label-position":"left",model:i,"label-width":"120px",size:"default"},{default:C((()=>[$(m,{label:e.$t("settings.link_rule.input_name_1"),prop:"name",rules:[{required:!0,message:e.$t("settings.link_rule.input_name_1_rule")}]},{default:C((()=>[$(u,{modelValue:i.name,"onUpdate:modelValue":n[0]||(n[0]=e=>i.name=e),type:"text"},null,8,["modelValue"])])),_:1},8,["label","rules"]),$(m,{label:e.$t("settings.link_rule.input_name_2"),prop:"rule",rules:[{required:!0,message:e.$t("settings.link_rule.input_name_2_rule")}]},{default:C((()=>[$(u,{modelValue:i.rule,"onUpdate:modelValue":n[1]||(n[1]=e=>i.rule=e),type:"text"},null,8,["modelValue"])])),_:1},8,["label","rules"]),$(m,null,{default:C((()=>[$(r,{type:"primary",disabled:!i.name||!i.rule,onClick:n[2]||(n[2]=e=>{var a;(a=l.value)&&a.validate((e=>{e&&(i.id=wa(),Ja.dispatch("ADD_IMAGE_LINK_TYPE_RULE",JSON.parse(JSON.stringify(i))))}))})},{default:C((()=>[X(W(e.$t("settings.link_rule.btn_name_1")),1)])),_:1},8,["disabled"])])),_:1})])),_:1},8,["model"])])])),_:1})}}}),[["__scopeId","data-v-d0e8ffa8"]]);const Ei={class:"compress-config-box"},Oi={class:"img-encoder-title"},Ri={class:"desc"},Ai={class:"desc"},Ni={class:"desc"};var Mi=mt(v({__name:"compress-config-box",props:{disabled:{type:Boolean,default:!1},usageScenario:{type:String,default:"toolbox"}},emits:["encoder"],setup(e,{expose:a,emit:t}){const l=e,i=_((()=>Ja.getters.getUserSettings)).value,n=E(la.webP),s=e=>{t("encoder",e)};return R((()=>{"imageHosting"===l.usageScenario&&(n.value=i.compress.encoder),t("encoder",n.value)})),a({reset:()=>{n.value=la.webP}}),(a,t)=>{const l=j,i=B;return y(),x("div",Ei,[S("div",Oi,W(a.$t("settings.img_compress.radio_group_title")),1),$(i,{disabled:e.disabled,class:"img-encoder-group",modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=e=>n.value=e),onChange:s},{default:C((()=>[$(l,{label:I(la).webP},{default:C((()=>[X(W(I(la).webP)+" ",1),S("span",Ri,W(a.$t("settings.img_compress.radio_1_desc")),1)])),_:1},8,["label"]),$(l,{label:I(la).mozJPEG},{default:C((()=>[X(W(I(la).mozJPEG)+" ",1),S("span",Ai,W(a.$t("settings.img_compress.radio_2_desc")),1)])),_:1},8,["label"]),$(l,{label:I(la).avif},{default:C((()=>[X(W(I(la).avif)+" ",1),S("span",Ni,W(a.$t("settings.img_compress.radio_3_desc")),1)])),_:1},8,["label"])])),_:1},8,["disabled","modelValue"])])}}}),[["__scopeId","data-v-186c475a"]]);const Ui=v({__name:"watermark-config-box",props:{isTool:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["watermarkConfig"],setup(e,{emit:a}){const t=ae({text:"",fontSize:0,position:ua.rightBottom,textColor:"",opacity:0}),l=()=>{a("watermarkConfig",t)};return R((()=>{const e=Ja.getters.getUserSettings.watermark;t.text=e.text,t.textColor=e.textColor,t.fontSize=e.fontSize,t.position=e.position,t.opacity=e.opacity,a("watermarkConfig",t)})),(a,i)=>{const n=A,s=N,o=ve,r=_e,c=be,d=j,u=B,m=ye,g=U;return y(),w(g,{class:"watermark-config-form","label-position":"left","label-width":"90rem",disabled:e.disabled},{default:C((()=>[$(m,null,{default:C((()=>[$(o,{span:24},{default:C((()=>[$(s,{label:a.$t("settings.img_watermark.text")},{default:C((()=>[$(n,{modelValue:t.text,"onUpdate:modelValue":i[0]||(i[0]=e=>t.text=e),placeholder:a.$t("settings.img_watermark.text_input_placeholder"),clearable:"",maxlength:"20",onInput:l},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1}),$(o,{span:e.isTool?10:24},{default:C((()=>[$(s,{label:a.$t("settings.img_watermark.size")},{default:C((()=>[$(r,{modelValue:t.fontSize,"onUpdate:modelValue":i[1]||(i[1]=e=>t.fontSize=e),min:40,max:80,step:2,onChange:l},null,8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["span"]),$(o,{span:e.isTool?14:24},{default:C((()=>[$(s,{label:a.$t("settings.img_watermark.color")},{default:C((()=>[$(c,{modelValue:t.textColor,"onUpdate:modelValue":i[2]||(i[2]=e=>t.textColor=e),onChange:l},null,8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["span"]),$(o,{span:e.isTool?10:24},{default:C((()=>[$(s,{label:a.$t("settings.img_watermark.opacity")},{default:C((()=>[$(r,{modelValue:t.opacity,"onUpdate:modelValue":i[3]||(i[3]=e=>t.opacity=e),precision:1,step:.1,min:.1,max:.9,onChange:l},null,8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["span"]),$(o,{span:e.isTool?14:24},{default:C((()=>[$(s,{label:a.$t("settings.img_watermark.position")},{default:C((()=>[$(u,{modelValue:t.position,"onUpdate:modelValue":i[4]||(i[4]=e=>t.position=e),onChange:l},{default:C((()=>[$(d,{label:I(ua).leftTop},{default:C((()=>[X(W(a.$t("settings.img_watermark.position_1")),1)])),_:1},8,["label"]),$(d,{label:I(ua).leftBottom},{default:C((()=>[X(W(a.$t("settings.img_watermark.position_2")),1)])),_:1},8,["label"]),$(d,{label:I(ua).rightTop},{default:C((()=>[X(W(a.$t("settings.img_watermark.position_3")),1)])),_:1},8,["label"]),$(d,{label:I(ua).rightBottom},{default:C((()=>[X(W(a.$t("settings.img_watermark.position_4")),1)])),_:1},8,["label"])])),_:1},8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["span"])])),_:1})])),_:1},8,["disabled"])}}});const zi={class:"page-container settings-page-container"},Pi={class:"setting-list",style:{"margin-top":"10rem"}},ji={class:"setting-item has-desc"},Bi={class:"desc"},Vi={class:"setting-item has-desc"},Gi={class:"desc"},Fi={key:0,class:"setting-item has-desc"},Hi={class:"setting-item has-desc"},Xi={class:"setting-list"},Wi={class:"setting-item has-desc"},qi={class:"desc"},Ki={class:"setting-item"},Ji={class:"setting-list"},Yi={class:"setting-item has-desc"},Qi={class:"desc"},Zi={class:"setting-item"},en={class:"setting-list"},an={class:"setting-item cdn"},tn={class:"left"},ln={class:"right"},nn={class:"setting-item",style:{"margin-top":"20rem"}},sn={class:"setting-list"},on={class:"setting-item has-desc"},rn={class:"desc"},cn={class:"setting-item"},dn={class:"left"},un={class:"right"},mn={class:"setting-list"},gn={class:"setting-item"};var pn=mt(v({__name:"my-settings",setup(e){const a=_((()=>Ja.getters.getUserSettings)).value,t=()=>{Ja.dispatch("USER_SETTINGS_PERSIST")},l=()=>{Ja.dispatch("SET_USER_SETTINGS",n({},a))},i=e=>{a.watermark.text=e.text,a.watermark.textColor=e.textColor,a.watermark.opacity=e.opacity,a.watermark.position=e.position,a.watermark.fontSize=e.fontSize,t()};return O((()=>a.imageName),(e=>{e.autoTimestampNaming&&(a.imageName.autoAddHash=!1,a.imageName.prefixNaming.enable=!1),t()}),{immediate:!0,deep:!0}),(e,n)=>{const s=we,o=A,r=ke,c=Ui,d=fe,u=Mi,m=z,g=P,p=Di,h=Ie;return y(),x("div",zi,[$(h,null,{default:C((()=>[$(r,{title:e.$t("settings.img_name.title"),name:"1"},{default:C((()=>[S("ul",Pi,[S("li",ji,[$(s,{modelValue:I(a).imageName.autoAddHash,"onUpdate:modelValue":n[0]||(n[0]=e=>I(a).imageName.autoAddHash=e),onChange:t,"active-text":e.$t("settings.img_name.hash_switch_name")},null,8,["modelValue","active-text"]),S("span",Bi,W(e.$t("settings.img_name.hash_switch_desc")),1)]),S("li",Vi,[$(s,{modelValue:I(a).imageName.prefixNaming.enable,"onUpdate:modelValue":n[1]||(n[1]=e=>I(a).imageName.prefixNaming.enable=e),onChange:t,"active-text":e.$t("settings.img_name.prefix_switch_name")},null,8,["modelValue","active-text"]),S("span",Gi,W(e.$t("settings.img_name.prefix_switch_desc")),1)]),I(a).imageName.prefixNaming.enable?(y(),x("li",Fi,[$(o,{class:"prefix-input",modelValue:I(a).imageName.prefixNaming.prefix,"onUpdate:modelValue":n[2]||(n[2]=e=>I(a).imageName.prefixNaming.prefix=e),placeholder:e.$t("settings.img_name.prefix_input_placeholder"),onInput:t,clearable:"",autofocus:""},null,8,["modelValue","placeholder"])])):F("",!0),S("li",Hi,[$(s,{modelValue:I(a).imageName.autoTimestampNaming,"onUpdate:modelValue":n[3]||(n[3]=e=>I(a).imageName.autoTimestampNaming=e),onChange:t,"active-text":e.$t("settings.img_name.timestamp_switch_name")},null,8,["modelValue","active-text"])])])])),_:1},8,["title"]),$(r,{title:e.$t("settings.img_watermark.title"),name:"2"},{default:C((()=>[S("ul",Xi,[S("li",Wi,[$(s,{modelValue:I(a).watermark.enable,"onUpdate:modelValue":n[4]||(n[4]=e=>I(a).watermark.enable=e),onChange:t,"active-text":e.$t("settings.img_watermark.switch_name")},null,8,["modelValue","active-text"]),S("span",qi,W(e.$t("settings.img_watermark.switch_desc")),1)]),S("li",Ki,[$(d,{class:"settings-item-card"},{default:C((()=>[$(c,{disabled:!I(a).watermark.enable,onWatermarkConfig:i},null,8,["disabled"])])),_:1})])])])),_:1},8,["title"]),$(r,{title:e.$t("settings.img_compress.title"),name:"3"},{default:C((()=>[S("ul",Ji,[S("li",Yi,[$(s,{modelValue:I(a).compress.enable,"onUpdate:modelValue":n[5]||(n[5]=e=>I(a).compress.enable=e),onChange:t,"active-text":e.$t("settings.img_compress.switch_name")},null,8,["modelValue","active-text"]),S("span",Qi,W(e.$t("settings.img_compress.switch_desc")),1)]),S("li",Zi,[$(d,{class:"settings-item-card"},{default:C((()=>[$(u,{ref:"compressConfigBoxRef","usage-scenario":"imageHosting",disabled:!I(a).compress.enable,onEncoder:n[6]||(n[6]=e=>{I(a).compress.encoder=e,t()})},null,8,["disabled"])])),_:1})])])])),_:1},8,["title"]),$(r,{title:e.$t("settings.link_rule.title"),name:"4"},{default:C((()=>[S("ul",en,[S("li",an,[X(W(e.$t("settings.link_rule.select_title"))+"： ",1),$(g,{modelValue:I(a).imageLinkType.selected,"onUpdate:modelValue":n[7]||(n[7]=e=>I(a).imageLinkType.selected=e),onChange:l},{default:C((()=>[(y(!0),x(q,null,K(I(a).imageLinkType.presetList,(e=>(y(),w(m,{key:e.name+"-"+e.id,label:e.name,value:e.name,class:"image-link-type-rule-option"},{default:C((()=>[S("span",tn,W(e.name),1),S("span",ln,W(e.rule),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])]),S("li",nn,[$(p)])])])),_:1},8,["title"]),$(r,{title:e.$t("settings.link_format.title"),name:"5"},{default:C((()=>[S("ul",sn,[S("li",on,[$(s,{modelValue:I(a).imageLinkFormat.enable,"onUpdate:modelValue":n[8]||(n[8]=e=>I(a).imageLinkFormat.enable=e),onChange:t,"active-text":e.$t("settings.link_format.switch_name")},null,8,["modelValue","active-text"]),S("span",rn,W(e.$t("settings.link_format.switch_desc",{type:I(a).imageLinkFormat.selected})),1)]),S("li",cn,[X(W(e.$t("settings.link_format.select_title"))+"： ",1),$(g,{modelValue:I(a).imageLinkFormat.selected,"onUpdate:modelValue":n[9]||(n[9]=e=>I(a).imageLinkFormat.selected=e),onChange:l},{default:C((()=>[(y(!0),x(q,null,K(I(a).imageLinkFormat.presetList,((e,a)=>(y(),w(m,{key:a+e.name,label:e.name,value:e.name,class:"image-link-type-rule-option"},{default:C((()=>[S("span",dn,W(e.name),1),S("span",un,W(e.format),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])])])])),_:1},8,["title"]),$(r,{title:e.$t("settings.theme.title"),name:"6"},{default:C((()=>[S("ul",mn,[S("li",gn,[X(W(e.$t("header.theme"))+"： ",1),$(g,{modelValue:I(a).theme.mode,"onUpdate:modelValue":n[10]||(n[10]=e=>I(a).theme.mode=e),onChange:l},{default:C((()=>[$(m,{label:e.$t("settings.theme.system"),value:I(ga).system},null,8,["label","value"]),$(m,{label:e.$t("settings.theme.light"),value:I(ga).light},null,8,["label","value"]),$(m,{label:e.$t("settings.theme.dark"),value:I(ga).dark},null,8,["label","value"])])),_:1},8,["modelValue"])])])])),_:1},8,["title"])])),_:1})])}}}),[["__scopeId","data-v-4c83b394"]]);const hn={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},fn=[S("path",{fill:"currentColor",d:"M512 64h64v192h-64V64zm0 576h64v192h-64V640zM160 480v-64h192v64H160zm576 0v-64h192v64H736zM249.856 199.04l45.248-45.184L430.848 289.6L385.6 334.848L249.856 199.104zM657.152 606.4l45.248-45.248l135.744 135.744l-45.248 45.248L657.152 606.4zM114.048 923.2L68.8 877.952l316.8-316.8l45.248 45.248l-316.8 316.8zM702.4 334.848L657.152 289.6l135.744-135.744l45.248 45.248L702.4 334.848z"},null,-1)];var vn={name:"ep-magic-stick",render:function(e,a){return y(),x("svg",hn,fn)}};const _n={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},bn=[S("path",{fill:"currentColor",d:"M602.496 240.448A192 192 0 1 1 874.048 512l-316.8 316.8A256 256 0 0 1 195.2 466.752L602.496 59.456l45.248 45.248L240.448 512A192 192 0 0 0 512 783.552l316.8-316.8a128 128 0 1 0-181.056-181.056L353.6 579.904a32 32 0 1 0 45.248 45.248l294.144-294.144l45.312 45.248L444.096 670.4a96 96 0 1 1-135.744-135.744l294.144-294.208z"},null,-1)];var yn={name:"ep-paperclip",render:function(e,a){return y(),x("svg",_n,bn)}};const wn={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},kn=[S("path",{fill:"currentColor",d:"M160 224a32 32 0 0 0-32 32v512a32 32 0 0 0 32 32h704a32 32 0 0 0 32-32V256a32 32 0 0 0-32-32H160zm0-64h704a96 96 0 0 1 96 96v512a96 96 0 0 1-96 96H160a96 96 0 0 1-96-96V256a96 96 0 0 1 96-96z"},null,-1),S("path",{fill:"currentColor",d:"M704 320a64 64 0 1 1 0 128a64 64 0 0 1 0-128zM288 448h256q32 0 32 32t-32 32H288q-32 0-32-32t32-32zm0 128h256q32 0 32 32t-32 32H288q-32 0-32-32t32-32z"},null,-1)];var In={name:"ep-postcard",render:function(e,a){return y(),x("svg",wn,kn)}};const xn=xe([{name:"toolbox.tool_1",desc:"toolbox.tool_1_desc",icon:vn,uuid:wa(),path:"/compress"},{name:"toolbox.tool_2",desc:"toolbox.tool_2_desc",icon:yn,uuid:wa(),path:"/base64"},{name:"toolbox.tool_3",desc:"toolbox.tool_3_desc",icon:In,uuid:wa(),path:"/watermark"}]);const Sn={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Ln=[S("path",{fill:"currentColor",d:"M340.864 149.312a30.592 30.592 0 0 0 0 42.752L652.736 512L340.864 831.872a30.592 30.592 0 0 0 0 42.752a29.12 29.12 0 0 0 41.728 0L714.24 534.336a32 32 0 0 0 0-44.672L382.592 149.376a29.12 29.12 0 0 0-41.728 0z"},null,-1)];var Tn={name:"ep-arrow-right",render:function(e,a){return y(),x("svg",Sn,Ln)}};const $n={class:"page-container"},Cn={key:0,class:"tool-panel"},Dn={class:"panel-header"},En={class:"panel-body"},On={key:1,class:"toolbox"},Rn=["onClick"],An={class:"top"},Nn={class:"left flex-center"},Mn={class:"right"},Un={class:"bottom"};var zn=mt(v({__name:"picx-toolbox",setup(e){const a=xe(Tn),t=ie(),l=E("/toolbox"),i=E(!1),s=E({path:"",icon:"",name:"",desc:"",uuid:""}),o=e=>{i.value=!0,s.value=n({},e),Ja.dispatch("TOOLBOX_IMG_LIST_RESET"),t.push(`${l.value}${e.path}`)};O((()=>t.currentRoute.value),(e=>{e.path===l.value&&(i.value=!1)}),{deep:!0});return R((()=>{t.isReady().then((()=>{const e=t.currentRoute.value.path;if(l.value!==e){const a=e.substring(e.lastIndexOf("/")),t=xn.value.find((e=>e.path===a));t&&o(t)}}))})),(e,t)=>{const n=Se,r=Le,c=Te("router-view"),d=L;return y(),x("div",$n,[i.value?(y(),x("div",Cn,[S("div",Dn,[$(r,{"separator-icon":a.value},{default:C((()=>[$(n,{to:{path:l.value}},{default:C((()=>[X(W(e.$t("nav.toolbox")),1)])),_:1},8,["to"]),$(n,null,{default:C((()=>[X(W(e.$t(s.value.name)),1)])),_:1})])),_:1},8,["separator-icon"])]),S("div",En,[$(c)])])):(y(),x("ul",On,[(y(!0),x(q,null,K(I(xn),(a=>(y(),x("li",{class:"tool-item",key:a.uuid,onClick:e=>o(a)},[S("div",An,[S("div",Nn,[$(d,{size:30},{default:C((()=>[(y(),w($e(a.icon)))])),_:2},1024)]),S("div",Mn,W(e.$t(a.name)),1)]),S("div",Un,W(e.$t(a.desc)),1)],8,Rn)))),128))]))])}}}),[["__scopeId","data-v-06af4a8d"]]);const Pn={class:"page-container feedback-page-container"},jn={class:"help-info-item description"},Bn={class:"help-info-item"},Vn={class:"help-info-item"},Gn={class:"help-info-item"},Fn={class:"help-info-item"},Hn={class:"help-info-item",style:{"margin-bottom":"2rem"}},Xn={class:"help-info-item img"},Wn={class:"help-info-item red-text"};var qn=mt(v({__name:"feedback-info",setup(e){const a=_((()=>"win"===Ga()?"Ctrl + D":"Command + D"));return(e,t)=>{const l=Ce,i=te;return y(),x("div",Pn,[S("div",jn,"🏞️ "+W(e.$t("feedback.text_1")),1),S("div",Bn,[X(" 🌍 "+W(e.$t("feedback.text_2"))+" "+W(e.$t("shortcut_key"))+"：",1),S("code",null,W(a.value),1)]),S("div",Vn,[X(" 🦁 "+W(e.$t("author"))+"： ",1),$(l,{type:"primary",href:"https://xpoet.cn/",target:"_blank"},{default:C((()=>[X("@XPoet")])),_:1})]),S("div",Gn,[X(" 🌀 "+W(e.$t("repo"))+"： ",1),$(l,{type:"primary",href:"https://github.com/XPoet/picx",target:"_blank"},{default:C((()=>[X(" https://github.com/XPoet/picx ")])),_:1})]),S("div",Fn,[X(" 📖 "+W(e.$t("document"))+"： ",1),$(l,{type:"primary",href:"https://picx-docs.xpoet.cn",target:"_blank"},{default:C((()=>[X(" https://picx-docs.xpoet.cn ")])),_:1})]),S("div",Hn,"🎁 "+W(e.$t("feedback.text_3")),1),S("div",Xn,[$(i,{style:{width:"300rem"},src:"https://cdn.staticaly.com/gh/XPoet/image-hosting@master/common/appreciation.webp"})]),S("div",Wn,[S("strong",null," ⚠️ "+W(e.$t("feedback.text_4")),1)])])}}}),[["__scopeId","data-v-de924ba8"]]);const Kn={class:"img-process-state-card-container"},Jn={class:"img-container"},Yn={class:"info-container"},Qn={class:"img-name text-ellipsis"},Zn={class:"img-size"},es={key:0,class:"finial-file-size file-size-item"};var as=mt(v({__name:"img-process-state-card",props:{imgObj:{type:Object,require:!0,default:()=>({})},cardType:{type:String,default:"compress"}},emits:["remove"],setup:(e,{emit:a})=>(t,l)=>{const i=te,n=Jt,s=L,r=T,c=V;return y(),x("div",Kn,[G((y(),x("div",Jn,[$(i,{src:e.imgObj.finialBase64||e.imgObj.originalBase64,fit:"cover",loading:"lazy","hide-on-click-modal":!0,"preview-src-list":[e.imgObj.finialBase64||e.imgObj.originalBase64]},null,8,["src","preview-src-list"])])),[[c,e.imgObj.processing]]),S("div",Yn,[S("div",Qn,W(e.imgObj.finialName||e.imgObj.originalName),1),S("div",Zn,[S("div",{class:Q(["original-file-size file-size-item",{"del-line":e.imgObj.finialSize&&"compress"===e.cardType}])},W(I(Na)(e.imgObj.originalSize))+" KB ",3),e.imgObj.finialSize&&"compress"===e.cardType?(y(),x("div",es,W(I(Na)(e.imgObj.finialSize))+" KB ",1)):F("",!0)])]),e.imgObj.finialFile?(y(),x("div",{key:0,class:"operate-container flex-center",onClick:l[0]||(l[0]=a=>{Ea(e.imgObj.finialFile)})},W(t.$t("toolbox.click_download")),1)):F("",!0),"base64"===e.cardType&&e.imgObj.originalBase64?(y(),x("div",{key:1,class:"operate-container flex-center",onClick:l[1]||(l[1]=a=>{return l=e.imgObj.originalBase64,i=t.$t,void ka(l,(()=>{o.success({message:i("toolbox.copy_base64_success")})}));var l,i})},W(t.$t("toolbox.copy_base64")),1)):F("",!0),$(r,{placement:"top",offset:8,content:t.$t("delete")},{default:C((()=>[$(s,{class:"del-btn",onClick:l[2]||(l[2]=t=>{return l=e.imgObj.uuid,void a("remove",l);var l})},{default:C((()=>[$(n)])),_:1})])),_:1},8,["content"])])}}),[["__scopeId","data-v-d59c7528"]]);const ts={class:"compress-tool-container"},ls={key:0,class:"compress-tool-left"};var is=mt(v({__name:"compress-tool",setup(e){const a=Qa(),t=E(null),l=E(null),i=E([]),n=E(la.webP),s=E(!1),o=E(!1),r=e=>{o.value=!1,s.value=!1,e.forEach((e=>{a.dispatch("TOOLBOX_IMG_LIST_ADD",{uuid:e.uuid,originalName:e.file.name,originalSize:e.file.size,originalBase64:e.base64,originalFile:e.file})}))},c=()=>{var e,i;a.dispatch("TOOLBOX_IMG_LIST_RESET"),o.value=!1,null==(e=t.value)||e.reset(),null==(i=l.value)||i.reset()},d=async()=>{s.value=!0;for(const e of i.value)e.processing=!0,e.finialFile=await Ua(e.originalFile,n.value),e.finialBase64=await Da(e.finialFile)||"",e.finialSize=e.finialFile.size,e.finialName=e.finialFile.name,e.processing=!1;o.value=!0,s.value=!1},u=()=>{i.value.forEach((e=>{Ea(e.finialFile)}))},m=e=>{var l;a.dispatch("TOOLBOX_IMG_LIST_REMOVE",e),null==(l=t.value)||l.remove(e)};return O((()=>a.state.toolboxImageListModule.toolboxImageList),(e=>{i.value=e}),{immediate:!0,deep:!0}),(e,a)=>{const g=as,p=Ut,h=Mi,f=M;return y(),x("div",ts,[i.value.length?(y(),x("div",ls,[(y(!0),x(q,null,K(i.value,(e=>(y(),w(g,{"img-obj":e,key:e.uuid,onRemove:m},null,8,["img-obj"])))),128))])):F("",!0),S("div",{class:Q(["compress-tool-right",{"no-img":!i.value.length}])},[$(p,{ref_key:"gettingImagesRef",ref:t,onGetImgList:r},null,512),$(h,{ref_key:"compressConfigBoxRef",ref:l,style:{"margin-top":"18rem"},onEncoder:a[0]||(a[0]=e=>{return a=e,o.value=!1,void(n.value=a);var a})},null,512),S("div",{class:Q(["user-operate",{compressed:o.value&&i.value.length>1}])},[o.value&&i.value.length>1?(y(),w(f,{key:0,plain:"",type:"success",onClick:u},{default:C((()=>[X(W(e.$t("toolbox.batch_download")),1)])),_:1})):F("",!0),S("div",null,[i.value.length?(y(),w(f,{key:0,plain:"",type:"warning",onClick:c},{default:C((()=>[X(W(e.$t("reset")),1)])),_:1})):F("",!0),i.value.length?(y(),w(f,{key:1,disabled:s.value||o.value,plain:"",type:"primary",onClick:d},{default:C((()=>[X(W(e.$t("toolbox.compress")),1)])),_:1},8,["disabled"])):F("",!0)])],2)],2)])}}}),[["__scopeId","data-v-2f45486b"]]);const ns={class:"base64-tool-container"},ss={key:0,class:"base64-tool-left"},os={class:"user-operate"},rs=v({__name:"base64-tool",setup(e){const a=Qa(),t=E(null),l=E([]),i=e=>{e.forEach((e=>{a.dispatch("TOOLBOX_IMG_LIST_ADD",{uuid:e.uuid,originalName:e.file.name,originalSize:e.file.size,originalBase64:e.base64})}))},n=()=>{var e;a.dispatch("TOOLBOX_IMG_LIST_RESET"),null==(e=t.value)||e.reset()},s=e=>{var l;a.dispatch("TOOLBOX_IMG_LIST_REMOVE",e),null==(l=t.value)||l.remove(e)};return O((()=>a.state.toolboxImageListModule.toolboxImageList),(e=>{l.value=e}),{immediate:!0,deep:!0}),(e,a)=>{const o=as,r=Ut,c=M;return y(),x("div",ns,[l.value.length?(y(),x("div",ss,[(y(!0),x(q,null,K(l.value,(e=>(y(),w(o,{"card-type":"base64","img-obj":e,key:e.uuid,onRemove:s},null,8,["img-obj"])))),128))])):F("",!0),S("div",{class:Q(["base64-tool-right",{"no-img":!l.value.length}])},[$(r,{ref_key:"gettingImagesRef",ref:t,onGetImgList:i},null,512),S("div",os,[l.value.length?(y(),w(c,{key:0,plain:"",type:"warning",onClick:n},{default:C((()=>[X(W(e.$t("reset")),1)])),_:1})):F("",!0)])],2)])}}});const cs={class:"watermark-tool-container"},ds={key:0,class:"watermark-tool-left"};const us=[{path:"/",name:"index",redirect:{name:"upload"}},{path:"/config",name:"config",component:It,meta:{title:"nav.config"}},{path:"/upload",name:"upload",component:$l,meta:{title:"nav.upload"}},{path:"/management",name:"Management",component:Li,meta:{title:"nav.management"}},{path:"/settings",name:"settings",component:pn,meta:{title:"nav.settings"}},{path:"/toolbox",name:"Toolbox",component:zn,meta:{title:"nav.toolbox"},children:[{path:"/toolbox/compress",name:"Compress",component:is},{path:"/toolbox/base64",name:"Base64",component:mt(rs,[["__scopeId","data-v-654d8c19"]])},{path:"/toolbox/watermark",name:"Watermark",component:mt(v({__name:"watermark-tool",setup(e){const a=Qa(),t=ae({enable:!0,text:"",fontSize:0,opacity:0,position:ua.rightBottom,textColor:""}),l=E(null),i=E([]),n=E(!1),s=E(!1),o=e=>{s.value=!1,n.value=!1,e.forEach((e=>{a.dispatch("TOOLBOX_IMG_LIST_ADD",{uuid:e.uuid,originalName:e.file.name,originalSize:e.file.size,originalBase64:e.base64,originalFile:e.file})}))},r=e=>{t.text=e.text,t.textColor=e.textColor,t.opacity=e.opacity,t.position=e.position,t.fontSize=e.fontSize,s.value=!1},c=()=>{var e;a.dispatch("TOOLBOX_IMG_LIST_RESET"),s.value=!1,null==(e=l.value)||e.reset()},d=async()=>{n.value=!0;for(const e of i.value)e.processing=!0,e.finialFile=await Ta(e.originalFile,t),e.finialBase64=await Da(e.finialFile)||"",e.finialSize=e.finialFile.size,e.finialName=e.finialFile.name,e.processing=!1;s.value=!0,n.value=!1},u=()=>{i.value.forEach((e=>{Ea(e.finialFile)}))},m=e=>{var t;a.dispatch("TOOLBOX_IMG_LIST_REMOVE",e),null==(t=l.value)||t.remove(e)};return O((()=>a.state.toolboxImageListModule.toolboxImageList),(e=>{i.value=e}),{immediate:!0,deep:!0}),(e,a)=>{const g=as,p=Ut,h=Ui,f=M;return y(),x("div",cs,[i.value.length?(y(),x("div",ds,[(y(!0),x(q,null,K(i.value,(e=>(y(),w(g,{"img-obj":e,key:e.uuid,"card-type":"watermark",onRemove:m},null,8,["img-obj"])))),128))])):F("",!0),S("div",{class:Q(["watermark-tool-right",{"no-img":!i.value.length}])},[$(p,{ref_key:"gettingImagesRef",ref:l,onGetImgList:o},null,512),$(h,{isTool:!0,onWatermarkConfig:r,style:{"margin-top":"18rem"}}),S("div",{class:Q(["user-operate",{watermarked:s.value&&i.value.length>1}])},[s.value&&i.value.length>1?(y(),w(f,{key:0,plain:"",type:"success",onClick:u},{default:C((()=>[X(W(e.$t("toolbox.batch_download")),1)])),_:1})):F("",!0),S("div",null,[i.value.length?(y(),w(f,{key:0,plain:"",type:"warning",onClick:c},{default:C((()=>[X(W(e.$t("reset")),1)])),_:1})):F("",!0),i.value.length?(y(),w(f,{key:1,disabled:n.value||s.value||!t.text,plain:"",type:"primary",onClick:d},{default:C((()=>[X(W(e.$t("toolbox.add_watermark")),1)])),_:1},8,["disabled"])):F("",!0)])],2)],2)])}}}),[["__scopeId","data-v-8c458a98"]])}]},{path:"/feedback",name:"feedback",component:qn,meta:{title:"nav.feedback"}},{path:"/:catchAll(.*)",redirect:"/"}],ms=De({history:Ee(),routes:us});ms.beforeEach(((e,a,t)=>{e.meta.title&&La(e.meta.title),t()}));const gs=()=>{const e=Qa(),a=async e=>{await Oe((()=>{const a=document.getElementsByTagName("html")[0];e===ga.dark&&(a.classList.remove("light"),a.classList.add("dark")),e===ga.light&&(a.classList.remove("dark"),a.classList.add("light"))}))},t=async e=>{e===ga.system?await a(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?ga.dark:ga.light):await a(e)};O((()=>e.getters.getUserSettings.theme.mode),(async e=>{await t(e)}),{deep:!0,immediate:!0})},ps={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},hs=[S("path",{fill:"currentColor",d:"M288 320a224 224 0 1 0 448 0a224 224 0 1 0-448 0zm544 608H160a32 32 0 0 1-32-32v-96a160 160 0 0 1 160-160h448a160 160 0 0 1 160 160v96a32 32 0 0 1-32 32z"},null,-1)];var fs={name:"ep-user-filled",render:function(e,a){return y(),x("svg",ps,hs)}};const vs={id:"busuanzi_value_site_uv",class:"uv"},_s={id:"busuanzi_value_site_pv",class:"pv"},bs=v({__name:"site-count",props:{isuv:{type:Boolean,default:!1}},setup(e){const a=e,t=E(null),l=E(!1),i=_((()=>!0));return R((()=>{const e=document.createElement("script");e.async=!0,e.src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",t.value.appendChild(e),e.onload=()=>{const e=setTimeout((()=>{var i,n;i=t.value,n=a.isuv,i.querySelector(`.${n?"u":"p"}v`).innerText&&(l.value=!0),clearTimeout(e)}),1500)}})),(a,n)=>G((y(),x("span",{class:"site-count",ref_key:"siteCountDom",ref:t},[G(S("span",vs,null,512),[[ue,e.isuv]]),G(S("span",_s,null,512),[[ue,!e.isuv]]),X("+ "+W(a.$t("header.usage_count")),1)],512)),[[ue,l.value&&i.value]])}});const ys=e=>(Z("data-v-610233b2"),e=e(),ee(),e),ws={class:"header"},ks={class:"header-left"},Is=[ys((()=>S("div",{class:"logo"},[S("img",{src:"./assets/logo.206d082d.png",alt:"PicX"})],-1))),ys((()=>S("div",{class:"title"},"PicX",-1)))],xs={class:"website-count"},Ss={class:"header-right"},Ls={class:"user-info"},Ts={class:"avatar-box"},$s={class:"avatar flex-center"},Cs=["src","alt"],Ds={class:"personal-center-popover"},Es={class:"content-item"},Os={class:"flex-center"},Rs={class:"content-item"},As={class:"flex-center"};var Ns=mt(v({__name:"header-content",setup(e){const a=ie(),t=Qa(),l=_((()=>t.getters.getUserConfigInfo)).value,i=_((()=>t.getters.getUserSettings)).value,n=()=>{t.dispatch("USER_SETTINGS_PERSIST")},s=()=>{t.dispatch("LOGOUT"),a.push("/config"),document.body.click()},o=()=>{l.owner?window.open(`https://github.com/${l.owner}/${l.selectedRepo}`):a.push("/config")};return(e,t)=>{const r=bs,c=fs,d=L,u=tl,m=z,g=P,p=he,h=Re;return y(),x("header",ws,[S("div",ks,[S("div",{class:"brand",onClick:t[0]||(t[0]=e=>I(a).push("/"))},Is),S("div",xs,[$(r,{isuv:!1})])]),S("div",Ss,[S("div",Ls,[S("div",{class:"username",onClick:o},W(I(l).owner?I(l).owner:e.$t("header.notLogin")),1),$(h,{placement:"bottom-end",trigger:"click",width:"220rem","show-arrow":!1,"popper-style":{padding:"0"}},{reference:C((()=>{var e,a,t;return[S("div",Ts,[S("div",$s,[(null==(e=I(l))?void 0:e.avatarUrl)?(y(),x("img",{key:0,src:null==(a=I(l))?void 0:a.avatarUrl,alt:null==(t=I(l))?void 0:t.owner},null,8,Cs)):(y(),w(d,{key:1,class:"user-filled-icon"},{default:C((()=>[$(c)])),_:1}))]),$(d,{class:"caret-bottom-icon"},{default:C((()=>[$(u)])),_:1})])]})),default:C((()=>[S("ul",Ds,[S("li",Es,[S("span",Os,W(e.$t("header.language")),1),$(g,{size:"small",style:{width:"100rem"},modelValue:I(i).language,"onUpdate:modelValue":t[1]||(t[1]=e=>I(i).language=e),onChange:n},{default:C((()=>[$(m,{label:"中文简体",value:I(ha).zhCN},null,8,["value"]),$(m,{label:"中文繁體",value:I(ha).zhTW},null,8,["value"]),$(m,{label:"English",value:I(ha).en},null,8,["value"])])),_:1},8,["modelValue"])]),$(p,{style:{margin:"5px 0"}}),S("li",Rs,[S("span",As,W(e.$t("header.theme")),1),$(g,{size:"small",style:{width:"100rem"},modelValue:I(i).theme.mode,"onUpdate:modelValue":t[2]||(t[2]=e=>I(i).theme.mode=e),onChange:n},{default:C((()=>[$(m,{label:e.$t("settings.theme.system"),value:I(ga).system},null,8,["label","value"]),$(m,{label:e.$t("settings.theme.light"),value:I(ga).light},null,8,["label","value"]),$(m,{label:e.$t("settings.theme.dark"),value:I(ga).dark},null,8,["label","value"])])),_:1},8,["modelValue"])]),$(p,{style:{margin:"5px 0"}}),I(l).name?(y(),x("li",{key:0,class:"content-item",onClick:s},W(e.$t("header.logout")),1)):(y(),x("li",{key:1,class:"content-item",onClick:t[3]||(t[3]=e=>I(a).push("/config"))},W(e.$t("header.login")),1))])])),_:1})])])])}}}),[["__scopeId","data-v-610233b2"]]);const Ms={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Us=[S("path",{fill:"currentColor",d:"M389.44 768a96.064 96.064 0 0 1 181.12 0H896v64H570.56a96.064 96.064 0 0 1-181.12 0H128v-64h261.44zm192-288a96.064 96.064 0 0 1 181.12 0H896v64H762.56a96.064 96.064 0 0 1-181.12 0H128v-64h453.44zm-320-288a96.064 96.064 0 0 1 181.12 0H896v64H442.56a96.064 96.064 0 0 1-181.12 0H128v-64h133.44z"},null,-1)];var zs={name:"ep-operation",render:function(e,a){return y(),x("svg",Ms,Us)}};const Ps={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},js=[S("path",{fill:"currentColor",d:"M832 512a32 32 0 1 1 64 0v352a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h352a32 32 0 0 1 0 64H192v640h640V512z"},null,-1),S("path",{fill:"currentColor",d:"m469.952 554.24l52.8-7.552L847.104 222.4a32 32 0 1 0-45.248-45.248L477.44 501.44l-7.552 52.8zm422.4-422.4a96 96 0 0 1 0 135.808l-331.84 331.84a32 32 0 0 1-18.112 9.088L436.8 623.68a32 32 0 0 1-36.224-36.224l15.104-105.6a32 32 0 0 1 9.024-18.112l331.904-331.84a96 96 0 0 1 135.744 0z"},null,-1)];var Bs={name:"ep-edit",render:function(e,a){return y(),x("svg",Ps,js)}};const Vs={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Gs=[S("path",{fill:"currentColor",d:"M160 160v704h704V160H160zm-32-64h768a32 32 0 0 1 32 32v768a32 32 0 0 1-32 32H128a32 32 0 0 1-32-32V128a32 32 0 0 1 32-32z"},null,-1),S("path",{fill:"currentColor",d:"M384 288q64 0 64 64t-64 64q-64 0-64-64t64-64zM185.408 876.992l-50.816-38.912L350.72 556.032a96 96 0 0 1 134.592-17.856l1.856 1.472l122.88 99.136a32 32 0 0 0 44.992-4.864l216-269.888l49.92 39.936l-215.808 269.824l-.256.32a96 96 0 0 1-135.04 14.464l-122.88-99.072l-.64-.512a32 32 0 0 0-44.8 5.952L185.408 876.992z"},null,-1)];var Fs={name:"ep-picture",render:function(e,a){return y(),x("svg",Vs,Gs)}};const Hs={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Xs=[S("path",{fill:"currentColor",d:"M600.704 64a32 32 0 0 1 30.464 22.208l35.2 109.376c14.784 7.232 28.928 15.36 42.432 24.512l112.384-24.192a32 32 0 0 1 34.432 15.36L944.32 364.8a32 32 0 0 1-4.032 37.504l-77.12 85.12a357.12 357.12 0 0 1 0 49.024l77.12 85.248a32 32 0 0 1 4.032 37.504l-88.704 153.6a32 32 0 0 1-34.432 15.296L708.8 803.904c-13.44 9.088-27.648 17.28-42.368 24.512l-35.264 109.376A32 32 0 0 1 600.704 960H423.296a32 32 0 0 1-30.464-22.208L357.696 828.48a351.616 351.616 0 0 1-42.56-24.64l-112.32 24.256a32 32 0 0 1-34.432-15.36L79.68 659.2a32 32 0 0 1 4.032-37.504l77.12-85.248a357.12 357.12 0 0 1 0-48.896l-77.12-85.248A32 32 0 0 1 79.68 364.8l88.704-153.6a32 32 0 0 1 34.432-15.296l112.32 24.256c13.568-9.152 27.776-17.408 42.56-24.64l35.2-109.312A32 32 0 0 1 423.232 64H600.64zm-23.424 64H446.72l-36.352 113.088l-24.512 11.968a294.113 294.113 0 0 0-34.816 20.096l-22.656 15.36l-116.224-25.088l-65.28 113.152l79.68 88.192l-1.92 27.136a293.12 293.12 0 0 0 0 40.192l1.92 27.136l-79.808 88.192l65.344 113.152l116.224-25.024l22.656 15.296a294.113 294.113 0 0 0 34.816 20.096l24.512 11.968L446.72 896h130.688l36.48-113.152l24.448-11.904a288.282 288.282 0 0 0 34.752-20.096l22.592-15.296l116.288 25.024l65.28-113.152l-79.744-88.192l1.92-27.136a293.12 293.12 0 0 0 0-40.256l-1.92-27.136l79.808-88.128l-65.344-113.152l-116.288 24.96l-22.592-15.232a287.616 287.616 0 0 0-34.752-20.096l-24.448-11.904L577.344 128zM512 320a192 192 0 1 1 0 384a192 192 0 0 1 0-384zm0 64a128 128 0 1 0 0 256a128 128 0 0 0 0-256z"},null,-1)];var Ws={name:"ep-setting",render:function(e,a){return y(),x("svg",Hs,Xs)}};const qs={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Ks=[S("path",{fill:"currentColor",d:"M128 384v448h768V384H128zm-32-64h832a32 32 0 0 1 32 32v512a32 32 0 0 1-32 32H96a32 32 0 0 1-32-32V352a32 32 0 0 1 32-32zm64-128h704v64H160zm96-128h512v64H256z"},null,-1)];var Js={name:"ep-files",render:function(e,a){return y(),x("svg",qs,Ks)}};const Ys={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Qs=[S("path",{fill:"currentColor",d:"m174.72 855.68l135.296-45.12l23.68 11.84C388.096 849.536 448.576 864 512 864c211.84 0 384-166.784 384-352S723.84 160 512 160S128 326.784 128 512c0 69.12 24.96 139.264 70.848 199.232l22.08 28.8l-46.272 115.584zm-45.248 82.56A32 32 0 0 1 89.6 896l58.368-145.92C94.72 680.32 64 596.864 64 512C64 299.904 256 96 512 96s448 203.904 448 416s-192 416-448 416a461.056 461.056 0 0 1-206.912-48.384l-175.616 58.56z"},null,-1),S("path",{fill:"currentColor",d:"M512 563.2a51.2 51.2 0 1 1 0-102.4a51.2 51.2 0 0 1 0 102.4zm192 0a51.2 51.2 0 1 1 0-102.4a51.2 51.2 0 0 1 0 102.4zm-384 0a51.2 51.2 0 1 1 0-102.4a51.2 51.2 0 0 1 0 102.4z"},null,-1)];var Zs={name:"ep-chat-dot-round",render:function(e,a){return y(),x("svg",Ys,Qs)}};const eo=xe([{uuid:wa(),name:"nav.config",icon:Bs,isActive:!1,path:"/config",isShow:!0},{uuid:wa(),name:"nav.upload",icon:Wt,isActive:!1,path:"/upload",isShow:!0},{uuid:wa(),name:"nav.management",icon:Fs,isActive:!1,path:"/management",isShow:!0},{uuid:wa(),name:"nav.settings",icon:Ws,isActive:!1,path:"/settings",isShow:!0},{uuid:wa(),name:"nav.toolbox",icon:Js,isActive:!1,path:"/toolbox",isShow:!0},{uuid:wa(),name:"nav.feedback",icon:Zs,isActive:!1,path:"/feedback",isShow:!0}]);const ao={class:"nav"},to={class:"nav-list"},lo=["onClick"],io={class:"nav-content"},no={class:"nav-name"},so={class:"nav-item quick-actions flex-center"},oo={class:"nav-content"},ro={class:"nav-name"},co={class:"quick-actions-popover"};var uo=mt(v({__name:"nav-content",setup(e){const a=ie(),t=Qa(),l=_((()=>t.getters.getUserConfigInfo)).value,i=_((()=>t.getters.getUserSettings)).value,n=_((()=>{switch(i.elementPlusSize){case ca.small:return 22;case ca.large:return 30;default:return 26}})),s=e=>{eo.value.forEach((a=>{const t=a;return t.isActive=a.path===e||e.includes(a.path),t})),Ae(eo)},r=()=>{t.dispatch("USER_SETTINGS_PERSIST")};return O((()=>a.currentRoute.value),(e=>{s(e.path)})),O((()=>l.logined),(e=>{eo.value.forEach((a=>{switch(a.path){case"/management":case"/settings":a.isShow=e}}))}),{deep:!0,immediate:!0}),R((()=>{a.isReady().then((()=>{s(a.currentRoute.value.path)}))})),(e,t)=>{const s=L,c=zs,d=we,u=Re;return y(),x("aside",ao,[S("ul",to,[(y(!0),x(q,null,K(I(eo),((t,i)=>G((y(),x("li",{class:Q(["nav-item flex-center",{active:t.isActive}]),key:i+t.uuid,onClick:e=>(e=>{const{path:t}=e;if("/management"===t){if(""===l.selectedRepo)return o.warning("请选择一个仓库"),void a.push("/config");if(""===l.selectedDir)return o.warning("目录不能为空"),void a.push("/config")}a.push(t)})(t)},[S("div",io,[$(s,{size:n.value},{default:C((()=>[(y(),w($e(t.icon)))])),_:2},1032,["size"]),S("span",no,W(e.$t(t.name)),1)])],10,lo)),[[ue,t.isShow]]))),128))]),S("div",so,[$(u,{placement:"right-end",width:"en"===I(i).language?"230rem":"190rem",trigger:"click","show-arrow":!1,"popper-style":{padding:"0"}},{reference:C((()=>[S("div",oo,[$(s,{size:n.value},{default:C((()=>[$(c)])),_:1},8,["size"]),S("span",ro,W(e.$t("nav.actions")),1)])])),default:C((()=>[S("div",co,[$(d,{modelValue:I(i).watermark.enable,"onUpdate:modelValue":t[0]||(t[0]=e=>I(i).watermark.enable=e),class:"mb-2","active-text":e.$t("actions.watermark"),onChange:r},null,8,["modelValue","active-text"]),$(d,{modelValue:I(i).compress.enable,"onUpdate:modelValue":t[1]||(t[1]=e=>I(i).compress.enable=e),class:"mb-2","active-text":e.$t("actions.compress"),onChange:r},null,8,["modelValue","active-text"]),$(d,{modelValue:I(i).imageLinkFormat.enable,"onUpdate:modelValue":t[2]||(t[2]=e=>I(i).imageLinkFormat.enable=e),class:"mb-2","active-text":e.$t("actions.transform")+I(i).imageLinkFormat.selected,onChange:r},null,8,["modelValue","active-text"])])])),_:1},8,["width"])])])}}}),[["__scopeId","data-v-5951a7aa"]]);const mo={class:"main-container"},go={class:"top-container"},po={class:"bottom-container"},ho={class:"bottom-content"},fo={class:"left"},vo={class:"right"};var _o=mt(v({__name:"main-container",setup:e=>(R((()=>{gs()})),(e,a)=>{const t=Te("router-view");return y(),x("main",mo,[S("div",go,[$(Ns)]),S("div",po,[S("div",ho,[S("div",fo,[$(uo)]),S("div",vo,[$(t)])])])])})}),[["__scopeId","data-v-c5c7351e"]]);const bo=v({__name:"App",setup(e){const a=D(),t=Qa(),l=_((()=>t.getters.getUserSettings)).value,i=E(ca.default),n=E(Me),r=e=>{e<=600?(null==t||t.dispatch("SET_USER_SETTINGS",{elementPlusSize:ca.small}),i.value=ca.small):e<=900?(null==t||t.dispatch("SET_USER_SETTINGS",{elementPlusSize:ca.default}),i.value=ca.default):(null==t||t.dispatch("SET_USER_SETTINGS",{elementPlusSize:ca.large}),i.value=ca.large)},c=e=>{e===ha.zhCN?(n.value=Me,a.proxy.$i18n.locale="zh-CN"):e===ha.zhTW?(n.value=Ue,a.proxy.$i18n.locale="zh-TW"):e===ha.en?(n.value=ze,a.proxy.$i18n.locale="en"):(n.value=Me,a.proxy.$i18n.locale="zh-CN"),La(ms.currentRoute.value.meta.title)},d=()=>{c(l.language),(async()=>{try{const e=await s.get("https://api.ipify.org?format=json"),a=await s.get(`https://ipapi.co/${e.data.ip}/country/`);return Promise.resolve(a.data)}catch(e){return Promise.resolve("CN")}})().then((e=>{var i,n,s,r,d,u,m;const g=(e=>"CN"===e?ha.zhCN:"HK"===e||"TW"===e||"MO"===e?ha.zhTW:ha.en)(e);if(g!==l.language){const l=null==(i=null==a?void 0:a.proxy)?void 0:i.$t("confirm",g),p=null==(n=null==a?void 0:a.proxy)?void 0:n.$t("cancel",g),h=null==(d=null==a?void 0:a.proxy)?void 0:d.$t("toggle-language-msg",g,{region:null==(s=null==a?void 0:a.proxy)?void 0:s.$t(`region.${e}`,g),language:null==(r=null==a?void 0:a.proxy)?void 0:r.$t(`language.${g}`,g)}),f=o({customClass:"toggle-language-message",duration:0,offset:20,message:`<div class="content-box">\n                    <span class="msg">${h}</span>\n                    <spna class="btn-box">\n                      <span class="confirm btn">${l}</span>\n                      <span class="cancel btn">${p}</span>\n                    </spna>\n                  </div>`,dangerouslyUseHTMLString:!0});null==(u=document.querySelector(".toggle-language-message .content-box .confirm"))||u.addEventListener("click",(()=>{c(g),t.dispatch("SET_USER_SETTINGS",{language:g}),f.close()})),null==(m=document.querySelector(".toggle-language-message .content-box .cancel"))||m.addEventListener("click",(()=>{f.close()}))}}))},u=()=>{r(window.innerWidth),window.addEventListener("resize",((e,a=500)=>{let t,l;return function(...i){l=i,t||(t=setTimeout((()=>{e(...l),t=void 0}),a))}})((e=>{r(e.target.innerWidth)}),600)),gs(),d()};return O((()=>l.language),(e=>{c(e)})),R((()=>{u()})),(e,a)=>(y(),w(I(Ne),{size:i.value,"z-index":3e3,locale:n.value},{default:C((()=>[$(_o)])),_:1},8,["size","locale"]))}});const yo="custom-contextmenu-container";let wo=null,ko=!1;const Io={mounted(e,a){e.addEventListener("contextmenu",(e=>{const{dir:t,type:l,img:i}=a.value;e.preventDefault(),e.stopPropagation();const n=_((()=>Ja.getters.getUserViewDir)).value,s=t?`${"/"===n?"":`${n}/`}${t}`:n;wo=document.querySelector(`.${yo}`),wo||(wo=document.createElement("ul"),wo.setAttribute("class",yo),wo.style.position="fixed",wo.style.zIndex="1000",wo.innerHTML=`<li class="custom-contextmenu-item upload-image"></li><li class="custom-contextmenu-item copy-link">${ba.global.t("copy_link")}</li>`,document.body.appendChild(wo));const o=null==wo?void 0:wo.querySelector(".upload-image"),r=null==wo?void 0:wo.querySelector(".copy-link");l===va.img?(r.style.display="block",o.innerHTML=ba.global.t("management.contextmenu_1")):(r.style.display="none",o.innerHTML=ba.global.t("management.contextmenu_2",{dir:"/"===s?ba.global.t("management.contextmenu_3"):s}));let c=e.clientX,d=e.clientY;const u=wo.clientWidth,m=wo.clientHeight,g=document.documentElement.clientWidth,p=document.documentElement.clientHeight;u+c>g&&(c=g-u-6),m+d>p&&(d=p-m-6),wo.style.top=`${d}px`,wo.style.left=`${c}px`,ko||(ko=!0,null==o||o.addEventListener("click",(async()=>{const e="/"===s?oa.rootDir:oa.repoDir,a="/"===s?[]:s.split("/");await Ja.dispatch("SET_USER_CONFIG_INFO",{dirMode:e,selectedDir:s,selectedDirList:a}),await ms.push("/upload")})),null==r||r.addEventListener("click",(async()=>{const e=_((()=>Ja.getters.getUserConfigInfo)).value,a=_((()=>Ja.getters.getUserSettings)).value;Ba(i,e,a)})));const h=()=>{wo&&(document.removeEventListener("click",h),document.body.removeChild(wo),wo=null,ko=!1)};document.addEventListener("click",h)}))}},xo=Pe(bo);xo.directive("contextmenu",Io),xo.use(ms).use(Ja,Ya).use(ba).mount("#app");
