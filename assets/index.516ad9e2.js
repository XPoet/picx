var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,i=(t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,l=(e,t)=>{for(var a in t||(t={}))o.call(t,a)&&i(e,a,t[a]);if(n)for(var a of n(t))s.call(t,a)&&i(e,a,t[a]);return e},r=(e,n)=>t(e,a(n));import{_ as d,a as u,b as c,c as g,d as p,e as m,f,g as I,h,i as _,j as v,k as C,l as L,m as b,n as D,o as U,p as A,q as S,r as E,s as k,t as O,u as T,v as w,w as y,x as R,y as M,z as P,A as G,B as x,C as N,D as V,E as j,F as $,G as z,H as F,I as X,J as B,K as H,L as W,M as Y,N as J,O as q,P as K,Q,R as Z,S as ee,T as te,U as ae,V as ne,W as oe,X as se,Y as ie,Z as le,$ as re}from"./vendor.4c6efeb2.js";let de;const ue={},ce=function(e,t){if(!t||0===t.length)return e();if(void 0===de){const e=document.createElement("link").relList;de=e&&e.supports&&e.supports("modulepreload")?"modulepreload":"preload"}return Promise.all(t.map((e=>{if((e=`./${e}`)in ue)return;ue[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const n=document.createElement("link");return n.rel=t?"stylesheet":de,t||(n.as="script",n.crossOrigin=""),n.href=e,document.head.appendChild(n),t?new Promise(((e,t)=>{n.addEventListener("load",e),n.addEventListener("error",t)})):void 0}))).then((()=>e()))};const ge={state:{name:"dirImageListModule",dirImageList:(()=>{const e=localStorage.getItem("PICX_MANAGEMENT");return e?JSON.parse(e):[]})()},mutations:{},actions:{DIR_IMAGE_LIST_ADD_IMAGE({state:e,dispatch:t},a){const n=e.dirImageList.find((e=>e.dir===a.dir));n&&(n.imageList.push(a),t("DIR_IMAGE_LIST_PERSIST"))},DIR_IMAGE_LIST_ADD_IMAGE_LIST({state:e,dispatch:t},a){const n=e.dirImageList.find((e=>e.dir===a.dir));n?n.imageList=a.imageList:e.dirImageList.unshift(a),t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_ADD_DIR({state:e,dispatch:t},a){if(!e.dirImageList.some((e=>e.dir===a))){const n={dir:a,imageList:[]};"/"===a?e.dirImageList.unshift(n):e.dirImageList.push(n),t("DIR_IMAGE_LIST_PERSIST")}},DIR_IMAGE_LIST_REMOVE_DIR({state:e,dispatch:t},a){if(e.dirImageList.some((e=>e.dir===a))){const n=e.dirImageList.findIndex((e=>e.dir===a));e.dirImageList.splice(n,1),t("DIR_IMAGE_LIST_PERSIST")}},DIR_IMAGE_LIST_REMOVE({state:e,dispatch:t},a){if(e.dirImageList.length>0){const n=e.dirImageList.find((e=>e.dir===a.dir));if(n){const e=n.imageList.findIndex((e=>e.uuid===a.uuid));-1!==e&&(n.imageList.splice(e,1),0===n.imageList.length&&(t("DIR_IMAGE_LIST_REMOVE_DIR",n.dir),t("USER_CONFIG_INFO_REMOVE_DIR",n.dir)),t("DIR_IMAGE_LIST_PERSIST"))}}},DIR_IMAGE_LIST_PERSIST({state:e}){localStorage.setItem("PICX_MANAGEMENT",JSON.stringify(e.dirImageList))},DIR_IMAGE_LOGOUT({state:e}){e.dirImageList=[],localStorage.removeItem("PICX_MANAGEMENT")}},getters:{getDirImageList:e=>e.dirImageList}},pe={state:{curImgBase64Url:"",curImgUuid:"",list:[],uploadedNumber:0},actions:{TO_UPLOAD_IMAGE_LIST_ADD({state:e},t){e.list.unshift(t)},TO_UPLOAD_IMAGE_SET_CURRENT({state:e},{uuid:t,base64Url:a}){e.curImgUuid=t,e.curImgBase64Url=a},TO_UPLOAD_IMAGE_UPLOADED({state:e}){e.uploadedNumber+=1},TO_UPLOAD_IMAGE_LIST_REMOVE({state:e},t){if(e.list.length>0){const a=e.list.findIndex((e=>e.uuid===t));if(-1!==a&&e.list.splice(a,1),0===e.list.length)e.curImgBase64Url="",e.uploadedNumber=0;else if(e.curImgUuid===t){const t=e.list[0];e.curImgBase64Url=t.imgData.base64Url,e.curImgUuid=t.uuid}}},TO_UPLOAD_IMAGE_LIST_FAIL({state:e}){if(e.list.length>0){const t=e.list.filter((e=>100!==e.uploadStatus.progress));t.length>0&&(e.list=t,e.uploadedNumber=0,e.curImgBase64Url=t[0].imgData.base64Url)}},TO_UPLOAD_IMAGE_CLEAN_URL({state:e}){e.curImgBase64Url=""},TO_UPLOAD_IMAGE_CLEAN_LIST({state:e}){e.list=[]},TO_UPLOAD_IMAGE_CLEAN_UPLOADED_NUMBER({state:e}){e.uploadedNumber=0},TO_UPLOAD_IMAGE_LOGOUT({state:e}){e.curImgBase64Url="",e.list=[],e.uploadedNumber=0}},getters:{getToUploadImageList:e=>e.list,getToUploadImage:e=>e}},me={state:{uploadedImageList:(()=>{const e=sessionStorage.getItem("PICX_UPLOADED");return e?JSON.parse(e):[]})()},mutations:{},actions:{UPLOADED_LIST_ADD({state:e,dispatch:t},a){e.uploadedImageList.unshift(a),t("UPLOADED_LIST_PERSIST")},UPLOADED_LIST_REMOVE({state:e,dispatch:t},a){if(e.uploadedImageList.length>0){const n=e.uploadedImageList.findIndex((e=>e.uuid===a.uuid));-1!==n&&(e.uploadedImageList.splice(n,1),t("UPLOADED_LIST_PERSIST"))}},UPLOADED_LIST_PERSIST({state:e}){sessionStorage.setItem("PICX_UPLOADED",JSON.stringify(e.uploadedImageList))},UPLOADED_LIST_LOGOUT({state:e}){e.uploadedImageList=[],sessionStorage.removeItem("PICX_UPLOADED")}},getters:{getUploadedImageList:e=>e.uploadedImageList}},fe=e=>{const t=Object.prototype.toString.call(e).split(" ")[1];return t.substring(0,t.length-1).toLowerCase()},Ie=e=>{for(let t in e)switch(fe(e[t])){case"object":Ie(e[t]);break;case"string":e[t]="";break;case"array":e[t]=[];break;case"number":e[t]=0;break;case"boolean":e[t]=!1}},he=O({modules:{dirImageListModule:ge,toUploadImageModule:pe,uploadedImageListModule:me,userConfigInfoModule:{state:{userConfigInfo:(()=>{const e=localStorage.getItem("PICX_CONFIG");return e?JSON.parse(e):{token:"",owner:"",email:"",name:"",avatarUrl:"",selectedRepos:"",reposList:[],selectedBranch:"",dirMode:"",selectedDir:"",dirList:[],loggingStatus:!1}})()},actions:{SET_USER_CONFIG_INFO({state:e},t){for(const a in t)e.userConfigInfo.hasOwnProperty(a)&&(e.userConfigInfo[a]=t[a])},USER_CONFIG_INFO_ADD_DIR({state:e,dispatch:t},a){e.userConfigInfo.dirList.some((e=>e.value===a))||(e.userConfigInfo.dirList.push({label:a,value:a}),t("USER_CONFIG_INFO_PERSIST"))},USER_CONFIG_INFO_REMOVE_DIR({state:e,dispatch:t},a){const{dirList:n}=e.userConfigInfo;if(n.some((e=>e.value===a))){const e=n.findIndex((e=>e.value===a));n.splice(e,1),t("USER_CONFIG_INFO_PERSIST")}},USER_CONFIG_INFO_PERSIST({state:e}){e.userConfigInfo.selectedDir=e.userConfigInfo.selectedDir.replace(/\s+/g,"-"),localStorage.setItem("PICX_CONFIG",JSON.stringify(e.userConfigInfo))},USER_CONFIG_INFO_LOGOUT({state:e}){Ie(e.userConfigInfo),localStorage.removeItem("PICX_CONFIG")}},getters:{getUserLoggingStatus:e=>e.userConfigInfo.loggingStatus,getUserConfigInfo:e=>e.userConfigInfo}},imageViewerModule:{state:{imageViewer:{url:"",isShow:!1}},mutations:{IMAGE_VIEWER(e,{url:t,isShow:a}){e.imageViewer.url=t,e.imageViewer.isShow=a},IMAGE_VIEWER_LOGOUT(e){e.imageViewer.isShow=!1,e.imageViewer.url=""}},actions:{},getters:{getImageViewer:e=>e.imageViewer}},uploadAreaActiveModule:{state:{uploadAreaActive:!1},mutations:{CHANGE_UPLOAD_AREA_ACTIVE(e,t){e.uploadAreaActive=t},UPLOAD_AREA_ACTIVE_LOGOUT(e){e.uploadAreaActive=!1}},actions:{},getters:{getUploadAreaActive:e=>e.uploadAreaActive}},uploadSettingsModule:{state:{uploadSettings:{isSetMaxSize:!1,compressSize:200}},mutations:{UPLOAD_SETTINGS_LOGOUT(e){e.uploadSettings.isSetMaxSize=!1,e.uploadSettings.compressSize=200}},actions:{},getters:{getUploadSettings:e=>e.uploadSettings}}},state:{rootName:"root"},mutations:{},actions:{LOGOUT({dispatch:e,commit:t}){e("DIR_IMAGE_LOGOUT"),e("TO_UPLOAD_IMAGE_LOGOUT"),e("UPLOADED_LIST_LOGOUT"),e("USER_CONFIG_INFO_LOGOUT"),t("IMAGE_VIEWER_LOGOUT"),t("UPLOAD_AREA_ACTIVE_LOGOUT"),t("UPLOAD_SETTINGS_LOGOUT")}},getters:{}}),_e=Symbol("vue-store");function ve(){return T(_e)}var Ce,Le;(Le=Ce||(Ce={})).autoDir="autoDir",Le.newDir="newDir",Le.rootDir="rootDir",Le.reposDir="reposDir";const be=w.create({baseURL:"https://api.github.com",timeout:3e5});be.interceptors.request.use((e=>{const t=window.localStorage.getItem("accessToken");return t&&(e.headers.common.Authorization=t),e}),(e=>Promise.reject(e))),be.interceptors.response.use((e=>e),(e=>{if(e.response&&e.response.data){const t=e.response.status,a=e.response.data.message;y.error(`Code: ${t}, Message: ${a}`),console.error("[PicX Error]",e.response)}else y.error(`${e}`);return e.response}));class De{static zerofill(e){return e<10?"0"+e:e}static getYyyyMmDd(e=Date.now()){const t=new Date(e),a=t.getFullYear(),n=t.getMonth()+1,o=t.getDate();return`${a}${this.zerofill(n)}${this.zerofill(o)}`}static formatTimestamp(e=Date.now()){const t=new Date(e);let a=t.getFullYear(),n=t.getMonth()+1,o=t.getDate(),s=t.getHours(),i=t.getMinutes(),l=t.getSeconds();return`${a}-${this.zerofill(n)}-${this.zerofill(o)} ${this.zerofill(s)}:${this.zerofill(i)}:${this.zerofill(l)}`}}var Ue=R({name:"config",setup(){const e=M(),t=ve(),a=P({loading:!1,dirLoading:!1,formLabelWidth:"70px",userConfigInfo:G((()=>t.getters.getUserConfigInfo)).value,loggingStatus:G((()=>t.getters.getUserConfigInfo)).value,getUserInfo(){this.userConfigInfo.token?(this.loading=!0,be.get("/user",{headers:{"Content-Type":"application/json",Authorization:`token ${this.userConfigInfo.token}`}}).then((e=>{e&&200===e.status?(this.saveUserInfo(e),this.getReposList(e.data.repos_url)):this.loading=!1}))):y.warning("Token ä¸èƒ½ä¸ºç©ºï¼")},saveUserInfo(e){this.userConfigInfo.loggingStatus=!0,this.userConfigInfo.owner=e.data.login,this.userConfigInfo.name=e.data.name,this.userConfigInfo.email=e.data.email,this.userConfigInfo.avatarUrl=e.data.avatar_url,this.persistUserConfigInfo()},getReposList(e){be.get(e,{headers:{"Content-Type":"application/json",Authorization:`token ${this.userConfigInfo.token}`}}).then((e=>{if(200===e.status&&e.data.length>0){this.userConfigInfo.reposList=[];for(const t of e.data)t.fork||this.userConfigInfo.reposList.push({value:t.name,label:t.name,desc:t.description});this.loading=!1,this.persistUserConfigInfo()}}))},innerSelectRepos(e){a.getBranchList(e),a.persistUserConfigInfo()},getBranchList(e){this.dirLoading=!0,be.get(`/repos/${this.userConfigInfo.owner}/${e}/branches`,{headers:{"Content-Type":"application/json",Authorization:`token ${this.userConfigInfo.token}`}}).then((t=>{if(t&&200===t.status){this.dirLoading=!1;const a="master",n="main";t.data.length>0?(t.data.some((e=>e.name===a))?this.userConfigInfo.selectedBranch=a:t.data.some((e=>e.name===n))&&(this.userConfigInfo.selectedBranch=n),this.getDirList(e)):(this.userConfigInfo.selectedBranch=a,this.userConfigInfo.dirMode=Ce.newDir,this.userConfigInfo.selectedDir="",this.userConfigInfo.dirList=[])}}))},getDirList(e){this.dirLoading=!0,be.get(`/repos/${this.userConfigInfo.owner}/${e}/contents`,{headers:{"Content-Type":"application/json",Authorization:`token ${this.userConfigInfo.token}`}}).then((e=>{if(e&&200===e.status&&e.data.length>0){this.userConfigInfo.dirList=[{value:"/",label:"/"}];for(const t of e.data)"dir"===t.type&&this.userConfigInfo.dirList.push({value:t.name,label:t.name});this.persistUserConfigInfo()}this.dirLoading=!1}))},innerDirModeChange(e){switch(e){case Ce.rootDir:this.userConfigInfo.selectedDir="/";break;case Ce.autoDir:this.userConfigInfo.selectedDir=De.getYyyyMmDd();break;case Ce.newDir:case Ce.reposDir:this.userConfigInfo.selectedDir="";break;default:this.userConfigInfo.selectedDir="/"}this.persistUserConfigInfo()},persistUserConfigInfo(){t.dispatch("USER_CONFIG_INFO_PERSIST")},reset(){this.loading=!1,this.dirLoading=!1,t.dispatch("LOGOUT")},innerGoUpload(){const{selectedDir:t,dirMode:a}=this.userConfigInfo;let n="ç›®å½•ä¸èƒ½ä¸ºç©ºï¼";if(""===t){switch(a){case Ce.newDir:n="è¯·åœ¨è¾“å…¥æ¡†è¾“å…¥ä¸€ä¸ªæ–°ç›®å½•ï¼";break;case Ce.reposDir:n=`è¯·é€‰æ‹© ${this.userConfigInfo.selectedRepos} ä»“åº“ä¸‹çš„ä¸€ä¸ªç›®å½•ï¼`;break;default:n="è¯·åœ¨è¾“å…¥æ¡†è¾“å…¥ä¸€ä¸ªæ–°ç›®å½•ï¼"}y.warning(n)}else e.push("/upload")}});return x((()=>a.loggingStatus),(e=>{e||(a.loading=!1,a.dirLoading=!1)})),r(l({},N(a)),{dirModeChange:e=>{a.innerDirModeChange(e)},selectRepos:e=>{a.innerSelectRepos(e)},goUpload:()=>{a.innerGoUpload()}})}});const Ae=q("data-v-64c41405");V("data-v-64c41405");const Se={class:"page-container config-page-container"},Ee=Y(" ç¡®è®¤ Token "),ke=Y("æ–°å»ºç›®å½•"),Oe=Y("æ ¹ç›®å½•"),Te=Y("è‡ªåŠ¨ç›®å½•"),we=Y(" é‡ç½® "),ye=Y("å®Œæˆé…ç½® ");j();const Re=Ae(((e,t,a,n,o,s)=>{const i=K("el-input"),l=K("el-form-item"),r=K("el-button"),d=K("el-form"),u=K("el-option"),c=K("el-select"),g=K("el-radio"),p=K("el-tooltip"),m=K("el-radio-group"),f=Q("loading");return $(),z("div",Se,[F(d,{"label-width":e.formLabelWidth,"label-position":"right",class:"config-form"},{default:Ae((()=>[F(l,{label:"Token"},{default:Ae((()=>[F(i,{modelValue:e.userConfigInfo.token,"onUpdate:modelValue":t[1]||(t[1]=t=>e.userConfigInfo.token=t),clearable:"",autofocus:!e.userConfigInfo.token},null,8,["modelValue","autofocus"])])),_:1}),F(l,{class:"operation"},{default:Ae((()=>[F(r,{plain:"",size:"small",type:"primary","native-type":"submit",onClick:t[2]||(t[2]=t=>e.getUserInfo())},{default:Ae((()=>[Ee])),_:1})])),_:1})])),_:1},8,["label-width"]),e.userConfigInfo.token?X(($(),z(d,{key:0,"label-width":e.formLabelWidth,"label-position":"right","element-loading-text":"åŠ è½½ä¸­..."},{default:Ae((()=>[e.userConfigInfo.owner?($(),z(l,{key:0,label:"ç”¨æˆ·å"},{default:Ae((()=>[F(i,{modelValue:e.userConfigInfo.owner,"onUpdate:modelValue":t[3]||(t[3]=t=>e.userConfigInfo.owner=t),readonly:""},null,8,["modelValue"])])),_:1})):B("",!0),e.userConfigInfo.email?($(),z(l,{key:1,label:"é‚®ç®±"},{default:Ae((()=>[F(i,{modelValue:e.userConfigInfo.email,"onUpdate:modelValue":t[4]||(t[4]=t=>e.userConfigInfo.email=t),readonly:""},null,8,["modelValue"])])),_:1})):B("",!0),e.userConfigInfo.reposList.length?($(),z(l,{key:2,label:"é€‰æ‹©ä»“åº“"},{default:Ae((()=>[F(c,{modelValue:e.userConfigInfo.selectedRepos,"onUpdate:modelValue":t[5]||(t[5]=t=>e.userConfigInfo.selectedRepos=t),filterable:"",style:{width:"100%"},placeholder:"è¯·é€‰æ‹©å›¾åºŠä»“åº“...",onChange:e.selectRepos},{default:Ae((()=>[($(!0),z(H,null,W(e.userConfigInfo.reposList,((e,t)=>($(),z(u,{key:t,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1})):B("",!0)])),_:1},8,["label-width"])),[[f,e.loading]]):B("",!0),e.userConfigInfo.selectedRepos?X(($(),z(d,{key:1,"label-width":e.formLabelWidth,"label-position":"right","element-loading-text":"åŠ è½½ä¸­..."},{default:Ae((()=>[e.userConfigInfo.reposList.length&&e.userConfigInfo.selectedRepos?($(),z(l,{key:0,label:"ç›®å½•æ–¹å¼"},{default:Ae((()=>[F(m,{modelValue:e.userConfigInfo.dirMode,"onUpdate:modelValue":t[6]||(t[6]=t=>e.userConfigInfo.dirMode=t),onChange:e.dirModeChange},{default:Ae((()=>[F(p,{content:"æ‰‹åŠ¨è¾“å…¥ä¸€ä¸ªæ–°ç›®å½•",placement:"top"},{default:Ae((()=>[F(g,{label:"newDir"},{default:Ae((()=>[ke])),_:1})])),_:1}),F(p,{content:"å›¾ç‰‡å­˜å‚¨åœ¨ "+e.userConfigInfo.selectedBranch+" åˆ†æ”¯çš„æ ¹ç›®å½•ä¸‹",placement:"top"},{default:Ae((()=>[F(g,{label:"rootDir"},{default:Ae((()=>[Oe])),_:1})])),_:1},8,["content"]),F(p,{content:"æ ¹æ®æ—¥æœŸè‡ªåŠ¨åˆ›å»ºæ ¼å¼ YYYYMMDD çš„ç›®å½•",placement:"top"},{default:Ae((()=>[F(g,{label:"autoDir"},{default:Ae((()=>[Te])),_:1})])),_:1}),e.userConfigInfo.dirList.length?($(),z(p,{key:0,content:"é€‰æ‹© "+e.userConfigInfo.selectedRepos+" ä»“åº“ä¸‹çš„ä¸€ä¸ªç›®å½•",placement:"top"},{default:Ae((()=>[F(g,{label:"reposDir"},{default:Ae((()=>[Y("é€‰æ‹© "+J(e.userConfigInfo.selectedRepos)+" ä»“åº“ç›®å½•",1)])),_:1})])),_:1},8,["content"])):B("",!0)])),_:1},8,["modelValue","onChange"])])),_:1})):B("",!0),"autoDir"===e.userConfigInfo.dirMode?($(),z(l,{key:1,label:"è‡ªåŠ¨ç›®å½•"},{default:Ae((()=>[F(i,{modelValue:e.userConfigInfo.selectedDir,"onUpdate:modelValue":t[7]||(t[7]=t=>e.userConfigInfo.selectedDir=t),readonly:""},null,8,["modelValue"])])),_:1})):B("",!0),"rootDir"===e.userConfigInfo.dirMode?($(),z(l,{key:2,label:"æ ¹ç›®å½•"},{default:Ae((()=>[F(i,{modelValue:e.userConfigInfo.selectedDir,"onUpdate:modelValue":t[8]||(t[8]=t=>e.userConfigInfo.selectedDir=t),readonly:""},null,8,["modelValue"])])),_:1})):B("",!0),"newDir"===e.userConfigInfo.dirMode?($(),z(l,{key:3,label:"æ–°å»ºç›®å½•"},{default:Ae((()=>[F(i,{modelValue:e.userConfigInfo.selectedDir,"onUpdate:modelValue":t[9]||(t[9]=t=>e.userConfigInfo.selectedDir=t),onInput:t[10]||(t[10]=t=>e.persistUserConfigInfo()),clearable:"",placeholder:"è¯·è¾“å…¥æ–°å»ºçš„ç›®å½•..."},null,8,["modelValue"])])),_:1})):B("",!0),e.userConfigInfo.dirList.length&&"reposDir"===e.userConfigInfo.dirMode?($(),z(l,{key:4,label:"é€‰æ‹©ç›®å½•"},{default:Ae((()=>[F(c,{modelValue:e.userConfigInfo.selectedDir,"onUpdate:modelValue":t[11]||(t[11]=t=>e.userConfigInfo.selectedDir=t),filterable:"",style:{width:"100%"},placeholder:"è¯·é€‰æ‹©ç›®å½•...",onChange:e.persistUserConfigInfo},{default:Ae((()=>[($(!0),z(H,null,W(e.userConfigInfo.dirList,(e=>($(),z(u,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1})):B("",!0)])),_:1},8,["label-width"])),[[f,e.dirLoading]]):B("",!0),F(d,{"label-width":e.formLabelWidth},{default:Ae((()=>[F(l,{class:"operation"},{default:Ae((()=>[e.userConfigInfo.owner?($(),z(r,{key:0,plain:"",size:"small",onClick:t[12]||(t[12]=t=>e.reset())},{default:Ae((()=>[we])),_:1})):B("",!0),e.userConfigInfo.selectedRepos?($(),z(r,{key:1,plain:"",size:"small",type:"success",onClick:e.goUpload},{default:Ae((()=>[ye])),_:1},8,["onClick"])):B("",!0)])),_:1})])),_:1},8,["label-width"])])}));var Me,Pe;Ue.render=Re,Ue.__scopeId="data-v-64c41405",(Pe=Me||(Me={})).gh="gh",Pe.md_gh="md_gh",Pe.cdn="cdn",Pe.md_cdn="md_cdn";var Ge=R({name:"copy-external-link",props:{imgObj:{type:Object,default:()=>({})}},setup:e=>({copyExternalLink:function(t){let a="",n="";switch(t){case Me.gh:e.imgObj.is_transform_md?(a=e.imgObj.md_gh_url,n="Markdown æ ¼å¼çš„ GitHub"):(a=e.imgObj.github_url,n="GitHub");break;case Me.cdn:e.imgObj.is_transform_md?(a=e.imgObj.md_cdn_url,n="Markdown æ ¼å¼çš„ CDN"):(a=e.imgObj.cdn_url,n="CDN")}let o=document.querySelector(".temp-external-link");o||(o=document.createElement("textarea"),o.setAttribute("class","temp-external-link"),o.style.position="absolute",o.style.top="-99999px",o.style.left="-99999px",document.body.appendChild(o)),o.value=a,o.select(),document.execCommand("copy"),y.success(`${n} å¤–é“¾å¤åˆ¶æˆåŠŸï¼`)},transformMD:function(){e.imgObj.is_transform_md=!e.imgObj.is_transform_md},externalLinkType:Me})});const xe=q("data-v-36636aee");V("data-v-36636aee");const Ne={class:"copy-external-link-box"};j();const Ve=xe(((e,t,a,n,o,s)=>{const i=K("el-tooltip");return $(),z("div",Ne,[F(i,{content:e.imgObj.is_transform_md?"å·²è½¬æ¢ Markdown æ ¼å¼":"è½¬æ¢ Markdown æ ¼å¼",placement:"top"},{default:xe((()=>[F("span",{class:["btn-item transform-btn",{"is-transform":e.imgObj.is_transform_md}],onClick:t[1]||(t[1]=t=>e.transformMD())}," MD ",2)])),_:1},8,["content"]),F(i,{content:"ç‚¹å‡»å¤åˆ¶ GitHub å¤–é“¾",placement:"top"},{default:xe((()=>[F("span",{class:"btn-item copy-url",onClick:t[2]||(t[2]=t=>e.copyExternalLink(e.externalLinkType.gh))}," GitHub ")])),_:1}),F(i,{content:"ç‚¹å‡»å¤åˆ¶ CDN å¤–é“¾",placement:"top"},{default:xe((()=>[F("span",{class:"btn-item copy-url",onClick:t[3]||(t[3]=t=>e.copyExternalLink(e.externalLinkType.cdn))}," CDN ")])),_:1})])}));Ge.render=Ve,Ge.__scopeId="data-v-36636aee";var je=R({name:"ImageCard",components:{copyExternalLink:Ge},props:{imageObj:{type:Object,default:()=>{}},isUploaded:{type:Boolean,default:!1}},setup(){const e=ve(),t=P({isEnableDeleted:!0,userConfigInfo:G((()=>e.getters.getUserConfigInfo)).value,deleteImage(t){var a,n,o,s,i;t.deleting=!0,be.delete(`/repos/${null==(a=this.userConfigInfo)?void 0:a.owner}/${null==(n=this.userConfigInfo)?void 0:n.selectedRepos}/contents/${t.path}`,{headers:{"Content-Type":"application/json",Authorization:`token ${null==(o=this.userConfigInfo)?void 0:o.token}`},data:{owner:null==(s=this.userConfigInfo)?void 0:s.owner,repo:null==(i=this.userConfigInfo)?void 0:i.selectedRepos,path:t.path,message:"delete pictures via PicX(https://github.com/XPoet/picx)",sha:t.sha}}).then((a=>{console.log("delete res: ",a),a&&200===a.status?(t.deleting=!1,y.success("åˆ é™¤æˆåŠŸï¼"),e.dispatch("UPLOADED_LIST_REMOVE",t),e.dispatch("DIR_IMAGE_LIST_REMOVE",t)):t.deleting=!1}))},imageView(t){e.commit("IMAGE_VIEWER",{isShow:!0,url:t.cdn_url})}});return l({},N(t))}});const $e=q("data-v-e60c1fc8");V("data-v-e60c1fc8");const ze={class:"image-card","element-loading-text":"åˆ é™¤ä¸­...","element-loading-background":"rgba(0, 0, 0, 0.6)"},Fe={class:"image-box"},Xe={class:"info-box"},Be={class:"image-info"},He={class:"filename"},We={class:"image-operation"},Ye={class:"delete"};j();const Je=$e(((e,t,a,n,o,s)=>{const i=K("el-tooltip"),l=K("copyExternalLink"),r=Q("loading");return X(($(),z("div",ze,[F("div",Fe,[F("img",{src:e.imageObj.cdn_url,onClick:t[1]||(t[1]=t=>e.imageView(e.imageObj))},null,8,["src"])]),F("div",Xe,[F("div",Be,[F("div",He,J(e.imageObj.name),1),F("div",We,[F("div",Ye,[F(i,{content:"åˆ é™¤",placement:"top"},{default:$e((()=>[F("i",{class:"el-icon-delete",onClick:t[2]||(t[2]=t=>e.deleteImage(e.imageObj))})])),_:1})]),F("div",null,[F(l,{"img-obj":e.imageObj},null,8,["img-obj"])])])])])],512)),[[r,e.imageObj.deleting]])}));je.render=Je,je.__scopeId="data-v-e60c1fc8";const qe=()=>Number(Math.random().toString().substr(2,5)+Date.now()).toString(36),Ke=e=>{const t=e.lastIndexOf("."),a=e.substr(0,t),n=e.substr(t+1,e.length);return{name:a,hash:qe(),suffix:n}},Qe=e=>{const t=e.indexOf(".");return e.substr(0,t)},Ze=e=>/(png|jpg|gif|jpeg|webp|svg\+xml)$/.test(e);var et,tt;(tt=et||(et={})).waitUpload="waitUpload",tt.uploading="uploading",tt.uploaded="uploaded",tt.allUploaded="allUploaded",tt.uploadFail="uploadFail";const at=(e,t,a)=>{const n=`https://cdn.jsdelivr.net/gh/${a.owner}/${a.selectedRepos}@${a.selectedBranch}/${t.path}`,o=decodeURI(t.download_url);switch(e){case Me.gh:return o;case Me.md_gh:return`![${Qe(t.name)}](${o})`;case Me.cdn:return n;case Me.md_cdn:return`![${Qe(t.name)}](${n})`}};var nt=R({name:"selected-info-bar",setup(){const e=ve(),t=P({userConfigInfo:G((()=>e.getters.getUserConfigInfo))});return l({},N(t))}});const ot=q("data-v-693c0476");V("data-v-693c0476");const st={key:0,class:"selected-info-bar-box"},it={class:"info-item"},lt=Y(" ä»“åº“ï¼š"),rt={key:0,class:"info-item"},dt=Y(" åˆ†æ”¯ï¼š"),ut={key:1,class:"info-item"},ct=Y(" ç›®å½•ï¼š");j();const gt=ot(((e,t,a,n,o,s)=>{const i=K("el-tag");return e.userConfigInfo.selectedRepos?($(),z("div",st,[F("span",it,[lt,F(i,{size:"mini"},{default:ot((()=>[Y(J(e.userConfigInfo.selectedRepos),1)])),_:1})]),e.userConfigInfo.selectedBranch?($(),z("span",rt,[dt,F(i,{size:"mini"},{default:ot((()=>[Y(J(e.userConfigInfo.selectedBranch),1)])),_:1})])):B("",!0),e.userConfigInfo.selectedDir?($(),z("span",ut,[ct,F(i,{size:"mini"},{default:ot((()=>[Y(J(e.userConfigInfo.selectedDir),1)])),_:1})])):B("",!0)])):B("",!0)}));nt.render=gt,nt.__scopeId="data-v-693c0476";var pt=R({name:"to-upload-image-card",components:{copyExternalLink:Ge,selectedInfoBar:nt},props:{loadingAllImage:{type:Boolean,default:!1}},setup(){const e=ve(),t=P({userConfigInfo:G((()=>e.getters.getUserConfigInfo)).value,toUploadImage:G((()=>e.getters.getToUploadImage)),hashRename(e,t){t.filename.now=e?`${t.filename.name}.${t.filename.hash}.${t.filename.suffix}`:`${t.filename.name}.${t.filename.suffix}`},rename(e,t){t.filename.name=e?t.filename.newName:t.filename.initName,t.filename.isHashRename?t.filename.now=`${t.filename.name}.${t.filename.hash}.${t.filename.suffix}`:t.filename.now=`${t.filename.name}.${t.filename.suffix}`},getFileSize:e=>(e=>(e/1024).toFixed(2)+" KB")(e),formatLastModified:e=>De.formatTimestamp(e),async uploadImage_all(e){const t=this.toUploadImage.uploadedNumber;return t>=this.toUploadImage.list.length?et.uploaded:!0===await this.uploadImage_single(e,this.toUploadImage.list[t])?t<this.toUploadImage.list.length?(await this.uploadImage_all(e),et.allUploaded):et.uploaded:et.uploadFail},uploadImage_single(t,a){const{token:n,selectedBranch:o,email:s,owner:i}=t;a.uploadStatus.uploading=!0;const l={message:"Upload pictures via PicX(https://github.com/XPoet/picx)",branch:o,content:a.imgData.base64Content};return s&&(l.committer={name:i,email:s}),new Promise(((o,s)=>{be.put(((e,t)=>{let a="";return"/"!==e.selectedDir&&(a=e.selectedDir+"/"),`/repos/${e.owner}/${e.selectedRepos}/contents/${a}${t}`})(t,a.filename.now),l,{headers:{"Content-Type":"application/json",Authorization:`token ${n}`}}).then((n=>{n&&201===n.status?(this.uploadedHandle(n,a,t),e.dispatch("TO_UPLOAD_IMAGE_UPLOADED",a.uuid),o(!0),y.success("ä¸Šä¼ æˆåŠŸï¼")):(a.uploadStatus.uploading=!1,o(!1),y.error("ä¸Šä¼ å¤±è´¥ï¼"))})).catch((e=>{s(e)}))}))},uploadedHandle(t,a,n){a.uploadStatus.progress=100,a.uploadStatus.uploading=!1,a.externalLink.github=at(Me.gh,t.data.content,n),a.externalLink.cdn=at(Me.cdn,t.data.content,n),a.externalLink.markdown_gh=at(Me.md_gh,t.data.content,n),a.externalLink.markdown_cdn=at(Me.md_cdn,t.data.content,n);const o={uuid:a.uuid,dir:n.selectedDir,name:t.data.content.name,path:t.data.content.path,sha:t.data.content.sha,github_url:a.externalLink.github,cdn_url:a.externalLink.cdn,md_gh_url:a.externalLink.markdown_gh,md_cdn_url:a.externalLink.markdown_cdn,is_transform_md:!1,deleting:!1};a.uploadedImg=o,n.dirList.some((e=>e.value===o.dir))||(e.dispatch("USER_CONFIG_INFO_ADD_DIR",o.dir),e.dispatch("DIR_IMAGE_LIST_ADD_DIR",o.dir)),e.dispatch("UPLOADED_LIST_ADD",o),e.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",o)},imageViewer(t){e.commit("IMAGE_VIEWER",{isShow:!0,url:t})}});return r(l({},N(t)),{removeToUploadImage:t=>{e.dispatch("TO_UPLOAD_IMAGE_LIST_REMOVE",t.uuid)}})}});const mt={key:0,class:"to-upload-image-list-card"},ft={class:"header"},It={key:0},ht={key:0,class:"body"},_t={class:"image-uploading-info-box"},vt={class:"left-image-box flex-center"},Ct={class:"right-operation-box"},Lt={class:"top"},bt={class:"image-name"},Dt={class:"image-info"},Ut={class:"file-size item"},At={class:"last-modified item"},St={key:0,class:"bottom rename-operation"},Et={key:1,class:"bottom rename-operation"},kt={key:0,class:"el-icon-upload2"},Ot={key:1,class:"el-icon-loading"},Tt={key:2,class:"el-icon-check"},wt=F("i",{class:"el-icon-delete"},null,-1);function yt(e,t,a){a&&a(e,t)}pt.render=function(e,t,a,n,o,s){const i=K("selectedInfoBar"),l=K("el-checkbox"),r=K("el-input"),d=K("copyExternalLink"),u=K("el-tooltip");return e.toUploadImage.list.length||e.userConfigInfo.selectedRepos?($(),z("div",mt,[F("div",ft,[F("div",null,[F(i)]),F("div",null,[e.toUploadImage.list.length?($(),z("span",It,"å·²ä¸Šä¼ ï¼š"+J(e.toUploadImage.uploadedNumber)+" / "+J(e.toUploadImage.list.length),1)):B("",!0)])]),e.toUploadImage.list.length?($(),z("div",ht,[F("ul",_t,[($(!0),z(H,null,W(e.toUploadImage.list,((t,a)=>($(),z("li",{class:["image-uploading-info-item",{disable:e.loadingAllImage}],key:a},[F("div",vt,[F("div",{class:"image-box",onClick:a=>e.imageViewer(t.imgData.base64Url)},[F("img",{src:t.imgData.base64Url},null,8,["src"])],8,["onClick"])]),F("div",Ct,[F("div",Lt,[F("div",bt,J(t.filename.now),1),F("div",Dt,[F("span",Ut,J(e.getFileSize(t.fileInfo.size)),1),F("span",At,J(e.formatLastModified(t.fileInfo.lastModified)),1)])]),t.uploadStatus.uploading||100===t.uploadStatus.progress?B("",!0):($(),z("div",St,[F(l,{label:"å“ˆå¸ŒåŒ–",modelValue:t.filename.isHashRename,"onUpdate:modelValue":e=>t.filename.isHashRename=e,onChange:a=>e.hashRename(a,t)},null,8,["modelValue","onUpdate:modelValue","onChange"]),F(l,{label:"é‡å‘½å",modelValue:t.filename.isRename,"onUpdate:modelValue":e=>t.filename.isRename=e,onChange:a=>e.rename(a,t)},null,8,["modelValue","onUpdate:modelValue","onChange"]),t.filename.isRename?($(),z(r,{key:0,class:"rename-input",size:"mini",modelValue:t.filename.newName,"onUpdate:modelValue":e=>t.filename.newName=e,onInput:a=>e.rename(a,t),clearable:""},null,8,["modelValue","onUpdate:modelValue","onInput"])):B("",!0)])),t.uploadStatus.uploading||100!==t.uploadStatus.progress?B("",!0):($(),z("div",Et,[F(d,{"img-obj":t.uploadedImg},null,8,["img-obj"])]))]),F("div",{class:["upload-status-box",{"wait-upload":!t.uploadStatus.uploading&&100!==t.uploadStatus.progress,uploading:t.uploadStatus.uploading&&100!==t.uploadStatus.progress,uploaded:!t.uploadStatus.uploading&&100===t.uploadStatus.progress}]},[t.uploadStatus.uploading||100===t.uploadStatus.progress?B("",!0):($(),z("i",kt)),t.uploadStatus.uploading&&100!==t.uploadStatus.progress?($(),z("i",Ot)):B("",!0),t.uploadStatus.uploading||100!==t.uploadStatus.progress?B("",!0):($(),z("i",Tt))],2),100===t.uploadStatus.progress||t.uploadStatus.uploading?B("",!0):($(),z("div",{key:0,class:"remove-to-upload-image",onClick:a=>e.removeToUploadImage(t)},[F(u,{effect:"dark",content:"ç§»é™¤",placement:"top"},{default:Z((()=>[wt])),_:1})],8,["onClick"]))],2)))),128))])])):B("",!0)])):B("",!0)};const Rt=(e,t,a=0)=>{if(!e)return;if(!Ze(e.type))return void y.error("è¯¥æ–‡ä»¶ä¸æ˜¯å›¾ç‰‡æ ¼å¼ï¼");const n=new FileReader;n.readAsDataURL(e),n.onload=function(){const n=this.result;if(null===a||n.length<=a)return void yt(n,e,t);let o=new Image;o.src=n,o.onload=function(){yt(function(e,t,a){let n=document.createElement("canvas"),o=n.getContext("2d");const s=a,i=a/(e.width/e.height);n.width=s,n.height=i,o.fillStyle="#fff",o.fillRect(0,0,n.width,n.height),o.drawImage(e,0,0,s,i);const l=n.toDataURL(t,.75);return n=o=null,l}(o,e.type,a/1024),e,t),o=null}}};var Mt=R({name:"upload-area",props:{imageLoading:{type:Boolean,default:!1}},setup(){const e=ve(),t=P({uploadAreaActive:G((()=>e.getters.getUploadAreaActive)),uploadSettings:G((()=>e.getters.getUploadSettings)).value,toUploadImage:G((()=>e.getters.getToUploadImage)),onSelect(t){e.commit("CHANGE_UPLOAD_AREA_ACTIVE",!0);for(const e of t.target.files)Rt(e,((e,t)=>{this.getImage(e,t)}),this.uploadSettings.isSetMaxSize?1024*this.uploadSettings.compressSize:null)},onDrop(t){const a=t.dataTransfer.files[0];Rt(a,((e,t)=>{this.getImage(e,t)}),this.uploadSettings.isSetMaxSize?1024*this.uploadSettings.compressSize:null),e.commit("CHANGE_UPLOAD_AREA_ACTIVE",!0)},async onPaste(e){const{url:t,file:a}=await((e,t=204800)=>{if(e.clipboardData&&e.clipboardData.items)return new Promise((a=>{for(let n=0,o=e.clipboardData.items.length;n<o;n++){const o=e.clipboardData.items[n];if("file"===o.kind){const e=o.getAsFile();Rt(e,((e,t)=>{a({url:e,file:t})}),t)}}}))})(e,this.uploadSettings.isSetMaxSize?1024*this.uploadSettings.compressSize:null);this.getImage(t,a)},getImage(t,a){this.toUploadImage.list.length===this.toUploadImage.uploadedNumber&&this.toUploadImage.list.length>0&&this.toUploadImage.uploadedNumber>0&&(e.dispatch("TO_UPLOAD_IMAGE_CLEAN_LIST"),e.dispatch("TO_UPLOAD_IMAGE_CLEAN_UPLOADED_NUMBER"));const n={uuid:"",uploadStatus:{progress:0,uploading:!1},imgData:{base64Content:"",base64Url:""},fileInfo:{size:0,lastModified:0},filename:{name:"",hash:"",suffix:"",now:"",initName:"",newName:"xxx",isHashRename:!0,isRename:!1},externalLink:{github:"",cdn:"",markdown_gh:"",markdown_cdn:""}};n.imgData.base64Url=t,n.imgData.base64Content=t.split(",")[1];const{name:o,hash:s,suffix:i}=Ke(a.name);n.uuid=s,n.fileInfo.size=a.size,n.fileInfo.lastModified=a.lastModified,n.filename.name=o,n.filename.hash=s,n.filename.suffix=i,n.filename.now=`${o}.${s}.${i}`,n.filename.initName=o,e.dispatch("TO_UPLOAD_IMAGE_LIST_ADD",JSON.parse(JSON.stringify(n))),e.dispatch("TO_UPLOAD_IMAGE_SET_CURRENT",{uuid:s,base64Url:t})}});return l({},N(t))}});const Pt=q("data-v-86198df2");V("data-v-86198df2");const Gt={key:0,for:"uploader",class:"active-upload"},xt={key:1,class:"tips active-upload"},Nt=F("i",{class:"icon el-icon-upload active-upload"},null,-1),Vt=F("div",{class:"text active-upload"},"æ‹–æ‹½ã€ç²˜è´´ã€æˆ–ç‚¹å‡»æ­¤å¤„ä¸Šä¼ ",-1);j();const jt=Pt(((e,t,a,n,o,s)=>{const i=Q("loading");return X(($(),z("div",{class:["upload-area active-upload",{focus:e.uploadAreaActive}],onDragover:t[2]||(t[2]=ee((()=>{}),["prevent"])),onDrop:t[3]||(t[3]=ee(((...t)=>e.onDrop&&e.onDrop(...t)),["stop","prevent"])),onPaste:t[4]||(t[4]=(...t)=>e.onPaste&&e.onPaste(...t)),"element-loading-text":"å›¾ç‰‡ä¸Šä¼ ä¸­...","element-loading-background":"rgba(0, 0, 0, 0.5)"},[e.uploadAreaActive?($(),z("label",Gt)):B("",!0),F("input",{id:"uploader",type:"file",onChange:t[1]||(t[1]=(...t)=>e.onSelect&&e.onSelect(...t)),multiple:"multiple"},null,32),e.toUploadImage.curImgBase64Url?B("",!0):($(),z("div",xt,[Nt,Vt])),e.toUploadImage.curImgBase64Url?($(),z("img",{key:2,class:"active-upload",src:e.toUploadImage.curImgBase64Url,alt:"Pictures to be uploaded"},null,8,["src"])):B("",!0)],34)),[[i,e.imageLoading]])}));Mt.render=jt,Mt.__scopeId="data-v-86198df2";var $t=R({name:"Upload",components:{ImageCard:je,ToUploadImageCard:pt,UploadArea:Mt},setup(){const e=ve(),t=M(),a=te(null),n=te(null),o=te(null),s=te(null),i=P({userConfigInfo:G((()=>e.getters.getUserConfigInfo)).value,logoutStatus:G((()=>e.getters.getUserLoggingStatus)),uploadedImageList:G((()=>e.getters.getUploadedImageList)),toUploadImage:G((()=>e.getters.getToUploadImage)),imageLoading:!1}),d=()=>{i.imageLoading=!1,e.dispatch("TO_UPLOAD_IMAGE_LOGOUT")};return x((()=>i.logoutStatus),(e=>{!e&&d()})),r(l({},N(i)),{GitHubExternalLinkInput:a,CDNExternalLinkInput:n,toUploadImageCardDom:o,uploadAreaDom:s,resetUploadInfo:d,uploadImage:()=>{const{token:a,selectedRepos:n,selectedDir:s}=i.userConfigInfo;return a?n?s?void(0!==i.toUploadImage.list.length?i.toUploadImage.list.length!==i.toUploadImage.uploadedNumber?(i.imageLoading=!0,o.value.uploadImage_all(i.userConfigInfo).then((t=>{switch(t){case et.uploaded:case et.allUploaded:i.imageLoading=!1,e.dispatch("TO_UPLOAD_IMAGE_CLEAN_URL");break;case et.uploadFail:i.imageLoading=!1,e.dispatch("TO_UPLOAD_IMAGE_LIST_FAIL")}})).catch((e=>{console.error("upload error: ",e),i.imageLoading=!1}))):y.error("è¯·é€‰æ‹©è¦ä¸Šä¼ çš„å›¾ç‰‡ï¼"):y.error("å›¾ç‰‡ä¸èƒ½ä¸ºç©ºï¼")):(y.error("ç›®å½•ä¸èƒ½ä¸ºç©ºï¼"),void t.push("/config")):(y.error("è¯·é€‰æ‹©ä¸€ä¸ªä»“åº“ï¼"),void t.push("/config")):(y.error("è¯·å…ˆå®Œæˆå›¾åºŠé…ç½®ï¼"),void t.push("/config"))}})}});const zt=q("data-v-0cbd4bf0");V("data-v-0cbd4bf0");const Ft={class:"upload-page-container"},Xt={key:0,class:"upload-page-left page-container",style:{width:"30%"}},Bt={class:"row-item"},Ht={class:"content-box"},Wt={class:"row-item"},Yt={class:"content-box"},Jt={class:"row-item"},qt={class:"content-box",style:{"text-align":"right"}},Kt=Y("é‡ç½® "),Qt=Y("ä¸Šä¼  ");j();const Zt=zt(((e,t,a,n,o,s)=>{const i=K("ImageCard"),l=K("UploadArea"),r=K("ToUploadImageCard"),d=K("el-button");return $(),z("div",Ft,[e.uploadedImageList.length?($(),z("div",Xt,[($(!0),z(H,null,W(e.uploadedImageList,((e,t)=>($(),z("div",{class:"uploaded-item",key:t},[F(i,{"image-obj":e,"is-uploaded":!0},null,8,["image-obj"])])))),128))])):B("",!0),F("div",{class:"upload-page-right page-container",style:{width:e.uploadedImageList.length?"70%":"100%"}},[F("div",Bt,[F("div",Ht,[F(l,{"image-loading":e.imageLoading,ref:"uploadAreaDom"},null,8,["image-loading"])])]),F("div",Wt,[F("div",Yt,[F(r,{ref:"toUploadImageCardDom","loading-all-image":e.imageLoading},null,8,["loading-all-image"])])]),F("div",Jt,[F("div",qt,[e.toUploadImage.list.length?($(),z(d,{key:0,plain:"",size:"small",onClick:e.resetUploadInfo},{default:zt((()=>[Kt])),_:1},8,["onClick"])):B("",!0),F(d,{type:"primary",plain:"",size:"small",onClick:e.uploadImage},{default:zt((()=>[Qt])),_:1},8,["onClick"])])])],4)])}));$t.render=Zt,$t.__scopeId="data-v-0cbd4bf0";var ea=R({name:"Management",components:{ImageCard:je,selectedInfoBar:nt},setup(){const e=ve(),t=M(),a=P({userConfigInfo:G((()=>e.getters.getUserConfigInfo)).value,loggingStatus:G((()=>e.getters.getUserLoggingStatus)).value,dirImageList:G((()=>e.getters.getDirImageList)).value,currentDirImageList:[],loadingImageList:!1,initDirImageList(){if(!this.dirImageList.length)return void this.getReposContent();const{selectedDir:e}=this.userConfigInfo,t=this.dirImageList.find((t=>t.dir===e));t?t.imageList.length>0?this.currentDirImageList=t.imageList:this.getDirContent(e):this.isHasDir(e)&&this.getDirContent(e)},getReposContent(){var t,a;be.get(`/repos/${null==(t=this.userConfigInfo)?void 0:t.owner}/${null==(a=this.userConfigInfo)?void 0:a.selectedRepos}/contents`,{headers:{"Content-Type":"application/json",Authorization:`token ${this.userConfigInfo.token}`}}).then((t=>{if(console.log("res: ",t),t&&200===t.status&&t.data.length>0){e.dispatch("DIR_IMAGE_LIST_ADD_DIR","/");for(const a of t.data)"dir"===a.type?e.dispatch("DIR_IMAGE_LIST_ADD_DIR",a.name):"file"===a.type&&Ze(Ke(a.name).suffix)&&e.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",this.getImageObject(a,"/"));this.isHasDir(this.userConfigInfo.selectedDir)||(this.userConfigInfo.selectedDir="/"),this.dirChange(this.userConfigInfo.selectedDir)}}))},isHasDir(e){return this.userConfigInfo.dirList.some((t=>t.value===e))},getDirContent(t){var a,n;this.loadingImageList=!0;const o={dir:t,imageList:[]};be.get(`/repos/${null==(a=this.userConfigInfo)?void 0:a.owner}/${null==(n=this.userConfigInfo)?void 0:n.selectedRepos}/contents/${t}`,{headers:{"Content-Type":"application/json",Authorization:`token ${this.userConfigInfo.token}`}}).then((a=>{if(a&&200===a.status&&a.data.length>0){const n=[];for(const e of a.data)"file"===e.type&&Ze(Ke(e.name).suffix)&&n.push(this.getImageObject(e,t));o.imageList=n,e.dispatch("DIR_IMAGE_LIST_ADD_IMAGE_LIST",o),this.loadingImageList=!1}}))},getImageObject(e,t){return{uuid:qe(),dir:t,name:e.name,path:e.path,sha:e.sha,github_url:at(Me.gh,e,this.userConfigInfo),cdn_url:at(Me.cdn,e,this.userConfigInfo),md_gh_url:at(Me.md_gh,e,this.userConfigInfo),md_cdn_url:at(Me.md_cdn,e,this.userConfigInfo),deleting:!1,is_transform_md:!1}},dirChange(e){const t=this.dirImageList.find((t=>t.dir===e));t&&t.imageList.length?this.currentDirImageList=t.imageList:this.getDirContent(e)}});return ae((()=>{a.initDirImageList()})),x((()=>a.loggingStatus),(e=>{!e&&t.push("/config")})),x((()=>a.dirImageList),(e=>{const t=e.find((e=>e.dir===a.userConfigInfo.selectedDir));t&&(a.currentDirImageList=t.imageList)}),{deep:!0}),r(l({},N(a)),{dirChange:function(e){a.dirChange(e)}})}});const ta=q("data-v-51a52ae0");V("data-v-51a52ae0");const aa={class:"page-container management-page-container"},na={class:"content-container"},oa={class:"top"},sa={class:"left"},ia={class:"right"},la=Y(" åˆ‡æ¢ç›®å½•ï¼š "),ra={class:"bottom","element-loading-text":"åŠ è½½ä¸­...","element-loading-background":"rgba(0, 0, 0, 0.6)"},da={class:"image-list"};j();const ua=ta(((e,t,a,n,o,s)=>{const i=K("selectedInfoBar"),l=K("el-option"),r=K("el-select"),d=K("ImageCard"),u=Q("loading");return $(),z("div",aa,[F("div",na,[F("div",oa,[F("div",sa,[F(i)]),F("div",ia,[la,F(r,{modelValue:e.userConfigInfo.selectedDir,"onUpdate:modelValue":t[1]||(t[1]=t=>e.userConfigInfo.selectedDir=t),placeholder:"è¯·é€‰æ‹©",size:"mini",onChange:e.dirChange},{default:ta((()=>[($(!0),z(H,null,W(e.userConfigInfo.dirList,((e,t)=>($(),z(l,{key:t,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])]),X(F("div",ra,[F("ul",da,[($(!0),z(H,null,W(e.currentDirImageList,((e,t)=>($(),z("li",{class:"image-item",key:t,style:{width:"220px",height:"230px"}},[F(d,{"image-obj":e},null,8,["image-obj"])])))),128))])],512),[[u,e.loadingImageList]])])])}));ea.render=ua,ea.__scopeId="data-v-51a52ae0";const ca={class:"tutorials-step-1"},ga=Y(" åˆ›å»ºä¸€ä¸ªç”¨æ¥å­˜å‚¨å›¾ç‰‡çš„ "),pa=F("img",{src:"https://cdn.jsdelivr.net/gh/XPoet/image-hosting@master/PicX/image.j1486dtk68n.png",alt:"Create GitHub Repository"},null,-1);var ma=R({setup(e){function t(){window.open("https://github.com/new")}return(e,a)=>($(),z("div",ca,[F("h3",null,[ga,F("span",{class:"go-create-repo",onClick:t}," GitHub ä»“åº“")]),pa]))}});const fa={class:"tutorials-step-2"},Ia=Y(" åˆ›å»ºä¸€ä¸ªæœ‰ repo æƒé™çš„ "),ha=F("img",{src:"https://cdn.jsdelivr.net/gh/XPoet/image-hosting@master/PicX/image.lpt1xl9fu.png",alt:"Create GitHub Token"},null,-1),_a=F("p",null,"ç„¶åç‚¹å‡» Generate token æŒ‰é’®ï¼Œå³å¯ç”Ÿæˆä¸€ä¸ªtokenï¼Œå¦‚ä¸‹å›¾ï¼š",-1),va=F("img",{src:"https://cdn.jsdelivr.net/gh/XPoet/image-hosting@master/PicX/image.pzmcp6b80fk.png",alt:"token-demo"},null,-1),Ca=F("p",{style:{color:"red"}},[F("em",null,"æ–°ç”Ÿæˆçš„ Token åªä¼šæ˜¾ç¤ºä¸€æ¬¡ï¼Œè¯·å¦¥å–„ä¿å­˜ï¼å¦‚æœ‰é—å¤±ï¼Œé‡æ–°ç”Ÿæˆå³å¯ã€‚")],-1);var La=R({setup(e){function t(){window.open("https://github.com/settings/tokens/new")}return(e,a)=>($(),z("div",fa,[F("h3",null,[Ia,F("span",{class:"go-create-token",onClick:t}," GitHub Token")]),ha,_a,va,Ca]))}});const ba={},Da={class:"tutorials-step-3"},Ua=ne('<h3>è¿›è¡Œå›¾åºŠé…ç½®ï¼ˆç»‘å®š GitHub Tokenã€å­˜å‚¨å›¾ç‰‡çš„ä»“åº“å’Œç›®å½•ï¼‰</h3><p>1ã€å¡«å†™ Tokenï¼Œè‡ªåŠ¨è·å–è¯¥ç”¨æˆ·ä¸‹çš„ä»“åº“</p><img src="https://cdn.jsdelivr.net/gh/XPoet/image-hosting@master/PicX/image.4g8q5m7c8sq0.png"><br><p>2ã€åœ¨ä»“åº“çš„ä¸‹æ‹‰åˆ—è¡¨ä¸­ï¼Œé€‰æ‹©ä¸€ä¸ªä½œä¸ºå›¾åºŠçš„ä»“åº“</p><img src="https://cdn.jsdelivr.net/gh/XPoet/image-hosting@master/PicX/image.746g75olruk0.png"><br><p>3ã€é€‰æ‹©ä¸€ç§ç›®å½•æ–¹å¼ï¼ˆç›®å½•å³ä»“åº“é‡Œå­˜æ”¾å›¾ç‰‡çš„æ–‡ä»¶å¤¹ï¼‰</p><img src="https://cdn.jsdelivr.net/gh/XPoet/image-hosting@master/PicX/image.5ydmhgxjhgo0.png"><div class="dir-desc-box"><ul><li>æ–°å»ºç›®å½•ï¼šéœ€æ‰‹åŠ¨è¾“å…¥ä¸€ä¸ªæ–°ç›®å½•ã€‚</li><li>æ ¹ç›®å½•ï¼šå›¾ç‰‡å°†ç›´æ¥å­˜å‚¨åœ¨ä»“åº“æ ¹ç›®å½•ä¸‹ã€‚</li><li>è‡ªåŠ¨ç›®å½•ï¼šè‡ªåŠ¨ç”Ÿæˆæ—¥æœŸæ ¼å¼ YYYYMMDD çš„ç›®å½•ã€‚ä¾‹å¦‚ï¼š20200909</li><li>é€‰æ‹©ä»“åº“ç›®å½•ï¼šè‡ªåŠ¨è·å–ä»“åº“ä¸‹æ‰€æœ‰ç›®å½•ï¼Œé€‰æ‹©ä¸€ä¸ªå³å¯ã€‚</li></ul></div>',10);ba.render=function(e,t){return $(),z("div",Da,[Ua])};var Aa=R({name:"Tutorials",components:{Step1:ma,Step2:La,Step3:ba},setup(){const e=te(0);return{stepNum:e,step:t=>{"prev"===t&&(e.value<0?e.value=0:e.value-=1),"next"===t&&(e.value>3?e.value=3:e.value+=1)}}}});const Sa=q("data-v-77be0d07");V("data-v-77be0d07");const Ea={class:"page-container tutorials-page-container"},ka={class:"step-content"},Oa={key:3},Ta=F("h2",null,"ğŸ‘ æ­å–œä½ å®Œæˆå›¾åºŠä½¿ç”¨æ•™ç¨‹ ğŸŒŸ å¿«å»è¯•è¯•å§~",-1),wa=F("h2",null,"https://github.com/XPoet/picx",-1),ya={class:"btn-next-prev"},Ra=Y("ä¸Šä¸€æ­¥ "),Ma=Y("ä¸‹ä¸€æ­¥ ");j();const Pa=Sa(((e,t,a,n,o,s)=>{const i=K("el-step"),l=K("el-steps"),r=K("Step1"),d=K("Step2"),u=K("Step3"),c=K("el-button");return $(),z("div",Ea,[F(l,{active:e.stepNum,"finish-status":"success","align-center":""},{default:Sa((()=>[F(i,{title:"åˆ›å»º GitHub ä»“åº“"}),F(i,{title:"è·å– GitHub Token"}),F(i,{title:"é…ç½®å›¾åºŠ"})])),_:1},8,["active"]),F("div",ka,[0===e.stepNum?($(),z(r,{key:0})):B("",!0),1===e.stepNum?($(),z(d,{key:1})):B("",!0),2===e.stepNum?($(),z(u,{key:2})):B("",!0),3===e.stepNum?($(),z("div",Oa,[Ta,wa])):B("",!0)]),F("div",ya,[e.stepNum>0?($(),z(c,{key:0,type:"primary",onClick:t[1]||(t[1]=t=>e.step("prev"))},{default:Sa((()=>[Ra])),_:1})):B("",!0),e.stepNum<3?($(),z(c,{key:1,type:"primary",onClick:t[2]||(t[2]=t=>e.step("next"))},{default:Sa((()=>[Ma])),_:1})):B("",!0)])])}));Aa.render=Pa,Aa.__scopeId="data-v-77be0d07",console.log("env: ",{VITE_PUBLIC_PATH:"./",VITE_USE_PWA:"true",VITE_GLOB_APP_TITLE:"PicX å›¾åºŠ",VITE_GLOB_APP_SHORT_NAME:"PicX",BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0});const Ga=[{path:"/",name:"Index",redirect:{name:"Upload"}},{path:"/config",name:"Config",component:Ue,meta:{title:"å›¾åºŠé…ç½® | PicX å›¾åºŠç¥å™¨"}},{path:"/upload",name:"Upload",component:$t,meta:{title:"å›¾ç‰‡ä¸Šä¼  | PicX å›¾åºŠç¥å™¨"}},{path:"/management",name:"Management",component:ea,meta:{title:"å›¾åºŠç®¡ç† | PicX å›¾åºŠç¥å™¨"}},{path:"/tutorials",name:"Tutorials",component:Aa,meta:{title:"ä½¿ç”¨æ•™ç¨‹ | PicX å›¾åºŠç¥å™¨"}},{path:"/about",name:"About",component:()=>ce((()=>import("./index.d70253fd.js")),["assets/index.d70253fd.js","assets/index.3cb6b11c.css","assets/vendor.4c6efeb2.js"]),meta:{title:"å¸®åŠ©åé¦ˆ | PicX å›¾åºŠç¥å™¨"}}],xa=oe({history:se(),routes:Ga});xa.beforeEach(((e,t,a)=>{e.meta.title&&(window.document.title=e.meta.title),a()}));var Na=R({name:"site-count",props:{isuv:{type:Boolean,default:!1}},setup(){const e=te(null);return ae((()=>{const t=document.createElement("script");t.async=!0,t.src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.value.appendChild(t)})),{siteCountDom:e}}});const Va={class:"site-count",ref:"siteCountDom"},ja={key:0,id:"busuanzi_value_site_uv"},$a={key:1,id:"busuanzi_value_site_pv"};Na.render=function(e,t,a,n,o,s){return $(),z("span",Va,[e.isuv?($(),z("span",ja)):B("",!0),e.isuv?B("",!0):($(),z("span",$a))],512)};var za=R({name:"Header",components:{siteCount:Na},setup(){const e=M(),t=ve(),a=P({defaultUsername:"æœªç™»å½•",userConfigInfo:G((()=>t.state.userConfigInfoModule.userConfigInfo))});return r(l({},N(a)),{router:e,onUserInfoClick:()=>{a.userConfigInfo.loggingStatus||"/config"===e.currentRoute.value.path||e.push("/config")},handleCommand:a=>{switch(a){case"upload":e.push("/");break;case"config":e.push("/config");break;case"management":e.push("/management");break;case"logout":t.dispatch("LOGOUT"),e.push("/config")}},goGitHubRepo:()=>{window.open("https://github.com/XPoet/picx")}})}});const Fa=q("data-v-fa46921c");V("data-v-fa46921c");const Xa={class:"header"},Ba={class:"header-left"},Ha=F("div",{class:"logo"},[F("img",{src:"./assets/logo.206d082d.png",alt:"PicX"})],-1),Wa=F("div",{class:"title"},"PicX",-1),Ya={class:""},Ja=Y(" æœ‰ "),qa=Y(" ä½å°ä¼™ä¼´ä½¿ç”¨ PicX å›¾åºŠç¥å™¨"),Ka={class:"header-right"},Qa={class:"username"},Za={key:0,class:"avatar"},en=F("i",{class:"el-icon-user-solid"},null,-1),tn={class:"el-dropdown-link"},an={class:"avatar"},nn=Y(" é€€å‡ºç™»å½• ");j();const on=Fa(((e,t,a,n,o,s)=>{var i,l;const r=K("siteCount"),d=K("el-tooltip"),u=K("el-dropdown-item"),c=K("el-dropdown-menu"),g=K("el-dropdown");return $(),z("header",Xa,[F("div",Ba,[F("div",{class:"brand",onClick:t[1]||(t[1]=t=>e.router.push("/"))},[Ha,Wa]),F("div",{class:"website-count",onClick:t[2]||(t[2]=(...t)=>e.goGitHubRepo&&e.goGitHubRepo(...t))},[F(d,{effect:"light",content:"ç‚¹ä¸ª Star æ”¯æŒä¸€ä¸‹ä½œè€…å§(*ï¿£ï¸¶ï¿£)",placement:"bottom"},{default:Fa((()=>[F("i",Ya,[Ja,F(r,{isuv:!1}),qa])])),_:1})])]),F("div",Ka,[F("div",{class:"user-info",onClick:t[3]||(t[3]=(...t)=>e.onUserInfoClick&&e.onUserInfoClick(...t))},[F("div",Qa,J(e.userConfigInfo.owner?e.userConfigInfo.owner:e.defaultUsername),1),(null==(i=e.userConfigInfo)?void 0:i.avatarUrl)?B("",!0):($(),z("div",Za,[en])),(null==(l=e.userConfigInfo)?void 0:l.avatarUrl)?($(),z(g,{key:1,trigger:"click",onCommand:e.handleCommand},{dropdown:Fa((()=>[F(c,null,{default:Fa((()=>[F(u,{command:"logout"},{default:Fa((()=>[nn])),_:1})])),_:1})])),default:Fa((()=>{var t,a;return[F("span",tn,[F("span",an,[F("img",{src:null==(t=e.userConfigInfo)?void 0:t.avatarUrl,alt:null==(a=e.userConfigInfo)?void 0:a.owner},null,8,["src","alt"])])])]})),_:1},8,["onCommand"])):B("",!0)])])])}));za.render=on,za.__scopeId="data-v-fa46921c";var sn=R({name:"Nav",setup(){const e=M(),t=ve(),a=P({userConfigInfo:G((()=>t.getters.getUserConfigInfo)).value,navList:[{name:"å›¾åºŠé…ç½®",icon:"el-icon-edit-outline",isActive:!1,path:"/config"},{name:"ä¸Šä¼ å›¾ç‰‡",icon:"el-icon-upload2",isActive:!1,path:"/upload"},{name:"å›¾åºŠç®¡ç†",icon:"el-icon-box",isActive:!1,path:"/management"},{name:"ä½¿ç”¨æ•™ç¨‹",icon:"el-icon-magic-stick",isActive:!1,path:"/tutorials"},{name:"å¸®åŠ©åé¦ˆ",icon:"el-icon-chat-dot-round",isActive:!1,path:"/about"}],navClick(t){const{path:a}=t;if("/management"===a){if(""===this.userConfigInfo.selectedRepos)return y.warning("è¯·é€‰æ‹©ä¸€ä¸ªä»“åº“ï¼"),void e.push("/config");if(""===this.userConfigInfo.selectedDir)return y.warning("ç›®å½•ä¸èƒ½ä¸ºç©ºï¼"),void e.push("/config")}e.push(a)}}),n=e=>{a.navList.forEach((t=>{const a=t;return a.isActive=t.path===e,a}))};return x((()=>e.currentRoute.value),(e=>{n(e.path)})),ae((()=>{e.isReady().then((()=>{n(e.currentRoute.value.path)}))})),l({},N(a))}});const ln=q("data-v-7e297638");V("data-v-7e297638");const rn={class:"nav"},dn={class:"nav-list"},un={class:"nav-content"},cn={class:"nav-name"};j();const gn=ln(((e,t,a,n,o,s)=>($(),z("aside",rn,[F("ul",dn,[($(!0),z(H,null,W(e.navList,((t,a)=>X(($(),z("li",{class:["nav-item flex-center",{active:t.isActive}],key:a,onClick:a=>e.navClick(t)},[F("div",un,[F("i",{class:["nav-icon",t.icon]},null,2),F("span",cn,J(t.name),1)])],10,["onClick"])),[[ie,"/management"!==t.path||e.userConfigInfo.loggingStatus]]))),128))])]))));sn.render=gn,sn.__scopeId="data-v-7e297638",V("data-v-1beee754");const pn={key:0,class:"image-box"};j();var mn=R({setup(e){const t=ve(),a=G((()=>t.getters.getImageViewer));return(e,t)=>($(),z("div",{class:["image-viewer",{active:le(a).isShow}],onClick:t[1]||(t[1]=e=>le(a).isShow=!1)},[le(a).url?($(),z("div",pn,[F("img",{class:"img",src:le(a).url},null,8,["src"])])):B("",!0)],2))}});mn.__scopeId="data-v-1beee754";var fn=R({name:"Main",components:{Header:za,Nav:sn,ImageViewer:mn},setup(){const e=ve();return{changeUploadAreaActive:t=>{e.commit("CHANGE_UPLOAD_AREA_ACTIVE",t.target.classList.contains("active-upload"))}}}});const In=q("data-v-38866358");V("data-v-38866358");const hn={class:"top"},_n={class:"bottom"},vn={class:"container"},Cn={class:"left"},Ln={class:"right"},bn={class:"content"};j();const Dn=In(((e,t,a,n,o,s)=>{const i=K("Header"),l=K("Nav"),r=K("router-view"),d=K("ImageViewer");return $(),z(H,null,[F("main",{class:"main-container",onClick:t[1]||(t[1]=(...t)=>e.changeUploadAreaActive&&e.changeUploadAreaActive(...t))},[F("div",hn,[F(i)]),F("div",_n,[F("div",vn,[F("div",Cn,[F(l)]),F("div",Ln,[F("div",bn,[F(r)])])])])]),F(d)],64)}));fn.render=Dn,fn.__scopeId="data-v-38866358";var Un=R({name:"App",components:{Main:fn}});Un.render=function(e,t,a,n,o,s){const i=K("Main");return $(),z(i)};ce((()=>import("./registerSW.4c4014ca.js")),[]);const An=re(Un);var Sn;(Sn=An,Sn.use(d).use(u).use(c).use(g).use(p).use(m).use(f).use(I).use(h).use(_).use(v).use(C).use(L).use(b).use(D).use(U).use(A).use(S).use(E).use(k),Sn).use(xa).use(he,_e).mount("#app");
